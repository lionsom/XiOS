;define('page/pages/video_mod/video_danmu.css', [], function(require, exports, module) {
	return ".page_video .txp_barrage_external{z-index:7!important;opacity:.8!important;bottom:auto}.page_video .txp_barrage_external .danmu_self{color:#07c160}.page_video .txp_barrage_external .danmu_self img.icon_emotion_single{margin-top:-0.2em}.page_video .txp_barrage_external .we-emoji{font-size:18px!important}.page_video.page_video_skin-horizontal .danmu_full .txp_barrage_external{margin-top:constant(safe-area-inset-top);margin-top:env(safe-area-inset-top)}.page_video.page_video_skin-vertical .danmu_full .txp_barrage_external{margin-top:120px}.page_video .txp_mod_barrage{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;position:relative;height:50px;background:#26262b;user-select:none}.page_video .txp_mod_barrage .txp_none{display:none!important}.page_video .txp_mod_barrage .txp_svg_icon{display:inline-block;vertical-align:top}.page_video .txp_mod_barrage .txp_btn_drag{display:none}.page_video .txp_mod_barrage .txp_barrage_form{display:block;position:relative;width:auto;height:32px;margin-top:8px;margin-right:118px;margin-left:70px;border-radius:17px;background-color:#111226;-webkit-transition:width .15s ease,margin-left .15s ease;transition:width .15s ease,margin-left .15s ease}.page_video .txp_mod_barrage .txp_barrage_form .txp_inp_text{zoom:1;box-sizing:border-box;display:block;z-index:1;position:relative;width:100%;padding:6px 10px;overflow:hidden;border:0;border-radius:17px 0 0 17px;background:0;background-size:0;color:#ccc;font-size:14px;line-height:20px;text-indent:0}.page_video .txp_mod_barrage .txp_barrage_form .txp_inp_text:focus{outline:0;color:#fff}.page_video .txp_mod_barrage .stars_pendant_info,.page_video .txp_mod_barrage .txp_barrage_input_box{display:inline-block;position:relative;margin-right:-10px;vertical-align:middle;white-space:nowrap}.page_video .txp_mod_barrage .txp_barrage_input_box{width:-ms-calc(-30%);width:calc(-30%)}.page_video .txp_mod_barrage .stars_pendant_avatar,.page_video .txp_mod_barrage .stars_pendant_name{display:inline-block;position:relative;max-width:84px;margin:0 3px;overflow:hidden;color:#666;font-size:12px;line-height:18px;text-overflow:ellipsis;vertical-align:middle;white-space:nowrap}.page_video .txp_mod_barrage .stars_pendant_name{box-sizing:border-box;padding-right:10px}.page_video .txp_mod_barrage .stars_pendant_name:after{position:absolute;right:0;color:#666;font-size:12px;line-height:18px;content:\"\uff1a\"}.page_video .txp_mod_barrage .stars_pendant_avatar{width:24px;height:24px;margin-left:10px;border-radius:50%;background:no-repeat .5% auto}.page_video .txp_mod_barrage .txp_barrage_form_nohotbtn{margin-right:10px}.page_video .txp_mod_barrage .txp_barrage_inp{position:absolute;right:115px;left:0;height:32px;overflow:hidden;border-radius:16px 0 0 16px;text-align:left}.page_video .txp_mod_barrage .txp_barrage_inp_whole{right:66px;padding-right:0}.page_video .txp_mod_barrage .txp_barrage_star{position:absolute;right:118px;height:32px}.page_video .txp_mod_barrage .txp_btn_submit{position:absolute;top:0;right:0;width:66px;height:32px;border:0;border-radius:0 16px 16px 0;outline:0;background-color:#292a3c;color:#eee;font-size:14px;line-height:32px;cursor:pointer}.page_video .txp_mod_barrage .txp_btn_submit:hover{background:#ff6428;background:-webkit-gradient(linear,left top,right top,color-stop(0,#ff850b),to(#ff5945));background:linear-gradient(90deg,#ff850b 0,#ff5945);color:#fff}.page_video .txp_mod_barrage .txp_btn_fonts{right:80px}.page_video .txp_mod_barrage .txp_hl{color:#ff6428}.page_video .txp_mod_barrage .txp_barrage_avatar_list{display:none}.page_video .txp_mod_barrage .txp_popup_barrage_toast{-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);display:inline-block;z-index:6;position:absolute;top:-35px;right:0;left:0;max-width:200px;margin:auto;padding:7px 20px;transform:translateY(-50%);border-radius:50px;background:#111;background:rgba(17,17,17,0.9);color:#999;font-size:12px;line-height:20px;text-align:center}.page_video .txp_mod_barrage_live .txp_barrage_form{margin-right:10px;margin-left:70px}.page_video .txp_mod_barrage .txp_svg_icon path,.page_video .txp_mod_barrage .txp_svg_icon use{fill:currentColor}.page_video .txp_barrage_switch{display:inline-block;position:absolute;top:13px;left:10px;width:50px;height:24px;border-radius:12px;background-color:#111226;font-size:12px;line-height:24px;text-align:left;vertical-align:top;cursor:pointer}.page_video .txp_barrage_switch .txp_btn_text{display:inline-block;margin-left:24px;color:#fff}.page_video .txp_barrage_switch .txp_btn_toggle{box-sizing:content-box;display:inline-block;position:absolute;top:9px;left:12px;width:6px;height:6px;border-radius:6px;background-color:#67676b;-webkit-transition:background-color .15s ease;transition:background-color .15s ease}.page_video .txp_barrage_switch.txp_open .txp_btn_text{color:#ff6428}.page_video .txp_barrage_switch.txp_open .txp_btn_toggle{top:6px;left:9px;border:3px solid #4b2c24;background-color:#ff6428}.page_video .txp_mod_barrage .txp_btn_type{color:#666;text-decoration:none;cursor:pointer}.page_video .txp_barrage_form .txp_btn_type{display:none;position:absolute;top:0;left:-28px}.page_video .txp_mod_barrage .txp_btn_face:hover,.page_video .txp_mod_barrage .txp_btn_fonts:hover,.page_video .txp_mod_barrage .txp_btn_type:hover{color:#ff5c38}.page_video .txp_mod_barrage .txp_icon{display:inline-block;width:20px;height:20px;margin-top:6px;vertical-align:top}.page_video .txp_mod_barrage .txp_btn_submit.txp_disabled,.page_video .txp_mod_barrage .txp_btn_submit.txp_disabled:hover{right:-1px;background:#414141;cursor:default;opacity:.6}.page_video .txp_barrage_login,.page_video .txp_barrage_tips{position:absolute;top:0;right:0;left:0;padding-left:10px;overflow:hidden;border-radius:16px 0 0 16px;color:#666;font-size:12px;line-height:32px;text-align:left;cursor:pointer}.page_video .txp_barrage_login .txp_barrage_pendant,.page_video .txp_barrage_tips .txp_barrage_pendant{-o-object-fit:contain;display:inline-block;width:24px;height:24px;margin:0 4px;object-fit:contain;vertical-align:middle}.page_video .txp_barrage_login .txp_barrage_desc,.page_video .txp_barrage_tips .txp_barrage_desc{display:inline-block;vertical-align:middle}.page_video .txp_barrage_login .txp_link,.page_video .txp_barrage_tips .txp_link{padding-right:2px;color:#ff6428;vertical-align:middle}.page_video .txp_barrage_login .txp_link:hover,.page_video .txp_barrage_tips .txp_link:hover{color:#ff5945}.page_video .txp_barrage_login{z-index:1}.page_video .x_mod_bubble{right:0;bottom:35px}.page_video .txp_mod_barrage{zoom:1;font-size:0;text-align:right}.page_video .txp_mod_barrage:after,.page_video .txp_mod_barrage:before{display:table;content:\"\"}.page_video .txp_mod_barrage:after{clear:both}.page_video .txp_html_fullscreen #mod_barrage_container,.page_video .txp_html_fullscreen .mod_action,.page_video .txp_html_fullscreen .mod_barrage_container{position:static}.page_video .txp_html_fullscreen .txp_mod_barrage,.page_video .txp_html_fullscreen .txp_mod_barrage *{visibility:visible}.page_video .container_short .txp_mod_barrage,.page_video .player_container .txp_mod_barrage{position:absolute;top:0;right:0;background:0}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage,.page_video .txp_html_fullscreen .txp_mod_barrage{-webkit-transform:translate(-50%);-ms-transform:translate(-50%);z-index:0;position:fixed;top:inherit;bottom:67px;left:50%;width:80%!important;max-width:1280px;height:56px;transform:translate(-50%);border-radius:28px;background-color:#000;background-color:rgba(0,0,0,0.7);opacity:.7}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage:hover,.page_video .txp_html_fullscreen .txp_mod_barrage:hover{opacity:1}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_switch,.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_btn_barrage_list,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_switch,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_btn_barrage_list{display:none}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_inp,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_inp{height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form{position:absolute!important;right:84px!important;left:8px!important;width:auto!important;height:40px;margin-left:32px;border-radius:20px;background-color:#1e1e20;background-color:rgba(30,30,32,0.7);font-size:16px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_barrage_login,.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_barrage_tips,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_barrage_login,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_barrage_tips{line-height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_barrage_inp,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_barrage_inp{height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_inp_text,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_inp_text{height:40px;line-height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_fonts,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_fonts{right:103px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_face,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_face{right:125px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_icon,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_icon{margin-top:10px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_type,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_type{top:2px;right:-32px;left:auto}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_submit,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_submit{width:96px;height:40px;border-radius:0 20px 20px 0;font-size:18px;line-height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_popup_barrage{right:80px;bottom:50px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_text,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_text{right:104px;bottom:50px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_type,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_type{right:-54px;left:auto}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_type .txp_popup_barrage_triangle,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_type .txp_popup_barrage_triangle{left:auto}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_barrage_star,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_barrage_star{right:138px;height:40px}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_drag,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_drag{display:block;position:absolute;top:2px;right:-60px;color:#666;text-decoration:none;cursor:pointer}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_drag:hover,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_drag:hover{color:#ff6428}.page_video .txp_html_fullscreen .player_container .txp_mod_barrage .txp_barrage_form .txp_btn_drag .txp_icon,.page_video .txp_html_fullscreen .txp_mod_barrage .txp_barrage_form .txp_btn_drag .txp_icon{width:20px;height:20px}.page_video .txp_html_fullscreen .txp_mod_barrage.txp_focus .txp_barrage_form{width:auto!important;margin-left:0}.page_video .txp_html_fullscreen.txp_html_barrage_on .mod_action{visibility:hidden}.page_video .txp_mod_barrage .txp_btn_face,.page_video .txp_mod_barrage .txp_btn_fonts{z-index:2;position:absolute;top:0;color:#d8d8d8;text-decoration:none;cursor:pointer}.page_video .txp_mod_barrage .txp_btn_face{right:98px}.page_video .txp_mod_barrage .txp_btn_fonts{right:73px}.page_video .container_short .txp_mod_barrage .txp_barrage_input_box,.page_video .screen_xs .txp_mod_barrage .txp_barrage_input_box,.page_video .screen_xxs .txp_mod_barrage .txp_barrage_input_box{width:-ms-calc(30%);width:calc(30%)}.page_video .container_short .txp_mod_barrage .stars_pendant_avatar,.page_video .container_short .txp_mod_barrage .stars_pendant_name,.page_video .screen_xs .txp_mod_barrage .stars_pendant_avatar,.page_video .screen_xs .txp_mod_barrage .stars_pendant_name,.page_video .screen_xxs .txp_mod_barrage .stars_pendant_avatar,.page_video .screen_xxs .txp_mod_barrage .stars_pendant_name{max-width:34px}.page_video li{list-style:none}.page_video .none{display:none!important}.page_video .txp_popup_barrage{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;z-index:3000;position:absolute;right:41px;bottom:32px;border-radius:5px 5px 0 0;color:#999;font-family:PingFangSC-Regular,Tahoma,Microsoft Yahei,Arial,Hiragino Sans GB;font-size:14px;text-align:left;user-select:none}.page_video .txp_popup_barrage .txp_icon{width:24px;height:24px;margin:0}.page_video .txp_popup_barrage .txp_btn{z-index:2;position:absolute;top:50%;width:24px;height:24px;margin-top:-12px;cursor:pointer}.page_video .txp_popup_barrage .txp_btn svg{fill:#9b9d9d;pointer-events:none}.page_video .txp_popup_barrage .txp_btn:hover .txp_icon{fill:#ff6e0b}.page_video .txp_popup_barrage .txp_btn_prev{left:0}.page_video .txp_popup_barrage .txp_btn_next{right:0}.page_video .txp_popup_barrage[data-status=\"0\"] .txp_popup_barrage_inner{height:100px}.page_video .txp_popup_barrage[data-status=\"0\"] .txp_popup_barrage_inner_scroll{left:0}.page_video .txp_popup_barrage[data-status=\"1\"] .txp_popup_barrage_inner{height:200px}.page_video .txp_popup_barrage[data-status=\"1\"] .txp_popup_barrage_inner_scroll{left:-410px}.page_video .txp_popup_barrage.hide .txp_btn{display:none}.page_video .txp_popup_barrage.hide .txp_popup_barrage_inner{height:0}.page_video .txp_popup_barrage_emoji{width:410px;height:200px}.page_video .txp_popup_barrage_type{bottom:40px;left:-54px}.page_video .txp_popup_barrage .txp_iframe_mask{z-index:1;position:absolute;width:100%;height:100%;border-radius:5px;filter:alpha(opacity=0);opacity:0}.page_video .txp_popup_barrage_inner{z-index:2;position:relative;width:410px;margin:0 24px;overflow:hidden;background-color:#28292d;background-color:rgba(40,41,45,0.93);box-shadow:0 1px 6px 0 rgba(0,0,0,0.5);font-size:0;-webkit-transition:height .4s ease-in;transition:height .4s ease-in}.page_video .txp_popup_barrage_inner_scroll{position:relative;width:820px;-webkit-transition:left .5s;transition:left .5s}.page_video .txp_popup_barrage_inner_scroll .txp_popup_barrage_emoji,.page_video .txp_popup_barrage_inner_scroll .txp_popup_barrage_text{display:inline-block;vertical-align:top}.page_video .txp_popup_barrage .txp_popup_barrage_hd{position:relative;padding:8px 20px;overflow:hidden;text-align:right}.page_video .txp_popup_barrage_bd{height:164px}.page_video .txp_popup_barrage .txp_popup_barrage_title{color:#999;font-size:14px}.page_video .txp_popup_barrage .txp_popup_barrage_title .txp_list_item{margin-right:30px;float:left;list-style:none;cursor:pointer}.page_video .txp_popup_barrage .txp_popup_barrage_title .txp_current{color:#ff6428}.page_video .txp_popup_barrage .txp_link{color:#ff6428;font-size:14px;text-decoration:none;cursor:pointer}.page_video .txp_popup_barrage .txp_link:hover{color:#ff2424}.page_video .txp_popup_barrage .x_mod_bd{position:relative}.page_video .txp_popup_barrage .txp_bubble_list:after,.page_video .txp_popup_barrage .txp_bubble_list:before{display:table;content:\"\"}.page_video .txp_popup_barrage .txp_bubble_list:after{clear:both}.page_video .txp_popup_barrage .txp_scroll_wrap{*zoom:1;-webkit-transform:translateZ(0);-webkit-overflow-scrolling:touch;scrollbar-base-color:#222225;scrollbar-face-color:#4c4c4c;scrollbar-arrow-color:#000;scrollbar-3dlight-color:#4c4c4c;scrollbar-highlight-color:#4c4c4c;scrollbar-shadow-color:#4c4c4c;scrollbar-darkshadow-color:#4c4c4c;scrollbar-track-color:#333338;position:relative;_height:150px;max-height:135px;margin-right:9px;margin-left:2px;padding-top:16px;overflow-x:hidden;overflow-y:auto;transform:translateZ(0);font-size:0;list-style:none}.page_video .txp_popup_barrage .txp_scroll_wrap .scroll_wrap_inner{position:relative;height:100%;overflow:auto}.page_video .txp_popup_barrage .txp_scroll_wrap .mod_playlist{margin-bottom:10px}.page_video .txp_popup_barrage .txp_scroll_wrap .mb0{margin-bottom:0}.page_video .txp_popup_barrage .txp_scroll_wrap::-webkit-scrollbar{width:5px;background:#333338}.page_video .txp_popup_barrage .txp_scroll_wrap::-webkit-scrollbar-track-piece{background:0}.page_video .txp_popup_barrage .txp_scroll_wrap::-webkit-scrollbar-button{display:none}.page_video .txp_popup_barrage .txp_scroll_wrap::-webkit-scrollbar-thumb{border-radius:5px;background:#555}.page_video .txp_bubble_list .txp_list_item{display:inline-block;position:relative;width:161px;height:34px;margin:0 0 10px 16px;border:2px solid transparent;border-radius:7px;cursor:pointer}.page_video .txp_bubble_list .txp_list_item img{display:inline-block;position:absolute;bottom:0;left:0;width:161px}.page_video .txp_bubble_list .txp_current img{border-radius:6px}.page_video .txp_bubble_list .txp_list_item .txp_barrage_icon_slted{display:none;z-index:1;position:absolute;top:2px;left:2px;width:8px;height:6px;overflow:hidden;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-70px -38px;background-size:112px auto}.page_video .txp_bubble_list .txp_current{border:2px solid #ff6428}.page_video .txp_bubble_list .txp_current .txp_barrage_icon_slted{display:inline-block}.page_video .txp_popup_barrage .txp_emoticon_list{padding-top:12px;padding-left:20px;color:#eaeaea;line-height:30px}.page_video .txp_popup_barrage .txp_emoticon_list .txp_list_item{font-size:14px;cursor:pointer}.page_video .txp_popup_barrage .txp_emoticon_list .txp_current,.page_video .txp_popup_barrage .txp_emoticon_list .txp_list_item:hover{color:#ff6428}.page_video .txp_popup_barrage_text{width:410px;height:100px}.page_video .txp_barrage_settings{box-sizing:content-box;position:relative;margin:0 20px;padding:16px 0 16px 70px;overflow:hidden;border-bottom:1px solid #2c2c31;font-size:14px}.page_video .txp_barrage_settings_title{position:absolute;top:16px;left:0}.page_video .txp_popup_barrage_text .txp_barrage_settings{display:inline-block;width:168px;margin:16px 0 0;padding:0 0 0 28px;border-bottom:0;vertical-align:top}.page_video .txp_popup_barrage_text .txp_barrage_settings:first-child{border-right:1px solid #393a3d}.page_video .txp_popup_barrage_text .txp_barrage_settings_title{position:static;line-height:1}.page_video .txp_barrage_settings_color{margin-right:-12px;overflow:hidden;font-size:0}.page_video .txp_barrage_settings_color .txp_list_item{display:inline-block;margin-top:8px;margin-right:12px;cursor:pointer}.page_video .txp_barrage_settings_color .txp_list_item span{box-sizing:content-box;display:block;width:16px;height:16px;margin:2px;border-radius:16px;opacity:.8}.page_video .txp_barrage_settings_color .txp_list_item:hover span{opacity:1}.page_video .txp_barrage_settings_color .txp_current span{margin:0;border:2px solid #ff5c38;border:2px solid rgba(255,92,56,0.6);opacity:1}.page_video .txp_barrage_mode_title{font-size:12px}.page_video .txp_barrage_mode{margin-top:8px;margin-right:-11px;overflow:hidden;font-size:0}.page_video .txp_barrage_mode .txp_list_item{display:inline-block;margin-right:11px;text-align:center;cursor:pointer}.page_video .txp_barrage_mode .txp_barrage_mode_box{position:relative;width:47px;height:32px;margin:0 0 2px;overflow:hidden}.page_video .txp_barrage_mode .txp_barrage_mode_box:after{display:block;position:absolute;top:0;left:0;width:38px;height:24px;border:2px solid #515155;border-radius:4px;content:\"\"}.page_video .txp_barrage_mode .txp_barrage_mode_box .txp_barrage_mode_line{display:block;width:18px;height:2px;margin-top:4px;margin-left:12px;background-color:#515155}.page_video .txp_barrage_mode .txp_barrage_mode_box .txp_barrage_mode_line1{margin-top:6px}.page_video .txp_barrage_mode .txp_barrage_mode_scroll .txp_barrage_mode_line1{margin-left:12px}.page_video .txp_barrage_mode .txp_barrage_mode_scroll .txp_barrage_mode_line2{margin-left:6px}.page_video .txp_barrage_mode .txp_barrage_mode_scroll .txp_barrage_mode_line3{width:8px;margin-left:18px}.page_video .txp_barrage_mode .txp_barrage_mode_top .txp_barrage_mode_line2{width:10px;margin-left:16px}.page_video .txp_barrage_mode .txp_barrage_mode_bottom .txp_barrage_mode_line1{width:10px;margin-top:14px;margin-left:16px}.page_video .txp_barrage_mode .txp_current .txp_barrage_mode_box:after{width:42px;height:28px;border:0;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-70px 0;background-size:112px auto}.page_video .txp_barrage_mode .txp_current .txp_barrage_mode_box:before{display:block;position:absolute;right:0;bottom:0;width:14px;height:14px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-25px -54px;background-repeat:no-repeat;background-size:112px auto;content:\"\"}.page_video .txp_barrage_mode .txp_current .txp_barrage_mode_line{background-color:#999}.page_video .txp_barrage_mode .txp_current .txp_barrage_mode_title{color:#999}.page_video .txp_barrage_mode .txp_barrage_mode_box:hover:after{border-color:#999}.page_video .txp_barrage_mode .txp_barrage_mode_box:hover .txp_barrage_mode_line{background-color:#999}.page_video .txp_barrage_mode_block{margin-top:0;margin-right:-26px}.page_video .txp_barrage_mode_block .txp_list_item{margin-right:26px}.page_video .txp_barrage_mode_block .txp_barrage_mode_box{width:62px;height:46px}.page_video .txp_barrage_mode_block .txp_barrage_mode_box:after{width:56px;height:40px}.page_video .txp_barrage_mode_block .txp_barrage_mode_box .txp_barrage_mode_line{width:28px;margin-top:8px}.page_video .txp_barrage_mode_block .txp_barrage_mode_scroll .txp_barrage_mode_line1{margin-left:18px}.page_video .txp_barrage_mode_block .txp_barrage_mode_scroll .txp_barrage_mode_line2{margin-left:9px}.page_video .txp_barrage_mode_block .txp_barrage_mode_scroll .txp_barrage_mode_line3{margin-left:16px}.page_video .txp_barrage_mode_block .txp_barrage_mode_top .txp_barrage_mode_line2{width:18px}.page_video .txp_barrage_mode_block .txp_barrage_mode_bottom .txp_barrage_mode_line1{width:18px;margin-top:23px}.page_video .txp_barrage_mode_block .txp_current .txp_barrage_mode_box:after{width:60px;height:44px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:0 0;background-size:112px auto}.page_video .txp_barrage_mode_block .txp_current .txp_barrage_mode_box:before{width:14px;height:14px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-49px -54px;background-size:112px auto}.page_video .txp_barrage_settings_checkbox{padding-left:0;border-bottom:0}.page_video .txp_barrage_settings_checkbox .txp_checkbox{display:inline-block;position:relative;top:2px;width:12px;height:12px;margin-right:6px;border:1px solid #999;border-radius:7px;cursor:pointer}.page_video .txp_barrage_settings_checkbox .txp_checkbox:hover{border-color:#ff5c38}.page_video .txp_barrage_settings_checkbox .txp_checkbox_selected{width:14px;height:14px;border:0;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-25px -54px;background-size:112px auto}.page_video .txp_popup_barrage_type .txp_barrage_settings{width:225px;line-height:20px}.page_video .txp_popup_barrage_type .txp_popup_barrage_inner{width:auto;height:auto;margin:0}.page_video .txp_barrage_progress{height:20px;font-size:0}.page_video .txp_barrage_progress .txp_barrage_progress_value{display:inline-block;position:absolute;top:16px;right:0;font-size:12px}.page_video .txp_popup_barrage_text .txp_barrage_settings_checkbox{padding-left:0}.page_video .txp_barrage_progress_bar{position:relative;width:180px;height:4px;margin:8px 0;border-radius:2px;background-color:#222225;cursor:pointer}.page_video .txp_barrage_progress_bar:before{display:block;position:absolute;top:-13px;left:0;width:100%;height:30px;content:\"\"}.page_video .txp_barrage_progress_bar .txp_barrage_progress_play{position:absolute;top:0;left:0;height:4px;border-radius:2px;background-color:#ff5945;cursor:pointer}.page_video .txp_barrage_progress_bar .txp_barrage_progress_handler{position:absolute;top:-4px;width:12px;height:12px;margin-left:-6px;border-radius:6px;background-color:#ff5945;cursor:pointer}.page_video .txp_barrage_progress_bar .txp_barrage_progress_handler:hover:after{display:block;position:absolute;top:-4px;left:-4px;width:20px;height:20px;border-radius:10px;background-color:#ff5945;content:\"\";opacity:.2}.page_video .txp_popup_barrage_type{width:335px;height:auto}.page_video .txp_popup_barrage_type .txp_barrage_progress_bar,.page_video .txp_popup_barrage_type .txp_barrage_settings_title{display:inline-block}.page_video .txp_popup_barrage_type .txp_list_item{margin-right:18px}.page_video .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_v2 .txp_popup_barrage_emoji,.page_video .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_v2 .txp_popup_barrage_inner,.page_video .player_container .txp_mod_barrage .txp_barrage_form .txp_popup_barrage_v2 .txp_popup_barrage_text{width:364px}.page_video .txp_html_fullscreen .txp_popup_barrage_v2 .svg_icon_close{margin-top:-10px}.page_video .txp_popup_barrage_v2 .txp_barrage_box{display:block;position:relative;width:100%;overflow:hidden}.page_video .txp_popup_barrage_v2 .txp_barrage_mode{position:relative;left:0;margin-top:0;overflow:visible;white-space:nowrap;-webkit-transition:all .2s ease;transition:all .2s ease}.page_video .txp_popup_barrage_v2 .txp_list_item{margin-right:10px}.page_video .txp_popup_barrage_v2 .txp_popup_barrage_inner{width:364px}.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box:before{background-image:none}.page_video .txp_popup_barrage_v2 .txp_barrage_settings{width:auto;padding:18px 0 0;overflow:visible;border:0}.page_video .txp_popup_barrage_v2 .txp_barrage_settings_checkbox{height:35px;margin:15px 10px 0;padding:0;border-top:1px solid rgba(255,255,255,0.08);color:#999;font-size:12px;line-height:35px;text-align:right}.page_video .txp_popup_barrage_v2 .txp_barrage_settings_checkbox .setting_icon,.page_video .txp_popup_barrage_v2 .txp_barrage_settings_checkbox .txp_setting_icon{display:inline-block;width:16px;height:16px;margin:-1px 5px 0;vertical-align:middle}.page_video .txp_popup_barrage_v2 .txp_barrage_settings_checkbox .setting_icon_pic,.page_video .txp_popup_barrage_v2 .txp_barrage_settings_checkbox .txp_setting_icon_pic{display:block;width:100%;height:100%}.page_video .txp_popup_barrage_v2 .txp_barrage_settings_title{display:block;position:static;margin-bottom:10px;color:#eee;font-size:12px;font-weight:700;line-height:1}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box{display:inline-block;width:22px;height:16px;overflow:visible;vertical-align:middle}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box .txp_barrage_mode_line,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box .txp_barrage_mode_line{z-index:2;position:relative;width:12px;height:1px;margin-top:2px;background:#999}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box .txp_barrage_mode_line1,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box .txp_barrage_mode_line1{margin-top:3px;margin-left:7px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box .txp_barrage_mode_line2,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box .txp_barrage_mode_line2{margin-left:4px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box .txp_barrage_mode_line3,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box .txp_barrage_mode_line3{width:8px;margin-left:9px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box:after,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box:after{box-sizing:border-box;width:22px;height:16px;border:1px solid #999;border-radius:2px;background-image:none}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box:hover .txp_barrage_mode_line,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box:hover .txp_barrage_mode_line{background-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_box:hover:after,.page_video .txp_popup_barrage_v2 .txp_current .txp_barrage_mode_box:hover:after{border-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_top .txp_barrage_mode_line1{width:14px;margin-left:4px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_top .txp_barrage_mode_line2{width:8px;margin-left:7px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_bottom .txp_barrage_mode_line1{width:8px;margin-top:9px;margin-left:7px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_bottom .txp_barrage_mode_line2{width:14px;margin-left:4px}.page_video .txp_popup_barrage_v2 .txp_barrage_mode_title{display:inline-block;margin-left:7px;font-size:12px;line-height:16px;vertical-align:middle}.page_video .txp_popup_barrage_v2 .txp_barrage_btn{box-sizing:border-box;position:relative;width:64px;height:30px;border:2px solid transparent;border-radius:30px;outline:0;background:0;color:#fff;font-size:12px;cursor:pointer}.page_video .txp_popup_barrage_v2 .txp_barrage_btn.current,.page_video .txp_popup_barrage_v2 .txp_barrage_btn:hover{border:2px solid #ff5c38!important}.page_video .txp_popup_barrage_v2 .txp_barrage_btn.current:after{display:block;position:absolute;right:-2px;bottom:-2px;width:10px;height:10px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-73px -54px;background-repeat:no-repeat;background-size:112px auto;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_btn .star_bg{display:block;position:absolute;top:0;left:0;width:100%;height:100%;background:no-repeat 50% \/ auto 100%}.page_video .txp_popup_barrage_v2 .txp_barrage_color .txp_list_item{margin-right:22px}.page_video .txp_popup_barrage_v2 .txp_barrage_color .current .txp_barrage_btn{border:2px solid #ff5c38!important}.page_video .txp_popup_barrage_v2 .txp_barrage_color .current .txp_barrage_btn .txp_barrage_btn_mark{top:-2px;right:-2px}.page_video .txp_popup_barrage_v2 .txp_barrage_color .current .txp_barrage_btn:after{display:block;position:absolute;right:-2px;bottom:-2px;width:10px;height:10px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-73px -54px;background-repeat:no-repeat;background-size:112px auto;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_color .text,.page_video .txp_popup_barrage_v2 .txp_barrage_color .txp_text{display:block;position:relative;max-width:48px;margin:0 auto;overflow:hidden;text-align:center}.page_video .txp_popup_barrage_v2 .txp_barrage_genre{padding-bottom:5px}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box .hover_mark,.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box .txp_hover_mark{display:inline-block;z-index:1;position:absolute;right:-1px;bottom:-1px;width:10px;height:10px}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box .hover_mark:before,.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box .txp_hover_mark:before{display:block;position:absolute;right:-3px;bottom:-3px;width:10px;height:10px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-73px -54px;background-repeat:no-repeat;background-size:112px auto;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box .txp_barrage_mode_line{background:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .current .txp_barrage_mode_box:after{-webkit-clip-path:polygon(0 0,28px 0,0 25px);border-color:#ff5c38;clip-path:polygon(0 0,28px 0,0 25px)}.page_video .txp_popup_barrage_v2 .txp_barrage_color_vip .txp_barrage_btn{border:0}.page_video .txp_popup_barrage_v2 .txp_barrage_color_vip .txp_barrage_btn .txp_barrage_btn_mark{display:block;position:absolute;top:0;right:0;width:20px;height:10px;background:no-repeat 50% \/ cover;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_color_vip .txp_barrage_btn:hover{border:2px solid #ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_color_vip .txp_barrage_btn:hover .txp_barrage_btn_mark{top:-2px;right:-2px}.page_video .txp_popup_barrage_v2 .stars_avatar,.page_video .txp_popup_barrage_v2 .txp_stars_avatar{box-sizing:border-box;display:block;position:relative;width:60px;height:60px;margin:0 auto;border:1px solid #fff;border:1px solid rgba(255,255,255,0.24);border-radius:4px}.page_video .txp_popup_barrage_v2 .stars_avatar .txp_barrage_btn_mark,.page_video .txp_popup_barrage_v2 .txp_stars_avatar .txp_barrage_btn_mark{display:block;position:absolute;right:-1px;bottom:-1px;width:20px;height:10px;background:no-repeat 50% \/ cover}.page_video .txp_popup_barrage_v2 .stars_avatar_pic,.page_video .txp_popup_barrage_v2 .txp_stars_avatar_pic{z-index:-1;position:absolute;top:0;right:-1px;bottom:0;left:-1px;width:60px;height:auto;margin:auto}.page_video .txp_popup_barrage_v2 .stars_name,.page_video .txp_popup_barrage_v2 .txp_stars_name{display:block;width:60px;margin-top:4px;overflow:hidden;color:#ccc;font-size:12px;line-height:1;text-align:center;white-space:nowrap}.page_video .txp_popup_barrage_v2 .txp_barrage_stars{margin-right:0;line-height:1}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item{margin-right:28px}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .stars_avatar,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .txp_stars_avatar{border-width:2px;border-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .stars_avatar:after,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .txp_stars_avatar:after{display:block;position:absolute;top:-2px;right:-2px;width:15px;height:15px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:0 -54px;background-repeat:no-repeat;background-size:112px auto;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .stars_avatar_pic,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .txp_stars_avatar_pic{right:-2px;left:-2px}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .txp_barrage_btn_mark{right:-2px;bottom:-2px}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .stars_name,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .current .txp_stars_name{color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item:hover .stars_avatar,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item:hover .txp_stars_avatar{border-width:2px;border-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item:hover .stars_avatar_pic,.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item:hover .txp_stars_avatar_pic{right:-2px;left:-2px}.page_video .txp_popup_barrage_v2 .txp_barrage_stars .txp_list_item:hover .txp_barrage_btn_mark{right:-2px;bottom:-2px}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_next,.page_video .txp_popup_barrage_v2 .txp_barrage_btn_prev{box-sizing:content-box;position:absolute;top:0;bottom:0;width:20px;height:20px;margin:auto;cursor:pointer}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_next:hover,.page_video .txp_popup_barrage_v2 .txp_barrage_btn_prev:hover{color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_prev{left:-30px}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_next{right:-30px}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_stars{padding:51px 10px 27px}.page_video .txp_popup_barrage_v2 .txp_barrage_btn_color{padding:37px 10px 0}.page_video .txp_popup_barrage_v2 .txp_icon{fill:currentColor;display:block;width:100%;height:100%}.page_video .txp_popup_barrage_v2 .txp_barrage_title{color:#eee;font-size:14px;font-weight:700;text-align:center}.page_video .txp_popup_barrage_v2 .txp_barrage_title .text,.page_video .txp_popup_barrage_v2 .txp_barrage_title .txp_text{display:inline-block;position:relative}.page_video .txp_popup_barrage_v2 .txp_barrage_title .text:after,.page_video .txp_popup_barrage_v2 .txp_barrage_title .text:before,.page_video .txp_popup_barrage_v2 .txp_barrage_title .txp_text:after,.page_video .txp_popup_barrage_v2 .txp_barrage_title .txp_text:before{display:block;position:absolute;top:0;bottom:0;width:10px;height:1px;margin:auto;background:#999;content:\"\"}.page_video .txp_popup_barrage_v2 .txp_barrage_title .text:before,.page_video .txp_popup_barrage_v2 .txp_barrage_title .txp_text:before{left:-20px}.page_video .txp_popup_barrage_v2 .txp_barrage_title .text:after,.page_video .txp_popup_barrage_v2 .txp_barrage_title .txp_text:after{right:-20px}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item{width:64px}.page_video .txp_popup_barrage_v2.txp_popup_barrage_alert .txp_popup_barrage_inner{background:#000;background:rgba(0,0,0,0.76)}.page_video .txp_popup_barrage_v2 .txp_popup_get_vip{padding:30px;color:#d6ab56;font-size:12px;text-align:center}.page_video .txp_popup_barrage_v2 .txp_barrage_vip_desc{margin-bottom:19px}.page_video .txp_popup_barrage_v2 .txp_barrage_vip_title{margin-bottom:12px;font-size:14px;font-weight:700}.page_video .txp_popup_barrage_v2 .txp_barrage_vip_btn{width:116px;height:32px;border:0;border-radius:20px;outline:0;background:#d5ab56;color:#fff;font-size:12px;font-weight:700;cursor:pointer}.page_video .txp_popup_barrage_v2 .txp_barrage_vip_btn:active{background:#d5ab56;color:#fff;opacity:.6}.page_video .txp_popup_barrage_v2 .txp_barrage_vip_btn:hover{background:#e8bd69}.page_video .txp_popup_barrage_v2 .txp_popup_up_vip{margin:0;padding:0}.page_video .txp_popup_barrage_v2 .txp_up_vip_pic{width:100%;height:auto}.page_video .txp_popup_barrage_v2 .txp_barrage_close{box-sizing:border-box;box-sizing:content-box;display:block;position:absolute;top:0;right:0;width:10px;height:10px;padding:13px;color:#ededed}.page_video .txp_popup_barrage_v2 .txp_barrage_close:hover{color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_popup_emoji{max-height:92px;margin:20px 0;padding:0 16px 0 21px;overflow:auto;font-size:0}.page_video .txp_popup_barrage_v2 .txp_emoji_tips{box-sizing:border-box;display:block;height:92px;margin:20px 15px;padding:0;color:#999;line-height:92px;text-align:center}.page_video .txp_popup_barrage_v2 .svg_icon_emoji_tips{display:inline-block;width:18px;height:18px;vertical-align:middle}.page_video .txp_popup_barrage_v2 .txp_popup_emoji_text{display:inline-block;vertical-align:middle}.page_video .txp_popup_barrage_v2 .txp_popup_emoji_icon{display:inline-block;position:relative;width:36px;height:36px;margin:5px;cursor:pointer}.page_video .txp_popup_barrage_v2 .txp_popup_emoji_icon .txp_barrage_btn_mark{position:absolute;right:0;bottom:0;width:20px;height:10px;background:no-repeat 50% \/ cover}.page_video .txp_popup_barrage_v2 .txp_popup_emoji_pic{-o-object-fit:contain;display:inline-block;width:100%;height:100%;object-fit:contain}.page_video .txp_popup_barrage_v2 .txp_popup_toast{-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%);display:inline-block;position:absolute;top:50%;right:0;left:0;max-width:200px;margin:auto;padding:7px 20px;transform:translateY(-50%);border-radius:50px;background:#111;background:rgba(17,17,17,0.9);font-size:12px;line-height:20px;text-align:center}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item.current .txp_barrage_mode_box:after,.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item:hover .txp_barrage_mode_box:after{border-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item.current .txp_barrage_mode_line,.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item:hover .txp_barrage_mode_line{background-color:#ff5c38}.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item.current .txp_barrage_mode_title,.page_video .txp_popup_barrage_v2 .txp_barrage_genre .txp_list_item:hover .txp_barrage_mode_title{color:#ff5c38}.page_video .lte_ie8 svg{display:none}.page_video .lte_ie8 .txp_popup_barrage .txp_btn_next,.page_video .lte_ie8 .txp_popup_barrage .txp_btn_prev{width:12px;height:18px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:0 -79px;background-size:112px auto}.page_video .lte_ie8 .txp_popup_barrage .txp_btn_next{width:12px;height:18px;background-image:url(\/tencentvideo\/txp\/style\/img\/sprite\/txp_barrage_set.png?v=c37949b74c);background-position:-22px -79px;background-size:112px auto}@-webkit-keyframes txp_barrage{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}90%{opacity:1}to{-webkit-transform:translateX(-2800px);transform:translateX(-2800px);opacity:0}}@keyframes txp_barrage{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}90%{opacity:1}to{-webkit-transform:translateX(-2800px);transform:translateX(-2800px);opacity:0}}@-webkit-keyframes txp_barrage_plusone{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}to{-webkit-transform:translateY(-40px);transform:translateY(-40px);opacity:0}}@keyframes txp_barrage_plusone{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}to{-webkit-transform:translateY(-40px);transform:translateY(-40px);opacity:0}}@-webkit-keyframes txp_barrage_star{0%{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}50%{-webkit-transform:rotate(180deg) scale(1.1);transform:rotate(180deg) scale(1.1)}to{-webkit-transform:rotate(1turn) scale(1);transform:rotate(1turn) scale(1)}}@keyframes txp_barrage_star{0%{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}50%{-webkit-transform:rotate(180deg) scale(1.1);transform:rotate(180deg) scale(1.1)}to{-webkit-transform:rotate(1turn) scale(1);transform:rotate(1turn) scale(1)}}@-webkit-keyframes txp_barrage_item_star_show{0%{opacity:0}to{opacity:1}}@keyframes txp_barrage_item_star_show{0%{opacity:0}to{opacity:1}}@-webkit-keyframes txp_barrage_item_star{0%{top:200px}to{top:15px}}@keyframes txp_barrage_item_star{0%{top:200px}to{top:15px}}@keyframes txp_barrage_item_show{0%{opacity:0}5%{opacity:1}95%{opacity:1}to{opacity:0}}@-webkit-keyframes txp_barrage_item_show{0%{opacity:0}5%{opacity:1}95%{opacity:1}to{opacity:0}}.page_video .txp_barrage{-webkit-transform:translateZ(0);z-index:3;position:absolute;top:0;left:0;width:100%;height:100%;transform:translateZ(0);text-overflow:ellipsis;pointer-events:none}.page_video .txp_barrage_item{stroke-width:1px;stroke:rgba(0,0,0,0.5);position:absolute;top:0;left:0;padding:4px;background-color:#fff;background-color:rgba(255,255,255,0.01);font-size:18px;line-height:24px;text-shadow:0 0 1px rgba(0,0,0,0.3),0 1px 0 rgba(0,0,0,0.3),0 0 1px rgba(0,0,0,0.3),0 0 1px rgba(0,0,0,0.3);white-space:nowrap;cursor:pointer;pointer-events:auto;font-weight:700;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.page_video .txp_barrage_item .txp_text{display:inline-block;max-width:680px;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.page_video .txp_barrage_item .txp_img{display:inline-block;width:auto;height:28px;vertical-align:top}.page_video .txp_barrage_item .txp_barrage_content{display:inline-block;vertical-align:top}.page_video .txp_barrage_item_bottom,.page_video .txp_barrage_item_top{-webkit-transform:translate(-50%);-ms-transform:translate(-50%);stroke-width:1px;stroke:rgba(0,0,0,0.5);-webkit-backface-visibility:hidden;position:absolute;top:20px;left:50%;width:auto;padding:4px;transform:translate(-50%);backface-visibility:hidden;font-size:18px;line-height:24px;text-align:center;text-shadow:0 0 1px #000;white-space:nowrap;cursor:pointer;opacity:0;pointer-events:auto}.page_video .txp_barrage_item_bottom.txp_animate,.page_video .txp_barrage_item_top.txp_animate{-webkit-animation:txp_barrage_item_show 5s ease both;animation:txp_barrage_item_show 5s ease both}.page_video .txp_barrage_item_top{top:20px}.page_video .txp_barrage_item_bottom{top:auto;bottom:24%}.page_video .txp_barrage_item_bottom2{margin-bottom:40px}.page_video .txp_svg_icon_like{fill:currentColor;width:20px;height:20px}.page_video .txp_icon_like{width:20px;height:20px}.page_video .txp_barrage_hide_bottom .txp_barrage_item_bottom,.page_video .txp_barrage_hide_roll .txp_barrage_item,.page_video .txp_barrage_hide_top .txp_barrage_item_star,.page_video .txp_barrage_hide_top .txp_barrage_item_top{display:none}.page_video .txp_barrage_hide_bottom .txp_barrage_item_bottom.txp_barrage_item_mine,.page_video .txp_barrage_hide_roll .txp_barrage_item.txp_barrage_item_mine,.page_video .txp_barrage_hide_top .txp_barrage_item_star.txp_barrage_item_mine,.page_video .txp_barrage_hide_top .txp_barrage_item_top.txp_barrage_item_mine{display:block}.page_video .txp_barrage_pause{-webkit-animation-play-state:paused;animation-play-state:paused}.page_video .txp_barrage_plusone{-webkit-animation:txp_barrage_plusone 1s linear both;position:absolute;top:-20px;right:10px;color:#ff4200;font-size:20px;animation:txp_barrage_plusone 1s linear both}.page_video .txp_barrage_emotion{display:inline-block;width:24px;height:24px;margin-right:2px;vertical-align:-3px}.page_video .txp_barrage_report{z-index:999;position:absolute;top:0;left:0;width:80px;height:30px;border-radius:15px;background-color:#373742;background-color:rgba(55,55,66,0.95);color:#fff;font-size:14px;line-height:30px;text-align:center;cursor:pointer}.page_video .txp_barrage_report:hover{color:#ff920b}.page_video .txp_barrage_report:hover .txp_svg_icon_report{fill:#ff920b}.page_video .txp_svg_icon_report{fill:#fff;width:20px;height:20px;margin-top:7px;vertical-align:top;pointer-events:none}.page_video .txp_barrage_item_bubble{padding:4px 50px 4px 4px;border:1px solid #fff;border:1px solid rgba(255,255,255,0.5);border-radius:20px;background-position:100%;background-repeat:no-repeat;background-size:contain!important}.page_video .txp_player_live .txp_barrage_item_bubble{padding-right:10px}.page_video .txp_barrage_vipicon{position:absolute;top:19px;left:15px;height:13px}.page_video .txp_barrage_item_mine{z-index:1;width:auto;padding:4px 6px 4px 4px;border:1px solid #fff;border-radius:20px}.page_video .txp_barrage_avatar,.page_video .txp_barrage_emoji{display:inline-block;position:relative;width:24px;height:24px;margin-right:6px;border-radius:100%;background:no-repeat .5% auto;vertical-align:top;pointer-events:auto}.page_video .txp_barrage_emoji{margin:0 1px}.page_video .txp_barrage_badge,.page_video .txp_barrage_text{display:inline-block;vertical-align:top}.page_video .txp_barrage_badge{margin-left:4px}.page_video .txp_barrage_badge .txp_icon_text{display:inline-block;margin-left:3px}.page_video .txp_barrage_lv1{color:#ff4200}.page_video .txp_barrage_lv2{color:#ff7800}.page_video .txp_barrage_lv3{color:#edc88d}.page_video .txp_barrage_lv4{color:#fff}.page_video .txp_barrage_lv5{color:#37a5e4}.page_video .txp_barrage_item_mine.txp_barrage_item_bubble{padding:4px 50px 4px 4px}.page_video .txp_barrage_item_star{-webkit-transform:translate(-50%);-ms-transform:translate(-50%);-webkit-animation:txp_barrage_item_star_show .2s ease 1 both,txp_barrage_item_star .4s linear .1s 1 both;z-index:2;position:absolute;left:50%;width:auto;transform:translate(-50%);animation:txp_barrage_item_star_show .2s ease 1 both,txp_barrage_item_star .4s linear .1s 1 both;cursor:pointer;pointer-events:auto}.page_video .txp_barrage_item_star .txp_barrage_avatar{z-index:3;position:absolute;top:-1px;left:0;width:36px;height:36px}.page_video .txp_barrage_item_star .txp_barrage_star{-webkit-transform-origin:30px 32px;-ms-transform-origin:30px 32px;-webkit-animation:txp_barrage_star .6s linear .4s 1 both;z-index:2;position:absolute;top:-16px;left:-12px;width:60px;height:60px;transform-origin:30px 32px;background:url(\/tencentvideo\/txp\/style\/img\/avatar_star.svg) 0 0 no-repeat;-webkit-animation:txp_barrage_star .6s linear .4s 1 both;animation:txp_barrage_star .6s linear .4s 1 both}.page_video .txp_barrage_item_star .txp_barrage_content{-webkit-backface-visibility:hidden;display:inline-block;z-index:1;position:relative;padding:4px 15px 4px 50px;border:1px solid #ffcc02;border-radius:20px;backface-visibility:hidden;background-color:#000;background-color:rgba(0,0,0,0.6);font-size:22px;font-size:20px;line-height:24px;text-shadow:0 0 1px rgba(0,0,0,0.5);white-space:nowrap;cursor:pointer}.page_video .txp_barrage_item_img{display:none;z-index:-1;position:absolute;top:0;left:0;cursor:pointer;pointer-events:auto}.page_video .txp_html_fullscreen .txp_barrage_item_star{margin-top:40px}.page_video .txp_html_fullscreen .txp_barrage{overflow:hidden}.page_video .txp_barrage_item_prop{z-index:1;width:auto;padding:2px 58px 2px 2px;border:1px solid #ff5c38;border:1px solid rgba(255,92,56,0.6);border-radius:20px;background-color:#ff5c38;background-color:rgba(255,92,56,0.4)}.page_video .txp_barrage_item_prop .txp_prop_img{position:absolute;top:0;right:10px;width:auto;height:30px}.page_video .txp_barrage_animate{position:absolute;top:0;left:0;width:100%;height:100%;overflow:visible;background:repeat-x 0 \/ auto 100%;pointer-events:none}.page_video .txp_barrage_animate.animated{background-image:url(\/tencentvideo\/txp\/style\/img\/apng\/stars.png)}.page_video .txp_barrage_animate_pendant{position:absolute;top:0;bottom:0;width:10px;height:10px;margin:auto}.page_video .txp_barrage_animate_pendant .pic{-o-object-fit:contain;display:block;position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain}.page_video .animated .txp_barrage_animate_pendant1{-webkit-animation:txp_barrage_pendant1 10s linear infinite;animation:txp_barrage_pendant1 10s linear infinite}.page_video .animated .txp_barrage_animate_pendant2{-webkit-animation:txp_barrage_pendant2 10s linear infinite;animation:txp_barrage_pendant2 10s linear infinite}.page_video .txp_barrage_item_v2{padding:6px 4px 6px 50px}.page_video .txp_barrage_item_v2 .txp_barrage_avatar{position:absolute;top:-2px;left:5px;width:40px;height:40px}.page_video .txp_barrage_item_v2.txp_barrage_item_mine{padding-right:6px}.page_video .txp_barrage_item .txp_text.txp_gradation,.page_video .txp_barrage_item_bottom .txp_text.txp_gradation,.page_video .txp_barrage_item_top .txp_text.txp_gradation{font-weight:700}@media(max-width:1269px){.page_video .txp_mod_barrage .txp_barrage_input_box{width:-ms-calc(30%);width:calc(30%)}.page_video .txp_mod_barrage .stars_pendant_avatar,.page_video .txp_mod_barrage .stars_pendant_name{max-width:34px}}";
});function _typeof2(t){
return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t;
}
var _extends=Object.assign||function(t){
for(var e=1;e<arguments.length;e++){
var i=arguments[e];
for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);
}
return t;
};
define("pages_new/common_share/video/player/plugins/danmu/danmu_util.js",[],function(){
"use strict";
function t(e){
return(t="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){
return"undefined"==typeof t?"undefined":_typeof2(t);
}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":"undefined"==typeof t?"undefined":_typeof2(t);
})(e);
}
function e(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}
function i(t,e){
for(var i=0;i<e.length;i++){
var n=e[i];
n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n);
}
}
function n(t,e,n){
return e&&i(t.prototype,e),n&&i(t,n),t;
}
function a(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");
t.prototype=Object.create(e&&e.prototype,{
constructor:{
value:t,
writable:!0,
configurable:!0
}
}),e&&o(t,e);
}
function s(t){
return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){
return t.__proto__||Object.getPrototypeOf(t);
})(t);
}
function o(t,e){
return(o=Object.setPrototypeOf||function(t,e){
return t.__proto__=e,t;
})(t,e);
}
function r(t){
if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return t;
}
function l(t,e){
return!e||"object"!==("undefined"==typeof e?"undefined":_typeof2(e))&&"function"!=typeof e?r(t):e;
}
function h(t,e){
return c(t)||u(t,e)||d();
}
function c(t){
return Array.isArray(t)?t:void 0;
}
function u(t,e){
var i=[],n=!0,a=!1,s=void 0;
try{
for(var o,r=t[Symbol.iterator]();!(n=(o=r.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);
}catch(l){
a=!0,s=l;
}finally{
try{
n||null==r["return"]||r["return"]();
}finally{
if(a)throw s;
}
}
return i;
}
function d(){
throw new TypeError("Invalid attempt to destructure non-iterable instance");
}
function f(t,e){
return e={
exports:{}
},t(e,e.exports),e.exports;
}
function p(t,e,i){
this.now=0,this.afternow=0,this.delta=0,this.fps=t||10,this.interval=parseInt(1e3/t,10),
this.callback=e||"",this.timecount=0,this.running=!1,this.timemode=i||"auto",this.index=Date.now(),
"timeout"!==this.timemode&&(this.timemode="auto"),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
}
function m(t,e,i){
return new p(t,e,i);
}
function g(t){
var e=[],i=0,n=200,a=[],s={
get:function(){
if(e.length)return e.shift();
if(n>i){
i+=1;
var a=new t;
return a;
}
return null;
},
save:function(t){
t&&e.push(t);
},
getLength:function(){
return e.length;
},
getAll:function(){
return a;
}
};
return s;
}
function _(t,i,o,r){
var c=i||null,u=o||null,d=!!r,f=function(){
function t(){
e(this,t),this._left=0,this._top=0,this._bottom=0,this._dom=null,this._animate=null,
this._trail=-1,this._width=0,this.el=null,this.elText=null,this.fontSize=0,this.height=0,
this.enableColor=!0,this.currentColor="",this.id=null,this.originContent="",this.isSys=!1,
this.count=0,this.isStar=!1;
}
return n(t,[{
key:"render",
value:function(t,e,i){
this.el||(this.write(),this.addClickEvent());
var n;
t.html?(this.el.innerHTML=t.html,n=t.html.length||0):(this.el.innerText=t.content,
n=t.content.length||0),t.contentLength||(t.contentLength=n),this._width=parseFloat(getComputedStyle(this.el).width),
this.font(e,i),t.gradienColor?this.gradienColor(t.gradienColor):this.color(t.color||"#ffffff"),
this.id=t.id?t.id:null,this.originContent=t.originContent?t.originContent:"",this.isSys=!!t.isSys,
this.isStar=!!t.isStar,this.count=0,this.isStar?he.addClass(this.el,"txp_barrage_item_speaker"):he.removeClass(this.el,"txp_barrage_item_speaker"),
t.isself?he.addClass(this.el,"txp_barrage_item_self"):he.removeClass(this.el,"txp_barrage_item_self");
}
},{
key:"font",
value:function(t,e){
t?this.fontSize!==+t&&(this.fontSize=t,this.height=Math.ceil(1.5*t),this.el.style.fontSize="".concat(t,"px"),
this.el.style.lineHeight="".concat(this.height-6,"px"),this.el.style.height="".concat(this.height,"px")):e&&this.height!==+e&&(this.height=e,
this.el.style.height="".concat(this.height,"px"),this.el.style.lineHeight="".concat(this.height,"px"),
this.el.style.padding=0);
}
},{
key:"color",
value:function(t){
t&&(this.disableColor(),he.css(this.el,"color",t));
}
},{
key:"gradienColor",
value:function(t){
t?t[1]!==t[0]?(he.css(this.el,"color",t[1]),he.css(this.el,"background-image","linear-gradient(to right,".concat(t[0]," 0,").concat(t[1]," 100%)")),
he.css(this.el,"-webkit-text-fill-color","transparent"),he.css(this.el,"background-repeat","repeat"),
he.css(this.el,"-webkit-background-clip","text"),he.css(this.el,"text-shadow","none")):this.color(t[1]):this.disableColor();
}
},{
key:"disableColor",
value:function(){
he.css(this.el,"background-image",""),he.css(this.el,"-webkit-text-fill-color",""),
he.css(this.el,"background-repeat",""),he.css(this.el,"-webkit-background-clip",""),
he.css(this.el,"text-shadow","");
}
},{
key:"addClickEvent",
value:function(){
var t=this;
c&&this.el.addEventListener("click",function(){
c(t);
}),u&&this.el.addEventListener("contextmenu",function(e){
t.isSys||(e.stopPropagation(),e.preventDefault(),u({
danmuItem:t,
x:e.clientX,
y:e.clientY
}));
});
}
},{
key:"left",
get:function(){
return this._left;
}
},{
key:"trail",
get:function(){
return this._trail;
},
set:function(t){
this._trail=t>0?t:-1;
}
},{
key:"width",
get:function(){
return this._width;
}
}]),t;
}(),p=function(i){
function o(){
var t;
return e(this,o),t=l(this,s(o).call(this)),t.isHove=!1,t;
}
return a(o,i),n(o,[{
key:"write",
value:function(){
var e=this,i=document.createElement("div");
i.innerHTML=oe,this.el=i.firstChild,t.appendChild(this.el);
var n=this.el.getElementsByClassName("txp_text"),a=h(n,1),s=a[0];
this.elText=s,d&&(this.el.addEventListener("mouseenter",function(){
e.isSys||e.isStar||(he.addClass(e.el,"txp_barrage_item_hover"),e.isHove=!0);
}),this.el.addEventListener("mouseleave",function(){
e.isSys||e.isStar||(he.removeClass(e.el,"txp_barrage_item_hover"),e.isHove=!1);
}));
}
},{
key:"move",
value:function(t,e){
return t+this.width+50<0||t>window.innerWidth?this.el.setAttribute("aria-hidden",!0):this.el.removeAttribute("aria-hidden"),
this.isStar&&3>t&&t>-10&&this.count<120?void(this.count+=1):(this._left=t,e>=0&&e!==this._top&&(this._top=e),
this.el.style.transform="translate3D(".concat(this._left,"px, ").concat(this._top,"px, 1px)"),
void("number"!=typeof window.top.__fontScaleBackForAndroid__||1===window.top.__fontScaleBackForAndroid__||this.el.getAttribute("mp-original-font-size")||(this.el.style.transform+=" scale3d(".concat(window.top.__fontScaleBackForAndroid__,", ").concat(window.top.__fontScaleBackForAndroid__,", 1)"))));
}
}]),o;
}(f),m=function(t){
function i(){
var t;
return e(this,i),t=l(this,s(i).call(this)),t["class"]="txp_animate",t.hide="txp_none",
t.available=!0,t.isHover=!1,t.paused=!1,t;
}
return a(i,t),n(i,[{
key:"pauseAnimate",
value:function(t){
t&&(this.paused=!0),he.css(this.el,"opacity",1),he.css(this.el,"animation-play-state","paused"),
he.css(this.el,"-webkit-animation-play-state","paused");
}
},{
key:"resumeAnimate",
value:function(t){
t&&(this.paused=!1),he.css(this.el,"opacity",""),he.css(this.el,"animation-play-state","running"),
he.css(this.el,"-webkit-animation-play-state","running");
}
},{
key:"removeAnimate",
value:function(){
var t=this;
this.el&&(he.removeClass(this.el,this["class"]),he.addClass(this.el,this.hide)),
setTimeout(function(){
t.available=!0;
},100);
}
},{
key:"startAnimate",
value:function(){
this.available=!1,he.addClass(this.el,this["class"]),he.removeClass(this.el,this.hide);
}
},{
key:"setBottom",
value:function(t){
t>=0&&t!==this._bottom&&(this._bottom=t),this.el.style.bottom="".concat(this._bottom,"px"),
this.startAnimate();
}
},{
key:"setTop",
value:function(t){
t>=0&&t!==this._top&&(this._top=t),this.el.style.top="".concat(this._top,"px"),this.startAnimate();
}
},{
key:"addEvent",
value:function(){
var t=this;
this.el.addEventListener("animationend",function(){
t.removeAnimate();
}),this.el.addEventListener("mouseenter",function(){
he.addClass(t.el,"txp_barrage_item_hover"),t.pauseAnimate(),t.isHover=!0;
}),this.el.addEventListener("mouseleave",function(){
he.removeClass(t.el,"txp_barrage_item_hover"),t.paused||t.resumeAnimate(),t.isHover=!1;
});
}
}]),i;
}(f),g=function(i){
function o(){
return e(this,o),l(this,s(o).apply(this,arguments));
}
return a(o,i),n(o,[{
key:"write",
value:function(){
var e=document.createElement("div");
e.innerHTML=re,this.el=e.firstChild,t.appendChild(this.el);
var i=this.el.getElementsByClassName("txp_text"),n=h(i,1),a=n[0];
this.elText=a,this.addEvent();
}
}]),o;
}(m),_=function(i){
function o(){
return e(this,o),l(this,s(o).apply(this,arguments));
}
return a(o,i),n(o,[{
key:"write",
value:function(){
var e=document.createElement("div");
e.innerHTML=le,this.el=e.firstChild,t.appendChild(this.el);
var i=this.el.getElementsByClassName("txp_text"),n=h(i,1),a=n[0];
this.elText=a,this.addEvent();
}
}]),o;
}(m);
return{
baseBarrage:f,
scrollBarrage:p,
TopBarrage:g,
BottomBarrage:_
};
}
function b(t){
return"string"!=typeof t?t:t.replace(/\?.+/g,"");
}
function y(){}
function v(t){
return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t);
}
function x(t,e){
var i,n={
xs:{
xxs:12,
xs:14,
s:16,
m:18,
l:20,
xl:22,
xxl:26
},
s:{
xxs:13,
xs:17,
s:19,
m:21,
l:23,
xl:25,
xxl:29
},
m:{
xxs:15,
xs:19,
s:21,
m:23,
l:25,
xl:27,
xxl:31
},
l:{
xxs:17,
xs:21,
s:23,
m:25,
l:27,
xl:29,
xxl:33
},
xl:{
xxs:25,
xs:29,
s:31,
m:33,
l:35,
xl:37,
xxl:41
}
};
return i=1024>=t?n.xs:t>1024&&1240>=t?n.s:t>1240&&1600>=t?n.m:t>1600&&1920>=t?n.l:t>1920?n.xl:n.m,
i[e];
}
function w(t){
t.prototype.start=function(t){
this.dataset.state=1,this._start(t);
},t.prototype.pause=function(){
this.dataset.state=2,this._pause();
},t.prototype.setFont=function(t){
var e=["xxs","xs","s","m","l","xl","xxl"];
e.indexOf(t)>-1&&(this.dataset.fontSetting=t),this.updateFont(),this.updateLineNum();
},t.prototype.setRate=function(t){
this.dataset.rate!==t&&(this.dataset.rate=t,this.dataset.realSpeed={
0:this.dataset.speed*this.dataset.rate*1.2,
1:this.dataset.speed*this.dataset.rate
});
},t.prototype.setOpacity=function(t){
this._setOpacity(t);
},t.prototype.setLine=function(t){
this.dataset.userNum=t,this.updateLineNum();
},t.prototype.enableColor=function(){
this._toggleColor(!0);
},t.prototype.disableColor=function(){
this._toggleColor(!1);
},t.prototype.hideScroll=function(){
this._clearScroll(),this.dataset.enableScroll=!1;
},t.prototype.showScroll=function(){
this.dataset.enableScroll=!0;
},t.prototype.hideTop=function(){
this._handlePosition("top","clear"),this.dataset.enableTop=!1;
},t.prototype.showTop=function(){
this.dataset.enableTop=!0;
},t.prototype.hideBottom=function(){
this._handlePosition("bottom","clear"),this.dataset.enableBottom=!1;
},t.prototype.showBottom=function(){
this.dataset.enableBotton=!0;
},t.prototype.switchOn=function(){
this.start();
},t.prototype.play=t.prototype.switchOn,t.prototype.switchOff=function(){
this.pause(),this._clear();
},t.prototype.end=t.prototype.switchOff,t.prototype.updateTime=function(t){
this.index=t;
},t.prototype.add=function(t){
t&&this._addDanmu(JSON.parse(JSON.stringify(t)));
};
}
function k(t){
t.prototype._createTopDanmu=function(){
var t=5;
this.dataset.topList||(this.dataset.topList=[]);
var e,i,n=this.dataset.topList;
if(n.length<t)e=new this.Factory.TopBarrage,n.push(e),i=n.length;else for(var a=0,s=n.length;s>a;a+=1)if(n[a].available){
e=n[a],i=a;
break;
}
if(e){
var o=this.list.get(this.dataset.index,5);
o&&(this.dataset.enableColor||(o.color="#ffffff",o.gradienColor=[],o.gradienColor.push("#ffffff"),
o.gradienColor.push("#ffffff")),this.emit("showDanmu",o),e.render(o,this.dataset.fontSize,this.dataset.lineHeight),
e.setTop(i*this.dataset.lineHeight));
}
},t.prototype._createBottomDanmu=function(){
var t=5;
this.dataset.bottomList||(this.dataset.bottomList=[]);
var e,i,n=this.dataset.bottomList;
if(n.length<t)e=new this.Factory.BottomBarrage,n.push(e),i=n.length;else for(var a=0,s=n.length;s>a;a+=1)if(n[a].available){
e=n[a],i=a;
break;
}
if(e){
var o=this.list.get(this.dataset.index,6);
o&&(this.emit("showDanmu",o),this.dataset.enableColor||(o.color="#ffffff",o.gradienColor=[],
o.gradienColor.push("#ffffff"),o.gradienColor.push("#ffffff")),e.render(o,this.dataset.fontSize,this.dataset.lineHeight),
e.setBottom(i*this.dataset.lineHeight+this.dataset.marginBottom));
}
},t.prototype._handlePosition=function(t,e){
var i,n={
clear:"removeAnimate",
pause:"pauseAnimate",
resume:"resumeAnimate"
},a=n[e]||"";
switch(t){
case"top":
i=this.dataset.topList;
break;

case"bottom":
i=this.dataset.bottomList;
}
if(i&&a)for(var s=0,o=i.length;o>s;s+=1)i[s][a]&&i[s][a](!0);
},t.prototype._createTop=function(){
this.dataset.enableTop&&this._createTopDanmu();
},t.prototype._createBottom=function(){
this.dataset.enableBottom&&this._createBottomDanmu();
},t.prototype._createPositionDanmu=function(){
this._createScroll(),this._createTop(),this._createBottom();
};
}
"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{
value:function(t){
if(null==t)throw new TypeError("Cannot convert undefined or null to object");
for(var e=Object(t),i=1;i<arguments.length;i+=1){
var n=arguments[i];
if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);
}
return e;
},
writable:!0,
configurable:!0
});
{
var S=void 0,C=function(t){
return t!==S&&null!==t;
},O={
object:!0,
"function":!0,
undefined:!0
},A=function(t){
return C(t)?hasOwnProperty.call(O,"undefined"==typeof t?"undefined":_typeof2(t)):!1;
},B=function(t){
if(!A(t))return!1;
try{
return t.constructor?t.constructor.prototype===t:!1;
}catch(e){
return!1;
}
},j=function(t){
if("function"!=typeof t)return!1;
if(!hasOwnProperty.call(t,"length"))return!1;
try{
if("number"!=typeof t.length)return!1;
if("function"!=typeof t.call)return!1;
if("function"!=typeof t.apply)return!1;
}catch(e){
return!1;
}
return!B(t);
},T=/^\s*class[\s{\/}]/,E=Function.prototype.toString,P=function(t){
return j(t)?T.test(E.call(t))?!1:!0:!1;
},L=function(){
var t,e=Object.assign;
return"function"!=typeof e?!1:(t={
foo:"raz"
},e(t,{
bar:"dwa"
},{
trzy:"trzy"
}),t.foo+t.bar+t.trzy==="razdwatrzy");
},N=function(){
try{
return Object.keys("primitive"),!0;
}catch(t){
return!1;
}
},z=function(){},H=z(),F=function(t){
return t!==H&&null!==t;
},D=Object.keys,M=function(t){
return D(F(t)?Object(t):t);
},q=N()?Object.keys:M,$=function(t){
if(!F(t))throw new TypeError("Cannot use null or undefined");
return t;
},R=Math.max,I=function(t,e){
var i,n,a,s=R(arguments.length,2);
for(t=Object($(t)),a=function(n){
try{
t[n]=e[n];
}catch(a){
i||(i=a);
}
},n=1;s>n;++n)e=arguments[n],q(e).forEach(a);
if(void 0!==i)throw i;
return t;
},U=L()?Object.assign:I,W=Array.prototype.forEach,J=Object.create,X=function(t,e){
var i;
for(i in t)e[i]=t[i];
},Y=function(){
var t=J(null);
return W.call(arguments,function(e){
F(e)&&X(Object(e),t);
}),t;
},G="razdwatrzy",K=function(){
return"function"!=typeof G.contains?!1:G.contains("dwa")===!0&&G.contains("foo")===!1;
},Q=String.prototype.indexOf,V=function(t){
return Q.call(this,t,arguments[1])>-1;
},Z=K()?String.prototype.contains:V,te=f(function(t){
var e=t.exports=function(t,e){
var i,n,a,s,o;
return arguments.length<2||"string"!=typeof t?(s=e,e=t,t=null):s=arguments[2],C(t)?(i=Z.call(t,"c"),
n=Z.call(t,"e"),a=Z.call(t,"w")):(i=a=!0,n=!1),o={
value:e,
configurable:i,
enumerable:n,
writable:a
},s?U(Y(s),o):o;
};
e.gs=function(t,e,i){
var n,a,s,o;
return"string"!=typeof t?(s=i,i=e,e=t,t=null):s=arguments[3],C(e)?P(e)?C(i)?P(i)||(s=i,
i=void 0):i=void 0:(s=e,e=i=void 0):e=void 0,C(t)?(n=Z.call(t,"c"),a=Z.call(t,"e")):(n=!0,
a=!1),o={
get:e,
set:i,
configurable:n,
enumerable:a
},s?U(Y(s),o):o;
};
}),ee=function(t){
if("function"!=typeof t)throw new TypeError(t+" is not a function");
return t;
},ie=f(function(t,e){
var i,n,a,s,o,r,l,h=Function.prototype.apply,c=Function.prototype.call,u=Object.create,d=Object.defineProperty,f=Object.defineProperties,p=Object.prototype.hasOwnProperty,m={
configurable:!0,
enumerable:!1,
writable:!0
};
i=function(t,e){
var i;
return ee(e),p.call(this,"__ee__")?i=this.__ee__:(i=m.value=u(null),d(this,"__ee__",m),
m.value=null),i[t]?"object"===_typeof2(i[t])?i[t].push(e):i[t]=[i[t],e]:i[t]=e,this;
},n=function(t,e){
var n,s;
return ee(e),s=this,i.call(this,t,n=function(){
a.call(s,t,n),h.call(e,this,arguments);
}),n.__eeOnceListener__=e,this;
},a=function(t,e){
var i,n,a,s;
if(ee(e),!p.call(this,"__ee__"))return this;
if(i=this.__ee__,!i[t])return this;
if(n=i[t],"object"===("undefined"==typeof n?"undefined":_typeof2(n)))for(s=0;a=n[s];++s)(a===e||a.__eeOnceListener__===e)&&(2===n.length?i[t]=n[s?0:1]:n.splice(s,1));else(n===e||n.__eeOnceListener__===e)&&delete i[t];
return this;
},s=function(t){
var e,i,n,a,s;
if(p.call(this,"__ee__")&&(a=this.__ee__[t]))if("object"===("undefined"==typeof a?"undefined":_typeof2(a))){
for(i=arguments.length,s=new Array(i-1),e=1;i>e;++e)s[e-1]=arguments[e];
for(a=a.slice(),e=0;n=a[e];++e)h.call(n,this,s);
}else switch(arguments.length){
case 1:
c.call(a,this);
break;

case 2:
c.call(a,this,arguments[1]);
break;

case 3:
c.call(a,this,arguments[1],arguments[2]);
break;

default:
for(i=arguments.length,s=new Array(i-1),e=1;i>e;++e)s[e-1]=arguments[e];
h.call(a,this,s);
}
},o={
on:i,
once:n,
off:a,
emit:s
},r={
on:te(i),
once:te(n),
off:te(a),
emit:te(s)
},l=f({},r),t.exports=e=function(t){
return null==t?u(l):f(Object(t),r);
},e.methods=o;
});
ie.methods;
}
p.prototype={
setCallBack:function(t){
t&&(this.callback=t);
},
start:function(t){
t&&(this.callback=t),this.running||(this.running=!0,this.afternow=Date.now(),this._timeupdate());
},
stop:function(){
this.running&&(this.running=!1),window.requestAnimationFrame?window.cancelAnimationFrame(this.timecount):clearTimeout(this.timecount),
this.timecount=0;
},
isRunning:function(){
return this.running;
},
_timeupdate:function(){
window.requestAnimationFrame&&"timeout"!==this.timemode?this._rafMode():this._timeoutMode();
},
_rafMode:function(){
var t=this;
this.timecount=requestAnimationFrame(function(){
t._timeupdate();
}),this.now=Date.now(),this.delta=this.now-this.afternow,this.delta>=this.interval&&this.callback&&(this.afternow=this.now-this.delta%this.interval,
this.callback((this.delta/this.interval).toFixed(2)));
},
_timeoutMode:function(){
this.timecount=setTimeout(this._timeupdate,this.interval),this.callback();
}
};
var ne=m,ae='<txpdiv class="txp_barrage txp_barrage_external" style="position:absolute;top:0;left:0;width:100%;height:100%;overflow: hidden;">\n        <style type="text/css">\n            .txp_barrage{\n                top: 0px;\n                right:0px;\n                bottom: 0px;\n                left: 0px;\n                \n                position: absolute;\n                margin: auto;\n            }\n            .txp_barrage .txp_barrage_avatar,.txp_barrage .txp_barrage_emoji{\n                height: 100%;\n                width:unset;\n            }\n            .txp_barrage .txp_barrage_avatar{\n                margin-right:unset; \n            }\n            .txp_barrage .txp_barrage_item .txp_text{\n                height: 100%;\n                background: inherit;\n                -webkit-text-fill-color: inherit;\n                padding: 0 10px;\n            }\n            .txp_barrage .txp_barrage_item_bubble{\n                border-radius:  9999px;\n            }\n            .txp_barrage_item_bubble_front{\n                display: inline-block;\n                position: relative;\n                height: 100%;\n                vertical-align: unset;\n            }\n            .txp_barrage_item_bubble_front .txp_barrage_vipicon{\n                right: 0;\n                bottom: 0;\n                top:unset;\n                left: unset;\n                height: 40%;\n            }\n            .txp_barrage .txp_svg_icon_like{\n                height: 60%;\n                width:unset;\n                vertical-align: unset;\n            }\n            .txp_barrage .txp_barrage_badge{\n                height: 100%;\n                background: unset;\n                -webkit-text-fill-color: white;\n                color: white;\n            }\n            .txp_barrage .txp_barrage_badge .txp_icon_text{\n                -webkit-text-fill-color: white;\n            }\n            .txp_barrage .txp_barrage_item_hover {\n                background: rgba(0,0,0,0.7) !important;\n                color:white !important;\n                border-radius: 99999px;\n                z-index: 1;\n                -webkit-text-fill-color:unset !important;\n            }\n            .txp_barrage .txp_barrage_item_speaker {\n                background-image: linear-gradient(to right,rgba(255,92,56,0.9) 0,rgba(253,177,41,0.9) 100%)!important;\n                color:white !important;\n                border-radius: 99999px;\n                z-index: 1;\n                -webkit-text-fill-color:unset !important;\n                text-shadow: unset !important;\n                stroke: unset !important;           \n\n            }\n            .txp_barrage .txp_barrage_item_speaker .txp_barrage_item_wrapper{\n                background: unset !important;\n            }\n            .txp_barrage .txp_barrage_itxp_barrage_item_speakertem_star .txp_text{\n                background: unset !important;\n            }\n\n            .txp_barrage .txp_barrage_item {\n                padding: 4px 20px 4px 10px;            \n            }\n            .txp_barrage .txp_barrage_item_wrapper{\n                background: inherit;\n                -webkit-text-fill-color: inherit;\n            }\n            \n\n            .txp_barrage .txp_barrage_item_hover .txp_barrage_item_wrapper{\n                background: unset !important;\n            }\n            .txp_barrage .txp_barrage_item_hover .txp_text{\n                background: unset !important;\n            }\n            .txp_barrage .txp_barrage_badge{\n                background: inherit;\n                -webkit-text-fill-color: inherit;\n            }\n            .txp_barrage .txp_icon_text{\n                background: inherit;\n                -webkit-text-fill-color: inherit;\n            }\n            .txp_barrage .txp_barrage_item_self{\n                \n                border: 1px solid white;\n                border-radius: 99999px;\n    \n            }\n            .txp_barrage .like{\n                -webkit-text-fill-color: red;\n            }\n    </style>\n    <svg class="txp_svg_sprite" display="none" version="1.1" xmlns="http://www.w3.org/2000/svg">\n        <symbol id="txp_svg_icon_like" viewBox="0 0 20 20">\n            <path d="M18.4 8.5l-2 9.4c-0.2 0.6-0.2 1.1-0.6 1.3 -0.4 0.3-1 0.2-1.9 0.2 -2.9 0-10.4 0-10.4 0l0-12 2.1-5c0 0 0.6-2 1.7-2 1.4 0 1.2 2 1.2 2s0 1.3 0 3c0 0.7 0.2 1 1 1 6.5 0 6.9 0 6.9 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 1.6-0.2 1.9 0.5C18.5 7.4 18.6 7.9 18.4 8.5zM1.5 19.5c-0.6 0-1-0.4-1-1v-10c0-0.6 0.4-1 1-1s1 0.4 1 1v10C2.5 19.1 2.1 19.5 1.5 19.5z"></path>\n        </symbol>\n    </svg>\n    \n</txpdiv>',se=g,oe='<txpdiv aria-hidden="true" class="txp_barrage_item">\n    <txpdiv class="txp_text"></txpdiv>\n</txpdiv>',re='<txpdiv aria-hidden="true" class="txp_barrage_item_top">\n    <txpdiv class="txp_text"></txpdiv>\n</txpdiv>',le='<txpdiv aria-hidden="true" class="txp_barrage_item_bottom">\n    <txpdiv class="txp_text"></txpdiv>\n</txpdiv>',he={
hasClass:function(t,e){
return t&&t.className&&t.className.indexOf(e)>-1;
},
addClass:function(t,e){
if(!this.hasClass(t,e)&&t)if(t.className&&0!==t.className.length){
var i=t.className.split(" ");
i.push(e),t.className=i.join(" ");
}else t.className=e;
},
removeClass:function(t,e){
if(this.hasClass(t,e)){
var i=t.className.split(" "),n=i.indexOf(e);
i.splice(n,1),t.className=i.join(" ");
}
},
css:function ge(e,i,n){
if(e&&i){
if("undefined"==typeof n&&"string"==typeof i)return;
if("undefined"==typeof n&&"object"===t(i)){
var ge=i;
for(var a in ge)ge.hasOwnProperty(a)&&(/width|height|left|right|top|bottom/.test(a)&&"number"==typeof ge[a]&&(ge[a]="".concat(ge[a],"px")),
e.style[a]=ge[a]);
}else if("string"==typeof i&&("string"==typeof n||"number"==typeof n)){
var s=n;
/width|height|left|right|top|bottom/i.test(i)&&"number"==typeof n&&(s="".concat(n,"px")),
e.style[i]=s;
}
}
}
},ce={},ue={
loadCss:function(t){
var e=1,i=function s(t,i,n){
var a=document.createElement("link");
a.rel="stylesheet",a.type="text/css",a.onload=function(){
i();
},a.onerror=function(){
return e>=3?void n():(e+=1,a.parentNode.removeChild(a),void s("".concat(b(t),"?v=").concat(parseInt(1e10*Math.random())),i,n));
},a.href=t,document.head.appendChild(a);
},n=function(){
for(var e=document.querySelectorAll('link[rel="stylesheet"]'),i=function(t){
var e=t,i=e.indexOf("?");
i>0&&(e=e.slice(0,i));
var n=e.lastIndexOf("/");
return n>0&&(e=e.slice(n+1,e.length)),e;
},n=i(t),a=null,s=e.length,o=0;s>o;o+=1)if(a=e[o],a&&a.href){
var r=i(a.href);
if(r===n)return!0;
}
return!1;
},a=new Promise(function(e,a){
var s=n();
s?e():i(t,e,a);
});
return a;
},
loadScript:function(t){
function e(){
s.test(n.readyState)&&(n.onload=null,n.onerror=null,n.onreadystatechange=null,n=null,
r(!0));
}
var i=t||{};
i.onsuccess=i.onsuccess||y;
var n=document.createElement("script"),a=document.getElementsByTagName("head")[0],s=/^(?:loaded|complete|undefined)$/;
if(i.url){
var o=b(i.url),r=function(t){
var e;
if(ce[o])for(;ce[o].length>0;)e=ce[o].shift(),"function"==typeof e&&e(t);
};
if(ce[o]&&ce[o].length)return void ce[o].push(i.onsuccess);
ce[o]=[i.onsuccess],n.async="async",n.src=i.url,n.charset="utf-8",i.crossorigin&&n.setAttribute("crossorigin",""),
n.onerror=function(){
n.onload=null,n.onerror=null,n.onreadystatechange=null,n=null,r(!1);
},n.onload=e,n.onerror=e,n.onreadystatechange=e,a.appendChild(n);
}
},
hasExsit:function(t){
for(var e=b(t),i=document.getElementsByTagName("script"),n=0,a=i.length;a>n;n+=1)if(i[n].src&&-1!==i[n].src.indexOf(e))return!0;
return!1;
}
},de=function(){
function t(){
e(this,t),this.domlist=[],this.lastDom={};
}
return n(t,[{
key:"handleDom",
value:function(t){
for(var e=this.domlist.length-1;e>=0;e-=1)t&&t(this.domlist[e])&&this.domlist.splice(e,1);
}
},{
key:"checkLast",
value:function(t){
var e=this;
Object.keys(this.lastDom).forEach(function(i){
t(e.lastDom[i],i);
});
}
},{
key:"push",
value:function(t,e){
this.domlist.push(t),this.lastDom[e]=t;
}
}]),t;
}(),fe=function(){
function t(i){
e(this,t),this.list={
scroll:{
show:{},
cache:{}
}
},this.enablePosition=!!i,this.enablePosition&&(this.list.top={
show:{},
cache:{}
},this.list.bottom={
show:{},
cache:{}
});
}
return n(t,[{
key:"addList",
value:function(t){
if(v(t))for(var e=0,i=t.length;i>e;e+=1)this.addBarrage(t[e]);else this.addBarrage(t);
}
},{
key:"addBarrage",
value:function(t){
if("[object Object]"===Object.prototype.toString.call(t)&&(t.html||t.content)){
var e=t.position||1;
this.enablePosition||(e=1),this.add(t,e);
}
}
},{
key:"getList",
value:function(t){
var e;
switch(t){
case 1:
e=this.list.scroll;
break;

case 5:
e=this.list.top;
break;

case 6:
e=this.list.bottom;
break;

default:
e=this.list.scroll;
}
return e;
}
},{
key:"add",
value:function(t,e){
var i,n=this.getList(e);
i=t.mustShow?n.show:n.cache,t.index?(i[t.index]||(i[t.index]=[]),i[t.index].push(t)):(i.priority||(i.priority=[]),
i.priority.push(t));
}
},{
key:"get",
value:function(t,e){
var i=this.getList(e);
return i.show.priority&&i.show.priority.length?i.show.priority.shift():i.show[t]&&i.show[t].length?i.show[t].shift():i.cache[t]&&i.cache[t].length?i.cache[t].shift():i.cache.priority&&i.cache.priority.length?i.cache.priority.shift():null;
}
},{
key:"reset",
value:function(){
this.list.scroll.show={},this.list.scroll.cache={},this.enablePosition&&(this.list.top.show={},
this.list.top.cache={},this.list.bottom.show={},this.list.bottom.cache={});
}
},{
key:"clear",
value:function(){
this.list.scroll.cache={},this.enablePosition&&(this.list.top.cache={},this.list.bottom.cache={});
}
}]),t;
}(),pe={
fps:60,
speed:2,
rate:1,
top:!1,
bottom:!1,
star:!1,
gift:!1,
lineHeight:36,
enableSetArea:!1,
userNum:5,
interval:30,
cssUrl:"",
fontSize:"xs",
opacity:1,
enableColor:!0,
enablePosition:!1,
enableEgg:!1,
autoFont:!0,
loop:!1,
marginBottom:0,
enableMouseEvent:!1
},me=function(){
function t(i){
e(this,t),ie(this);
var n={};
_extends(n,pe,i),n.cssUrl&&this._loadStyle(n.cssUrl),this._initDataset(n),this._write(n.wrapper),
this._windowResize(),this.Timer=ne(n.fps),this.Timer.setCallBack(this.Animation.bind(this));
var a,s;
this._clickHandler&&(a=this._clickHandler.bind(this)),this._menuHandler&&(s=this._menuHandler.bind(this)),
this.Factory=_(this.dataset.$container,a,s,this.dataset.enableMouseEvent),this.BarragePool=se(this.Factory.scrollBarrage),
this.active=new de,this.list=new fe(this.dataset.enablePosition);
}
return n(t,[{
key:"_loadStyle",
value:function(t){
var e=this;
ue.loadCss(t).then(function(){
e.updateSize();
});
}
},{
key:"_initDataset",
value:function(t){
this.dataset={
currentBlock:0,
index:0,
interval:t.interval,
width:"",
height:"",
speed:t.speed,
rate:t.rate,
realSpeed:{
0:t.speed*t.rate*1.2,
1:t.speed*t.rate*1
},
keyMap:{},
lineHeight:t.lineHeight,
state:3,
timerState:3,
fps:t.fps,
count:0,
fontSetting:t.fontSize,
fontSize:t.autoFont?x(window.innerWidth,t.fontSize):0,
opacity:t.opacity,
userNum:t.userNum,
maxNum:0,
actualNum:0,
enableColor:t.enableColor,
enableScroll:!0,
enableTop:!0,
enableBottom:!0,
enableStar:!0,
enablePosition:t.enablePosition,
enableEgg:t.enableEgg,
autoFont:t.autoFont,
loop:t.loop,
marginBottom:t.marginBottom,
enableMouseEvent:t.enableMouseEvent
};
}
},{
key:"_write",
value:function(t){
var e=document.createElement("div");
e.innerHTML=ae,this.dataset.$container=e.firstChild,this.dataset.$scroll=this.dataset.$container.querySelector(".txp_barrage_scroll_wrap"),
t.appendChild(this.dataset.$container),this.updateSize(),this._setOpacity(this.dataset.opacity);
}
},{
key:"_setOpacity",
value:function(t){
this.dataset.$container.style.opacity=t||1;
}
},{
key:"_start",
value:function(t){
this.dataset.timerState=1,this.updateSize(),this.Timer.start(t),this._handlePosition("top","resume"),
this._handlePosition("bottom","resume");
}
},{
key:"_pause",
value:function(){
this.dataset.timerState=2,this.Timer.stop(),this._handlePosition("top","pause"),
this._handlePosition("bottom","pause");
}
},{
key:"Animation",
value:function(){
this._defaultAnimation();
}
},{
key:"_defaultAnimation",
value:function(t){
this.dataset.count>this.dataset.fps/2&&(this.dataset.count=0,this._create()),this._animate(t),
this.dataset.count+=1;
}
},{
key:"_getAvailable",
value:function(){
var t=this,e=[],i=0;
e.push({
start:0,
end:0
}),this.active.checkLast(function(n,a){
if(n.left+n.width+50>=t.dataset.width){
var s=n.height,o=a*s,r=(a-1)*s;
if(r===e[i].end)e[i].end=o;else if(r>e[i].end)e.push({
start:r,
end:o
}),i+=1;else for(var l=0,h=e.length;h-1>l;l+=1)if(e[l].start>=o&&(0===l||e[l-1].end<=r)){
e.splice(l,0,{
start:r,
end:o
}),i+=1;
break;
}
}
});
for(var n=this.dataset.actualNum,a=1,s=0,o=[];n>=a;){
var r=(a-1)*this.dataset.lineHeight,l=a*this.dataset.lineHeight;
e[s+1]?(r>=e[s].end&&l<=e[s+1].start&&o.push(a),l>e[s+1].end&&(s+=1)):r>=e[s].end&&o.push(a),
a+=1;
}
return o;
}
},{
key:"_create",
value:function(){
this.dataset.enablePosition?this._createPositionDanmu():this._createScroll();
}
},{
key:"_createScroll",
value:function(){
if(this.dataset.enableScroll){
var t=this._getAvailable();
if(t.length)for(var e=0,i=t.length;i>e;e+=1){
var n=t[e],a=this.list.get(this.dataset.index,1);
if(this.dataset.loop&&this._addDanmu(a),!a)break;
this._createScrollDanmu(a,n);
}
}
}
},{
key:"_createScrollDanmu",
value:function(t,e){
this.emit("showDanmu",t);
var i=this.BarragePool.get();
i&&((!this.dataset.enableColor||t.isStar)&&(t.color="#ffffff",t.gradienColor=[],
t.gradienColor.push("#ffffff"),t.gradienColor.push("#ffffff")),i.render(t,this.dataset.fontSize,this.dataset.lineHeight),
i.move(this.dataset.width,(e-1)*this.dataset.lineHeight),i.trail=e,this.active.push(i,e));
}
},{
key:"_animate",
value:function(){
var t=this;
this.active.handleDom(function(e){
if(!e.isHove){
var i=t.dataset.realSpeed[e.trail%2];
e.isSys&&(i*=2);
var n=e.left-i;
if(e.move(n),n+e.width+50<0)return t.BarragePool.save(e),!0;
}
return!1;
});
}
},{
key:"_toggleColor",
value:function(t){
t?this.dataset.enableColor=!0:(this.dataset.enableColor=!1,this.active.handleDom(function(t){
return t.color("#ffffff"),!1;
}));
}
},{
key:"_clear",
value:function(){
this._clearScroll(),this.dataset.enablePosition&&(this._handlePosition("top","clear"),
this._handlePosition("bottom","clear"));
}
},{
key:"_clearScroll",
value:function(){
this.active.handleDom(function(t){
return t.move(-t.width-100),!1;
});
}
},{
key:"_addDanmu",
value:function(t){
this.list.addList(t);
}
},{
key:"_windowResize",
value:function(){
var t=this,e=null;
window.onresize=function(){
1===t.dataset.state&&1===t.dataset.timerState&&t._pause(),e&&clearTimeout(e),e=setTimeout(function(){
1===t.dataset.state&&t._start(),t.updateSize();
},300);
};
}
},{
key:"updateSize",
value:function(){
this.dataset.width=this.dataset.$container.clientWidth,this.dataset.height=this.dataset.$container.clientHeight,
this.updateFont(),this.updateLineNum();
}
},{
key:"updateLineNum",
value:function(){
this.dataset.maxNum=parseInt((this.dataset.height-this.dataset.marginBottom)/this.dataset.lineHeight,10),
this.dataset.maxNum=this.dataset.maxNum>=0?this.dataset.maxNum:0,this.dataset.actualNum=this.dataset.userNum>this.dataset.maxNum?this.dataset.maxNum:this.dataset.userNum,
this.emit("lineUpdate",this.dataset.maxNum);
}
},{
key:"updateFont",
value:function(){
this.dataset.autoFont&&(this.dataset.fontSize=x(this.dataset.width,this.dataset.fontSetting),
this.dataset.lineHeight=Math.ceil(1.5*this.dataset.fontSize));
}
},{
key:"index",
set:function(t){
var e=t?parseInt(t,10):0;
if(e!==this.dataset.index&&(this.dataset.index=e,1===this.dataset.state)){
var i=Math.floor((e+1)/this.dataset.interval);
i!==this.dataset.currentBlock&&(this.dataset.currentBlock=i,this.emit("blockChange",e));
}
},
get:function(){
return this.dataset.index;
}
}]),t;
}();
return k(me),w(me),me;
});define("pages_new/common_share/video/player/plugins/danmu/input.html.js",[],function(){
return'<!--  -->\n<div v-show="danmuInfo && danmuInfo.isAllow && display"\n  :class="[\'play_bullet-input__container\', \'js_danmu_invoke_input_container\', \'close\', switchOn ? \'active\' : \'unactive\']"\n>\n  <div aria-hidden="true" class="play_bullet-input_mode js_danmu_invoke_input" @click="onInputClick">\n    <div class="play_bullet-input__wrapper">\n      <div class="play_bullet-input">{{inputPlaceholder}}</div>\n    </div>\n  </div>\n  <div class="play_bullet-screen_mode js_danmu_switch" @click="onSwitchClick">\n    <span role="button" :aria-pressed="switchOn ? \'true\' : \'false\'" :class="[\'play_bullet-screen\', switchOn ? \'active\' : \'\']">\n          </span>\n  </div>\n  <div class="play_bullet-input_background"></div>\n</div>\n';
});define("pages_new/common_share/video/report.js",["pages/utils.js","biz_wap/jsapi/core.js","common/utils.js","biz_wap/utils/localstorage.js","biz_wap/utils/device.js","biz_wap/jsapi/leaveReport.js","biz_wap/utils/wapsdk.js","biz_common/base64.js"],function(e){
"use strict";
function i(e){
switch(e.EventType){
case 1:
E=e.StartTime;
break;

case 10:
z=e.StartTime;
break;

case 12:
M=e.StartTime;
break;

case 13:
O=e.StartTime;
break;

case 14:
P=e.StartTime;
break;

case 15:
if(!E)return;
var i=e.EndTime,n=z-E,t=i-E,o=i-z,a=e.extInfo,s=0===a.playCount&&a.previousCompletedSize>0,d=s?.2:D;
if(z&&n>0){
var r=window.__second_open__?21:24;
s&&(r=window.__second_open__?29:31),l.saveSpeeds({
sample:d,
uin:S,
pid:h,
speeds:{
sid:r,
time:n
}
});
}
if(t>0){
var r=window.__second_open__?22:25;
s&&(r=window.__second_open__?27:28),l.saveSpeeds({
sample:d,
uin:S,
pid:h,
speeds:{
sid:r,
time:t
}
}),console.log("[Video Save Speed] enterToPlayTime: "+t+" sid: "+r);
}
if(z&&o>0){
var r=window.__second_open__?23:26;
s&&(r=window.__second_open__?30:32),l.saveSpeeds({
sample:d,
uin:S,
pid:h,
speeds:{
sid:r,
time:o
}
});
}
M&&z&&l.saveSpeeds({
sample:D,
uin:S,
pid:h,
speeds:{
sid:34,
time:M-z
}
}),O&&M&&l.saveSpeeds({
sample:D,
uin:S,
pid:h,
speeds:{
sid:35,
time:O-M
}
}),i&&P&&l.saveSpeeds({
sample:D,
uin:S,
pid:h,
speeds:{
sid:36,
time:i-P
}
}),l.send(),E=0,console.log("[system]",": "+s),console.log("[system]","extInfo: "+JSON.stringify(a));
}
}
function n(e){
l.saveSpeeds({
sample:e.sample||D,
uin:S,
pid:h,
speeds:{
sid:e.sid,
time:e.time
}
});
}
function t(){
var e=0,i=window.networkType;
switch(i||(i=navigator.userAgent.match(/NetType\/(.*?)(\s|$)/),i=i&&i[1]&&i[1].toLowerCase()),
i){
case"wifi":
e=1;
break;

case"2g":
e=2;
break;

case"3g":
e=3;
break;

case"2g/3g":
e=3;
break;

case"4g":
e=4;
}
return e;
}
function o(){
if(void 0===f){
var e=navigator.userAgent.match(/Mozilla.*?\((.*?)\)(\s|$)/);
f=e&&e[1]||"unknown";
}
return f;
}
function a(){
return void 0===b&&(b=["ios","android","windows","Mac"].filter(function(e){
return u.os[e];
})[0]||"unknown"),b;
}
function s(){
return void 0===k&&(k=u.os.version||"unknown"),k;
}
function d(){
return void 0===T&&(T=window.__second_open__?1:2),T;
}
function r(e){
"number"!=typeof e.StartTime&&(e.StartTime=Date.now()),"number"!=typeof e.EndTime&&(e.EndTime=Date.now()),
I.push({
type:5,
item:Object.keys(e).map(function(i){
return{
key:i,
val:e[i]+""
};
})
}),i(e);
}
function p(){
window.top===window&&(I=[],v.addReport(function(e){
if(!c.isWcSlPage())return!1;
window.__second_open__&&window.__second_open_auth_time__&&r({
EventType:6,
StartTime:window.__second_open_auth_time__,
EndTime:window.__second_open_auth_time__
}),e||r({
EventType:2
});
var i=navigator.userAgent.match(/Language\/(.*?)(\s|$)/),n={
type:5,
item:[{
key:"DeviceModel",
val:o()
},{
key:"DeviceBrand",
val:o()
},{
key:"OsName",
val:a()
},{
key:"OsVersion",
val:s()
},{
key:"LanguageVersion",
val:i&&i[1]||"unknown"
},{
key:"NetType",
val:t()+""
},{
key:"EnterId",
val:1*(window.enterid||window.cgiData.enterid||parseInt(Date.now()/1e3,10))+""
},{
key:"EnterPageId",
val:1*(window.enterid||window.cgiData.enterid||parseInt(Date.now()/1e3,10))+""
},{
key:"AppMsgUrl",
val:window.location.href
},{
key:"Vid",
val:window.cgiData.vid
},{
key:"Scene",
val:1*(window.scene||window.cgiData.scene||_.getParam("scene"))+""
},{
key:"SubScene",
val:1*(window.subscene||window.cgiData.subscene||_.getParam("subscene"))+""
}]
},d=I;
return I=[],{
reportUrl:"https://mp.weixin.qq.com/mp/videoh5report",
reportData:JSON.stringify({
report:d,
comm_fields:n
}),
method:"POST"
};
}));
}
var _=e("pages/utils.js"),w=e("biz_wap/jsapi/core.js"),c=e("common/utils.js"),m=e("biz_wap/utils/localstorage.js"),u=e("biz_wap/utils/device.js"),v=e("biz_wap/jsapi/leaveReport.js"),l=e("biz_wap/utils/wapsdk.js"),g=e("biz_common/base64.js").toBase64,y="function"==typeof window.btoa?window.btoa:g,f=void 0,b=void 0,k=void 0,T=void 0,S="";
try{
S=window.encodeURIComponent(y(window.user_uin));
}catch(j){
S="";
}
var h=2181,D=.02;
l.setBasicTime({
sample:D,
uin:S,
pid:h
});
var E=0,z=0,M=0,O=0,P=0,I=[];
return w.invoke("handleMPPageAction",{
action:"getEnterTime"
},function(e){
var i=e.clickTimeMs,n=m.get("__get_enter_video_common_time__");
i+""!==n?(m.set("__get_enter_video_common_time__",i),console.log("[Video Enter Time]",i)):i=0,
r({
EventType:1,
MiaoKai:d(),
StartTime:i||window.enter_time||Date.now(),
EndTime:i||window.enter_time||Date.now()
});
}),window.addEventListener("load",function(){
r({
EventType:7
});
}),p(),{
saveSpeedsForVideo:n,
init19735Report:p,
add19735ExtData:r,
getNetType:t,
getDeviceModel:o,
getOsName:a,
getOsVersion:s,
getMiaoKai:d
};
});define("pages_new/common_share/video/utils/immersive_data.js",["biz_wap/jsapi/log.js","biz_wap/utils/ajax.js"],function(e){
"use strict";
function i(e){
n({
url:"/mp/immersive_player?action=get_player_data&__biz="+(e.biz||"")+"&mid="+(e.mid||"")+"&idx="+(e.idx||"")+"&vid="+(e.vid||"")+"&item_show_type="+window.real_item_show_type,
dataType:"json",
timeout:3e4,
type:"GET",
success:function(i){
if(console.info("[]: ",i),t.info("[Player] success get immersive data"),
i&&i.base_resp&&0===i.base_resp.ret?"function"==typeof e.onSuccess&&e.onSuccess(i):"function"==typeof e.onError&&e.onError(),
i)try{
t.info("[Player] success get immersive data, immersive data is: "+JSON.stringify(i));
}catch(o){}else t.info("[Player] success get immersive data, immersive data is empty");
},
error:function(){
"function"==typeof e.onError&&e.onError();
},
complete:function(){
"function"==typeof e.onComplete&&e.onComplete();
}
});
}
function o(e){
var i="/mp/immersive_player?action=get_player_data_v2&item_show_type="+window.real_item_show_type;
Object.keys(e).forEach(function(o){
e[o]&&(i+="&"+o+"="+e[o]);
}),n({
url:i,
dataType:"json",
timeout:3e4,
type:"GET",
success:function(i){
if(console.info("[]: ",i),t.info("[Player] success get immersive data"),
i&&i.base_resp&&0===i.base_resp.ret?"function"==typeof e.onSuccess&&e.onSuccess(i):"function"==typeof e.onError&&e.onError(),
i)try{
t.info("[Player] success get immersive data, immersive data is: "+JSON.stringify(i));
}catch(o){}else t.info("[Player] success get immersive data, immersive data is empty");
},
error:function(){
"function"==typeof e.onError&&e.onError();
},
complete:function(){
"function"==typeof e.onComplete&&e.onComplete();
}
});
}
function s(e){
var i=Date.now(),o="/mp/immersive_player?action=op&type="+(e.type||0)+"&__biz="+(e.biz||"")+"&mid="+(e.mid||"")+"&idx="+(e.idx||"")+"&vid="+(e.vid||"")+"&appmsgid="+(e.mid||"")+"&passparam="+(window.passparam||"")+"&reuqest_id="+i+"&sessionid="+(window.sessionid||0)+"&enterid="+(window.enterid||0);
n({
url:o,
dataType:"json",
timeout:3e4,
data:{
is_temp_url:window.is_temp_url||0,
scene:window.source||window.scene||0,
subscene:window.subscene||0,
appmsg_like_type:window.appmsg_like_type||0,
item_show_type:window.real_item_show_type||0,
client_version:window.clientversion||"",
comment:e.comment?e.comment:"",
prompted:1,
style:e.styleType,
passparam:window.passparam||"",
request_id:i,
device_type:window.devicetype||"",
exptype:window.exptype||"",
expsessionid:window.expsessionid||"",
sessionid:window.sessionid||""
},
type:"POST",
success:function(i){
console.log("operate immersive player data",e,i),i&&i.base_resp&&0===i.base_resp.ret?"function"==typeof e.onSuccess&&e.onSuccess(i):"function"==typeof e.onError&&e.onError();
},
error:function(){
"function"==typeof e.onError&&e.onError();
},
complete:function(){
"function"==typeof e.onComplete&&e.onComplete();
}
});
}
var t=e("biz_wap/jsapi/log.js"),n=e("biz_wap/utils/ajax.js");
return{
getImmersivePlayerData:i,
getImmersivePlayerDataV2:o,
oprImmersivePlayerData:s
};
});define("common/safeAreaInsets.js",["biz_wap/jsapi/core.js","biz_wap/utils/device.js"],function(t){
"use strict";
function e(){
return h=a.os.android?"":"CSS"in window&&"function"==typeof CSS.supports?CSS.supports("top: env(safe-area-inset-top)")?"env":CSS.supports("top: constant(safe-area-inset-top)")?"constant":"":"";
}
function n(t){
p.length||setTimeout(function(){
var t={};
p.forEach(function(e){
t[e]=f[e];
}),p.length=0,u.forEach(function(e){
e(t);
});
},0),p.push(t);
}
function o(){
function t(t,e){
var n=t.style;
Object.keys(e).forEach(function(t){
var o=e[t];
n[t]=o;
});
}
function o(t){
t?r.push(t):r.forEach(function(t){
t();
});
}
function i(e,i){
var r=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div"),p=100,u=1e4,l={
position:"absolute",
width:p+"px",
height:"200px",
boxSizing:"border-box",
overflow:"hidden",
paddingBottom:h+"(safe-area-inset-"+i+")"
};
t(r,l),t(s,l),t(a,{
transition:"0s",
animation:"none",
width:"400px",
height:"400px"
}),t(d,{
transition:"0s",
animation:"none",
width:"250%",
height:"250%"
}),r.appendChild(a),s.appendChild(d),e.appendChild(r),e.appendChild(s),o(function(){
function t(){
this.scrollTop!==(this===r?e:o)&&(r.scrollTop=u,s.scrollTop=u,e=r.scrollTop,o=s.scrollTop,
n(i));
}
r.scrollTop=u,s.scrollTop=u;
var e=r.scrollTop,o=s.scrollTop;
r.addEventListener("scroll",t,c),s.addEventListener("scroll",t,c);
});
var v=getComputedStyle(r);
Object.defineProperty(f,i,{
configurable:!0,
get:function(){
return parseFloat(v.paddingBottom);
}
});
}
if(h="string"==typeof h?h:e(),!h)return void d.forEach(function(t){
f[t]=0;
});
var r=[],c=!1;
try{
var s=Object.defineProperty({},"passive",{
get:function(){
c={
passive:!0
};
}
});
window.addEventListener("test",null,s);
}catch(a){}
var p=document.createElement("div");
t(p,{
position:"absolute",
left:"0",
top:"0",
width:"0",
height:"0",
zIndex:"-1",
overflow:"hidden",
visibility:"hidden"
}),d.forEach(function(t){
i(p,t);
}),document.body.appendChild(p),o(),l=!0;
}
function i(t){
return l||o(),f[t];
}
function r(t){
e()&&(l||o(),"function"==typeof t&&u.push(t));
}
function c(t){
var e=u.indexOf(t);
e>=0&&u.splice(e,1);
}
var s=t("biz_wap/jsapi/core.js"),a=t("biz_wap/utils/device.js"),d=["top","left","right","bottom"],f={},p=[],u=[],l=void 0,h=void 0,v=!1;
return a.os.android&&s.invoke("handleDeviceInfo",{
action:"getSafeAreaInsets"
},function(t){
-1!==t.err_msg.indexOf(":ok")?(f.top=t.top,f.left=t.left,f.right=window.screen.width-t.right,
f.bottom=window.screen.height-t.bottom,v=!0):d.forEach(function(t){
f[t]=0;
}),l=!0;
}),{
get support(){
return 0!==("string"==typeof h?h:e()).length||v;
},
get top(){
return i("top");
},
get left(){
return i("left");
},
get right(){
return i("right");
},
get bottom(){
return i("bottom");
},
onChange:r,
offChange:c
};
});function _typeof(e){
return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e;
}
function _defineProperty(e,t,i){
return t in e?Object.defineProperty(e,t,{
value:i,
enumerable:!0,
configurable:!0,
writable:!0
}):e[t]=i,e;
}
var _extends=Object.assign||function(e){
for(var t=1;t<arguments.length;t++){
var i=arguments[t];
for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);
}
return e;
};
define("pages_new/common_share/video/player/player.js",["page/pages/video_new.css","pages_new/3rd/vue.js","pages_new/3rd/vuex.js","biz_wap/jsapi/log.js","pages_new/common_share/video/player/player.html.js","biz_wap/utils/device.js","biz_wap/utils/mmversion.js","new_video/ctl.js","pages/version4video.js","biz_wap/jsapi/core.js","new_video/plugin/util.js","biz_wap/utils/jsmonitor_report.js","common/utils.js","biz_wap/utils/ajax.js","appmsg/set_font_size.js","pages_new/modules/utils/vue_plugin.js","pages_new/modules/toast/toast.js","biz_wap/utils/openUrl.js","biz_common/utils/url/parse.js","pages/utils.js","common/safeAreaInsets.js"],function(e){
"use strict";
e("page/pages/video_new.css");
var t=e("pages_new/3rd/vue.js"),i=e("pages_new/3rd/vuex.js"),s=i.mapState,n=i.mapMutations;
t.config.ignoredElements=["wx-open-video"];
var o=e("biz_wap/jsapi/log.js"),a=e("pages_new/common_share/video/player/player.html.js"),r=e("biz_wap/utils/device.js"),h=e("biz_wap/utils/mmversion.js"),u=e("new_video/ctl.js"),l=e("pages/version4video.js"),d=e("biz_wap/jsapi/core.js"),c=e("new_video/plugin/util.js"),p=e("biz_wap/utils/jsmonitor_report.js"),g=e("common/utils.js"),m=e("biz_wap/utils/ajax.js"),_=e("appmsg/set_font_size.js"),f=_.fontSizePlugin,v=e("pages_new/modules/utils/vue_plugin.js"),y=v.VueExposePlugin;
t.use(f),t.use(y);
var S=e("pages_new/modules/toast/toast.js"),T=e("biz_wap/utils/openUrl.js"),w=e("biz_common/utils/url/parse.js"),b=e("pages/utils.js"),P=b.formatReadNum,k={
timeupdateCacheCount:3,
loadingTimeout:18e4,
outerWidth:Math.min(window.outerWidth,window.outerHeight),
screenWidth:Math.min(window.screen.width,window.screen.height),
screenLength:Math.max(window.screen.width,window.screen.height),
wcSlPlayerSupport:!1,
allPlayersOfPage:{},
statusDefine:{
init:1,
play:1,
pause:1,
loading:1,
end:1,
error:1
},
subStatusDefine:{
init:1,
play:1,
playing:1,
waiting:1,
stalled:1,
seeking:1,
seeked:1,
preload:1,
resolutionchange:1
},
nettypeMap:{
"network_type:fail":"fail",
"network_type:edge":"2g/3g",
"network_type:wwan":"2g/3g",
"network_type:wifi":"wifi"
},
cellType:["2g","3g","4g","2g/3g"],
supportSubscribe:(r.os.iphone||r.os.ipad)&&h.isWechat&&h.gtVersion("7.0.15",1)||r.os.android&&h.isWechat&&h.gtVersion("7.0.17",1),
showFullscreenMenu:(r.os.iphone||r.os.ipad)&&h.isWechat&&h.gtVersion("7.0.16",1)||r.os.android&&h.isWechat&&h.gtVersion("7.0.18",1),
supportZaikanAutho:(r.os.iphone||r.os.ipad)&&h.isWechat&&h.gtVersion("8.0.18",1)||r.os.android&&h.isWechat&&h.gtVersion("8.0.19",1),
menuPlaybackRateIcon:{
light:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAAEi6oPRAAAAAXNSR0IArs4c6QAABvRJREFUeAHtW2moVVUYvS/TrLQyyXjC64FmiFaUQkilkiEU/YgGJAMpaIKkyDKQikKCEIoICaFCkoKiSQiEArGoDCqsQGmwJCp7zVY2+rRprdv+7lt3n2mf4T0x9wfL/e1v3Gfd+849Z59jq9W0zAgp+A+CCBV/3hWgzjuRNcky1ZHQD7UojHT2OJyN8RinYzgw5My8Zf7tnDxKpSGRs8YLSA32q7SDjMyLUGEAIJkWaMTCdHCIHXja0eb5EvFtap11HEbOV7u5+kY731POlxg0WJ1jXaLaTD/E+frMwFELfeXN1feh52NulzB4W5dlaELfzqFp1P5fDJyYczjH5fgSLn5PiPUJT6tlX8DNKb6OiV9xE56ltgAs2GtGN9L3KEDfdGdLHRigsgcTs3FFKj9iYj61t/UsB+15vr+skh6a2XTkIf2uBtHp2wV0NeqauOAbXRDP+L4sgoE5s3yHFmInzje6IJ8j+t51vs5gvzVmsIIs5kuer6WFGJhWgAXzfH7DOI8MRAZGiAH+YRI8WY0q0dN+HP5AzhEl8hKhWWfZ+Yj8E7AFLklkphumwfyb5C1PDwu32gL8jDelyQ7fibkx5Ls2SN630LMI8PM686wFdQKgLAQsjuMCIGtBcHXkNGiad1nHk6NYQk5IwvUJLFXy3pa87YmqzlC28MtSlLmh8iQCrddu6LyJaEvZz3QqsqwQx6cB/pRmHiF8FF7r8XrFcj+GzjziaGAfkCqWoM7HMDH7L9APU6fT075D90keG/LOv1CyGNI/+S9QxY5mPPTBnKr6Jz9B8viR/JSTl+l6Hx4u5tjMiHQHr6TJYn+6O1ojA5GByEBkIDJw8DJwc8VDr5pX2M6ue5YWRnYHWN7KbnP9mRW2cUpgSYu3cXZgXmEYCz4EbAKs+AB0XqDlCWNfAZ4ALI/XymOAWmILYhFeqvKS1Rqsg54ltiD6eRX6NWB5L9BYVXRBVmMOFCvO8UJzyEg7GVKZhonmXavOUJ0F+JGlySoYrQEv2nnNbJK2IPMtg2J5HE8wR8jIhKwFWf57UKzBVmfk3GfI4m2k3/I+N2PRGLIg1pgI6J1JyIKYdzigdyaP0KiSdRukMWk6t2u493ppmjPHxu2aI4G5LuZqjDyY+W6eGEIZ0sQ7MAllSPOucXnM3asO1css6FQpWGZBfV5e7h5SyIL4Uf0gRZ91etGXGmEtfpnZg9gMFErRgp5HBSv4PXTb9qMtb0EPSx6fewRv+2Ut6AopyJiZgErWgs5HEH2GeZoUojNRz0OTMecTfiu4IqMI/crQUZjzi2p5D2TkFZp1Qboz9kZBpi5Id8Y+KsgrdLPwl4Ad2R7o4wqz/ovnucnyyOrxAXmFIVaQ47mF0UMBmnf5kLm+xsIPVijDvGcq5MWUyEBkIDIQGYgMRAYiA5GByEBkIDIQGTgAGNiBNfLGj3uIvGks+1IBUkrJBkTbnS9vNvtLZe+HYFusP27DWsrc7ocu3d5j8fvtRIHFoUVGMk4Xyo0Zfzeafm7S3AOEbNQgLFeUIG7o6C62rYVvHq0FGtngyV1NgNMWxVH39i7GXLfUNI7ba2cE1E4LUYJ0T/AsBG8BtI/p3Ja7IK3YSNhsERyVIO09GZPHAd0MtTw+X1sBpL0WBnNCsgjSQG6g3gsMAtbHxr2w3Q8EvU6GuNpijTlmEaRNejC5EtB9Uq2xEb6ZQJaEEOTnngfDB4D2MZ1v+c/zE5qcWyOOIQT5vafCoA8ftB4fRFwPjJKkKgRJevvtSK6T5yntRZ0PMFYCwQ8xEFso2qQKQdqAj4xuAPSxkdZ/Dj4+fzebnoNgriSLkPUZYDV1fA32WZWqSpIWrEuQlG2rp+DflwDtoXoTBGlPPiTUF4C11274bgFGa0KIrkWaJkj7j8XkduBXwHo2TZD243NuPmv+RvpZ359h6wWCxJI4DhdBl6D2p4D2oj5cBM1F7XdS+rHndmABECy66KYImojua4C0i07t1xRBfG3iLoAnaa1PnSfztcAkoJJowToELUR3fVlF626F7xy3urq/YnaQp0N5FdA+pvMdgcUWWHe0ohzLEDQe8auAQUBrUN8HrAYmAL5UJYgn12UAX+/3+3HO/0TRDzQu2qyIoDno/hagOaZzVyDthTB/wWUIOgnJevdvvTh+B1wH8GQ8rKJNfYJ4+3AboL88Fs/bjnVAL1BG8gjiwV4FpP3ysO+LwHRgRMUOmCMJOhnYBKjd9AHYlwA9QFXxCepDobxrl1vhH1O1WRN5dvBZ43o0mdJEI1dDCUrr+TriZjfYr3Ypf5G7UHEpoPdPtZtIAZ8gvkh4N9Do/ZP0q63y+mA5MKN2pbACJOImgPs/USIDkYHIQGQgMhAZiAxEBvYzA/8CNRG0E/V3Z7sAAAAASUVORK5CYII=",
dark:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAASKADAAQAAAABAAAASAAAAACQMUbvAAAGt0lEQVR4Ae2aeahVVRTG32u0yZwqCU0zK4sGm6RIQmkkw8oyzawsjITM0rJopEBJ0NJ65VBOqc8kMyOjWZGMkJCyiQYUxR6pZTmmL4f3+n10t5y33Pd5zj3nXPtjL/jYZ629z/rW/e7Z++z93q2oCBYUCAoEBYICQYGgQFAgKBAUCAoEBYICQYGgQFAgKBAUQIH6+vq2oD/oUA5B4Gle4Du3HHxxOSqLDaTYd+hrA+rAPDCxsrJyM20uBt84EnctJF9IOw6+tbmQJUjamEDLTJ4t+BPBPArfY/pSuwikL6FdJNFOrmeA6fDVRuJlvTwoAVtTxj4CZvNhuiS4r9Shh3HjQPA2fNeUmiTtfUkEclyncDGeoscATcG87XgIRsA1BZyRN5nNH1egDdyotShq3XDmUvRgcGS0I4NrTWc7rbR4z4DradAyA45YKeIKtIRs/YBdlw4lNgBoGvQARdc0xiSxlQy+CXxkblL+nkB8twPx52pxBapgoVwBBlGN1qHfTFWt8J8F0yj6LNNXkgvXevAEN2sd+skkOQr/AfAmfO7NZ4Zk48YWyNFR9CKubwbjwQ4XL7QSZzpFPwMkWmqDbzlJ7gAjwF8mYVv8cXBVgfamLxM3sUBipeidYCqXvcAHihm7Dn8+RQ8AehulMrjqgPZl4psFdpuEl+DPgWsYOMb0pXJLEsgxUvQf4Cn8u8APLl5oj6AdDDQNuhViqRq4tgFtKG8Bn5tkh+BrndQX0wuk+mwudyZJKPo7Eg4AWoc2gKhpK6AtgbYG2iKkNvjWgAdJNASsNgmb4T8OZsF3vulL7GYikFgpuB4s4FLT4HWwC0StC442mcOBNp2pDb4vSNIXjAXbTMLT8F+FaxRobfpiu5kJ5Bgpejuowu8NPnPxQnswbR+gadAbyE9lcO0G1SS5EcwH9SbhFfjz4BoEmpi+/bqZC+QYKboGDMPXOrTKxQvtsbSPgmqKvsj0leTCtRGM5Ob+4GuT5HD8gUBCXW36GnVzE8ixUvRSrm8FY8BWFy+0HWknUPRoWu1tUht8P4N7SPQYWGcSnoA/Er7JoJPp87q5CyRWCtY0mMOlpsFboA5ErTtOJvsmlxS+T7jWfm0SsMeWzsRmItKToAXXRa0sAjl2it4ERuH7ji1uWGYtXLXgNRJKqI9N4kr8G4DWQ/1hUNuEfaysAjl2inbHFq1D9tjihmXWwrcO6NWvdch3bNGWQfu1CyzpARHIFUHRC7nW224CsNPADcushW85ydyxZaNJfBL+WERqMNUPqECRAvW4l9PE5+PUsajBVGvglLNCcfFtXU4zFJS8kVOeuAbfeYx9GJzuuWcNsec0HaN9B0QgCj2VIlToPnM+WlxW1/DpC9Cx5CpPzr+JTQZvII49BDd8nDw3Zxqi0GYkHAR0HMl9esPXBB6tOXcCbRajph33AvAywtg/o+wdV5YniELFo1ftvcD354hFxM8BDRZI/JINziu5WW8nbQ6tfUNgNMLYN5odl/8TRKEXw/oQOHkf9oqKFcTGUOgyxunfPqkFIk8n8mj6dgbW1hOogu9D21HMz+0JotA2kOosdpmHfDMxvdrnU+weT3/iEHzNuek+cD2wb6h/iM0E0+GrpY1tmQtEoTpT3Q1uAza/xNBRYxKFbqFNbfCJow/Q+etoT8JPib0I31pP335D9gPs94ZiAyhU31oPcD9o6Rn3JbHnKXSlp6+kEJyXcqOe0naeBL8Q0/T9ytMXO5SJQBR6NozDwZke5hpi+j/7Yk9fSSH4JMhQ0NWTYBMxN33rPP2JQqkEotDjYNMTc62HdQexKWA24uz09CcOwacpNBD0BbZ2Td+5QNN3K20mZkliJaVQbcn7A6012mtYe4+A9hcbbEcpPnzaM/UEWoS1GFtbSkDTabXtSOsnFohiu0Oqx/tED/n3xFSo2kwMPr2u9drW69varwRegG+J7cjKjy0QhXaEVIVe6CHXk1IF3qdY7VBTG3ytSTIEFDseaPrqeLArNVkjCex+Ye9QCly21/nvXzkt8O3xQMVVg6kUuj0yPvElfNooureRtgCaxr7p+y7xV+D7kzZ3i/sEtfJUspiY3k41nr60oaaeBN8S0/HgR09fbqG4AkUL0D5G+xnta8phv0PyEnyxjwdZFpVEID32E0EuP8HzfChtDXQ8mIY4tZ7+soQaE2g1FbQH2mxpfcj1R5zkXwXcGrSQ6//Fjzipw28smi2AfqTUwT8i2yg8TUA/4DuFZ0sWsgUFggJBgaBAUCAoEBQICgQFggJBgaBAUCAoEBQICgQFiijwLxwPFVr0t277AAAAAElFTkSuQmCC"
},
menuResolutionIcon:{
light:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAAEi6oPRAAAAAXNSR0IArs4c6QAAA0FJREFUeAHtWz2S1TAMfjDMMHCCpeYKdEDJKagXTkBBxQ4NDReA+t2CkqWjp+IaMFSL5I08jp8UOf59ycozxoksS58+K7aT5R0Otcq9ydBNikFUwvqVUfYGSInROdzcD6TkOhAdvuDNg1ASXXs3NNoLIsURtymYSMfhc+GOQHrr03NHoLyAwUQ6TNdmREvxLQXhxoW5S8pZBjlDWexyhgiZ1oqplxUSeMsdpwG1/uYMhMlXMo2hnex8cAC4LeAX8PB94uJNDicUGrd9Ldlz40qeNdE4IRIVhI5iRDPH1ULjZk2IwItnSEiaY2iWfJIh1hspW2sMbJeBI0DH9O5Z0adYCIioULlj5i9lBcEBXGFXEk5xjSx1kcXNCQGEdY2fZN1UQE3Y4FCmTFk3MAgwlSEumCayEYDwPUF6UIYwJIJBylNyqHRqFgHExrmEJQNPQflvPKDy/SOw93uy6bBwgLD/PdSHk2Lr5h84+NTaidk3BowBY8AYqMUAt3XQXlbLR4odjyM+D+EeNqJ4vzEg2lBxp0fUrSv6wUJ+xQPan1u95v+eHG+0A5qUT37Oa0PWAJE/ei+j+2ZtKqC3zRBEhuOkjrr73xogjXMth5o9TRIwmzKJGZKPYAgXW2nBFbcOAty9HcHQYpBnB0h77BejSewU84UbP4qhaw4MynowtGpxlQB9BrDvpCgqytHPYnkFvbRO9GzRryscndj5fOrv0fwAJ996ODIfxoAxYAwYA8aAMWAMGAPbZoA7vHIR4YH2GVT/4ZZT2qgM/9r7E2rWARqJ6fnaMdoXxjsr0gsiKcWvQUfo+AC11xd+wtGifQxGP0J9HRjHeFdl0hUMCGf1IjC2h8snUXxXcVClH2Hw/1yHBGrXsf+zvy8l6MXZR1gIsJSg0D39HQ13RqmG+pu4rklQ6pFhE8QQyJoEkc1dtUaQMp3aOUgZ7tYaTWfT/ZZByvQZQUaQ+4F5eIBVKJl3WwbN+Ti5M4JOKJkL7gJB+Hhll9JtPttxxYH0+2KJiJclvvZA0GUJAdrYPRDU9B1w7RqEX+H2VNR4tAzCD9phod9XhbI9XcfxJsV2BK3woLXXa4zTijFgDBgDxoAxYAzcHQb+A8TbERMpxGRsAAAAAElFTkSuQmCC",
dark:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAASKADAAQAAAABAAAASAAAAACQMUbvAAACMklEQVR4Ae2bO07DQBCGbYQQV6EDiSJHcAm38B2ghDsQiXuQI6QLXVoKDoHSmH8lr7SPrGcdu9jHv5LlzOwj83+ZsZ1o0zRsJEACJEACJEACJEACJEACJEACJJAYgTYmnmEYNhh3h+MmZnxmY06I99i27f5c3CIgwHnDxO7c5MJ8O0B6dTVduQ7THjOnBjhKdjfqNRE0k4AwUpVVTc3Tey2od685Xxi/xfEnzMuh+xZB9jjMCnH1NhIgV+gWdfrrOnO1UVIfDiBPilRi7oQSMsfUJOqZC8hcvIrXc0vMgoIU/YTj3nJOGCjPx4nuJLuWZlA0nCTVRwS1FFDEW+Q9ZFGJOdJ/YB9Gn/iE7sxN1lwT0AHXmPdklV4YGEtMALcmoGLKymS2JiBz3WJeE5DwURIQAQkEhG5mkABo0XNQjt+tBB5eNzPIQ2I7CMjm4VkE5CGxHQRk8/AsAvKQ2I5FdzF7qTQt/Or5gsiedXRz77zMIE0ucCagABjtJiBNInAmoAAY7SYgTSJwrgHQENAe5a4BUBSI0KDsn4PwnKM3PYUy5SEkPsafPSCIfIoReukYlphArjZA3wIPrzv7Epv73cojIDhqyyABh989F5Da11dSE/XMLbF+3Ncnbl3LgKKC00txSoDULnSzdTDUUWpz9Yr7pI+lkgjo8vROXoNwh9hjoV1gsdLc6q8ISq/Voras4Lqzwawq/8xi0aJBAiRAAiRAAiRAAiRAAiRAAiRAAikQ+AfRfUIyNXGRbAAAAABJRU5ErkJggg=="
}
};
try{
k._debug=window.location.href.indexOf("&_debug=1")>0;
}catch(A){
k._debug=!1;
}
var I=h.getInner();
window.parent===window&&h.isWechat&&!h.isInMiniProgram&&(r.os.iphone&&h.gtVersion("7.0.15",1)&&r.os.getNumVersion()>=10.3||r.os.android&&(I>"27001037"&&"27001060">I||I>="27001100")&&r.os.getNumVersion()>=5)&&(k.wcSlPlayerSupport=!0),
console.log("support wcslplayer",k.wcSlPlayerSupport);
var B=function(e){
return k._debug&&console.log(e);
},F=function(e,t){
var i=document.createElement("div");
return e in i.style?(i.style[e]=t,i.style[e]===t):!1;
},C=function(e){
var t=0,i=0,s=0;
return.5>e&&(e=0),e=Math.floor(e),t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),
s=e-3600*t-60*i,0!=t?(10>t&&(t="0"+t),t+=":"):t="",10>i&&(i="0"+i),10>s&&(s="0"+s),
t+i+":"+s;
},E=function(){
return _extends({},k.allPlayersOfPage);
},R=function(){
if("hidden"in document)return"hidden";
for(var e=["webkit","moz","ms","o"],t=0;t<e.length;t++)return e[t]+"Hidden"in document,
e[t]+"Hidden";
return null;
},V=function(){
var e=R();
return e?document[e]:!1;
},M=function(e,t){
var i=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;
return i&&i.call(e,t);
},O=function(e,t,i){
for(var s=!1;e&&!(s=M(e,i));)e=e!==t&&null!=e&&e.nodeType!==e.DOCUMENT_NODE&&e.parentNode;
return s;
},L={
name:"mp-video-player",
template:a,
props:{
opt:{
type:Object,
"default":function(){
return{};
}
},
wrapStyle:{
type:Object,
"default":function(){
return null;
}
},
videoStyle:{
type:Object,
"default":function(){
return null;
}
},
posterStyle:{
type:Object,
"default":function(){
return null;
}
}
},
components:_defineProperty({},S.name,S),
data:function(){
var e=g.supportImmersiveMode;
console.log("support immersive mode",e);
var t=g.__useWcSlPlayer=this.supportWcSlPlayer()&&this.opt.useWcSlPlayer;
console.log("use wcslplayer",t);
var i=(this.opt.useFeFullscreen||!this.supportWcSlPlayer()&&this.opt.useWcSlPlayer)&&e;
return console.log("use fefullscreen",i),{
id:Date.now()+"_"+Math.floor(Math.random()*Math.floor(Date.now())),
supportImmersiveMode:e,
isImmersiveMode:this.opt.useImmersiveMode,
isFeFullscreen:i,
isWcSlPlayer:t,
autoplay:!!this.opt.autoplay,
initialTime:this.opt.initialTime,
resolutionInfoIdx:0,
playbackRateInfoIdx:0,
showDefaultPlaybackRate:!1,
mustHideFullScreen:!!r.browser.M1,
isAndroid:r.os.android,
isIPad:r.os.ipad,
removeVideo:!1,
fitVideo:!1,
currentTime:0,
videoDuration:0,
bufferedPercent:0,
touchToastSeperator:"/",
touchToastPercent:0,
touchToastCurVal:0,
touchToastTotalVal:0,
androidLandscapeFullOrientation:0,
enableWcSlPlayerFullscreenAfterOrientationChange:!this.opt.preCreate,
wcSlPlayerTransitionDuration:this.opt.useImmersiveMode?250:0,
withoutCover:!1,
longTouchPlaybackRatePrevValue:0,
likedCommentTipsStatus:0,
subscribeStatus:0,
snapshot:"",
topTips:"",
showPauseBtn:!0,
useQuic:!1,
compare1:null,
compare2:null
};
},
computed:_extends({},s("mp-video-player",["fullscreenStatus","seekingStatus","status","subStatus","loadingStatus","controlBarStatus","coverStatus","banOprStatus","midPlayStatus","resolutionEntryStatus","subSettingStatus","accessPlayBtnStatus","touchOprStatus","orientationStatus","progressBarMark"]),{
updateStyleOnly:function(){
return!this.isImmersiveMode&&"update-style-only"===this.enableWcSlPlayerFullscreenAfterOrientationChange;
},
src:function D(){
var D=this.opt.src;
return this.opt.extinfo&&this.opt.extinfo.vid&&(D+="&vid="+this.opt.extinfo.vid+"&format_id="+this.opt.formatId),
D&&(D+="&support_redirect=0&mmversion="+h.get()),this.useQuic?D.replace("mpvideo.qpic.cn","wxsnsdy.wxs.qq.com/130/20210/snssvpdownload/SH/reserved"):D;
},
coverFit:function(){
return this.opt.coverFit;
},
cover:function(){
return this.withoutCover?"":this.opt.cover;
},
width:function(){
return this.fullscreenStatus?Math.min(k.screenWidth,k.screenLength*this.videoRatio):Math.min(this.opt.width||300,k.screenWidth);
},
height:function(){
return this.fullscreenStatus?Math.min(k.screenLength,k.screenWidth/this.videoRatio):Math.min(this.opt.height||300,k.screenLength);
},
ratio:function(){
return this.width/this.height;
},
muted:function(){
return this.opt.muted||null;
},
videoWidth:function(){
return this.opt.videoWidth||300;
},
videoHeight:function(){
return this.opt.videoHeight||300;
},
videoRatio:function(){
return this.videoWidth/this.videoHeight;
},
isLandscape:function(){
return 1===this.orientationStatus;
},
needFeFullscreen:function(){
return window.__video_need_fe_fullscreen__=this.isWcSlPlayer||this.isFeFullscreen||this.isImmersiveMode,
window.__video_need_fe_fullscreen__;
},
display:function(){
return this.opt.autoHide?"none":"block";
},
title:function(){
return this.opt.videoTitle||"";
},
headImgUrl:function(){
return this.opt.headImgUrl||"";
},
nickname:function(){
return this.opt.bizNickName||"";
},
readNum:function(){
return P(this.opt.readNum);
},
praiseNum:function(){
return P(this.opt.praiseNum);
},
likeNum:function(){
return P(this.opt.likeNum);
},
isPraised:function(){
return!!this.opt.isPraised;
},
isLiked:function(){
return!!this.opt.isLiked;
},
oriStatus:function(){
return this.opt.oriStatus;
},
canShareVideo:function(){
return this.supportImmersiveMode&&(this.needFeFullscreen||r.os.ipad)||this.supportNativeFullPlayer;
},
supportNativeFullPlayer:function(){
return h.isWechat&&!h.isInMiniProgram&&this.opt.videoMd5&&(h.isIOS&&h.gtVersion("7.0.9",1)||h.isAndroid&&h.gtVersion("7.0.10",1));
},
showFullscreenMenu:function(){
return k.showFullscreenMenu&&!!this.opt.showFullscreenMenu;
},
isInPaySubscribe:function(){
return!!this.$store.state.cgiData.isPaySubscribe;
},
playbackRateInfo:function(){
return this.opt.playbackRateInfo;
},
maxPlaybackRateInfo:function(){
var e=void 0;
return this.playbackRateInfo&&this.playbackRateInfo.length&&this.playbackRateInfo.forEach(function(t){
(!e||t.rate>e.rate)&&(e=t);
}),e;
},
resolutionInfo:function(){
return this.opt.resolutionInfo&&this.opt.resolutionInfo.length?[].concat(this.opt.resolutionInfo):[];
},
flowNum:function(){
return this.opt.flow>=100?this.opt.flow:0;
},
duration:function(){
return"number"==typeof this.opt.duration?this.opt.duration:this.videoDuration;
},
progressPercent:function(){
var e=this.currentTime/this.duration;
return e=Math.ceil(100*e),e=Math.max(e,0),e=Math.min(e,100);
},
playbackRateName:function(){
var e=this.playbackRateInfo[this.playbackRateInfoIdx];
return!this.showDefaultPlaybackRate&&1===e.rate||this.longTouchPlaybackRatePrevValue?"":e&&e.name||"";
},
resolutionName:function(){
var e=this.resolutionInfo[this.resolutionInfoIdx];
return e&&e.name||"";
},
formatCurrentTime:function(){
return C(this.currentTime);
},
formatDuration:function(){
return C(this.duration);
},
wrapPresentStyle:function(){
if(this.fullscreenStatus&&this.needFeFullscreen){
var e={
width:(this.isLandscape?k.screenLength:k.screenWidth)+2+"px",
height:"100%",
position:"absolute",
padding:"0 1px",
left:"-1px",
top:0,
zIndex:4e3
};
return r.os.android&&this.isLandscape&&90===this.androidLandscapeFullOrientation&&(e.right="-1px",
delete e.left),e;
}
return _extends({
display:this.display,
width:"100%",
height:this.height+"px"
},this.wrapStyle);
},
videoPresentStyle:function(){
return this.fullscreenStatus&&this.isLandscape?{
width:k.screenLength+"px",
height:k.screenWidth+"px"
}:_extends({
display:"block",
width:this.width+"px",
height:this.height+"px"
},this.fullscreenStatus?{}:this.videoStyle);
},
posterPresentStyle:function(){
var e={
backgroundImage:"url("+(this.snapshot||this.cover)+")",
backgroundSize:this.snapshot?"contain":this.coverFit
};
return this.fullscreenStatus||this.isImmersiveMode?e:_extends({},e,this.posterStyle);
},
changeFullSwitchStyle:function(){
return{
bottom:(k.screenLength-Math.min(k.screenLength,k.screenWidth/this.videoRatio))/2+16+"px"
};
},
maxPlayerFontScale:function(){
var e=1.4;
return this.fullscreenStatus?e:1;
},
maxPlayerFullscreenHeadScale:function(){
return window.is_care_mode?1.18:1;
}
}),
watch:{
opt:function(e,t){
e!==t&&this.initPlayer();
}
},
mounted:function(){
this.initPlayer(),this.mountedTime=(new Date).getTime(),this.firstLoadingTime=0,
k.allPlayersOfPage[this.id]=this,d.on("onNetWorkChange",this.onNetworkChange),d.on("menu:haokan",this.onLikedCommentWrite),
d.on("menu:share:appmessage",this.showSubscribeBtn),d.on("menu:share:timeline",this.showSubscribeBtn),
document.body.addEventListener("mousemove",this.onProgressMouseMove),document.body.addEventListener("mouseup",this.onProgressMouseUp),
document.addEventListener("visibilitychange",this.onVisibilityChange),r.os.iphone||r.os.android?(window.addEventListener("orientationchange",this.onOrientationChange),
r.os.android?d.on("onOrientationsChange",this.onAndroidOrientationChange):(this.isFeFullscreen||this.isWcSlPlayer&&!this.isImmersiveMode)&&window.addEventListener("resize",this.onWindowResize)):r.os.ipad&&this.isFeFullscreen&&(this.onIPadOrientationChange(),
window.addEventListener("orientationchange",this.onIPadOrientationChange)),!this.supportImmersiveMode&&this.isWcSlPlayer&&r.os.iphone&&d.on("onPageStateChange",this.onIOSPageStateChange),
this.isImmersiveMode&&(this.enterFullscreen(),d.invoke("setNavigationBarButtons",{
right:{
color:"#FFFFFFCC",
disableMinimizeBlock:!0
}
})),this.opt.initFullscreenStatus&&this.enterFullscreen(),this.canShareVideo&&this.supportNativeFullPlayer&&!this.needFeFullscreen&&(this.__jsapiFullscreenErrCnt=0,
setTimeout(this.getCoverBase64,1e3),d.on("onMPPageAction",this.onJsapiExitFullscreen));
},
beforeDestroy:function(){
delete k.allPlayersOfPage[this.id],d.remove("onNetWorkChange",this.onNetworkChange),
d.remove("menu:haokan",this.onLikedCommentWrite),d.remove("menu:share:appmessage",this.showSubscribeBtn),
d.remove("menu:share:timeline",this.showSubscribeBtn),document.body.removeEventListener("mousemove",this.onProgressMouseMove),
document.body.removeEventListener("mouseup",this.onProgressMouseUp),document.removeEventListener("visibilitychange",this.onVisibilityChange),
r.os.iphone||r.os.android?(window.removeEventListener("orientationchange",this.onOrientationChange),
r.os.android?d.remove("onOrientationsChange",this.onAndroidOrientationChange):(this.isFeFullscreen||this.isWcSlPlayer&&!this.isImmersiveMode)&&window.removeEventListener("resize",this.onWindowResize)):r.os.ipad&&this.isFeFullscreen&&window.removeEventListener("orientationchange",this.onIPadOrientationChange),
!this.supportImmersiveMode&&this.isWcSlPlayer&&r.os.iphone&&d.remove("onPageStateChange",this.onIOSPageStateChange),
this.canShareVideo&&this.supportNativeFullPlayer&&!this.needFeFullscreen&&d.remove("onMPPageAction",this.onJsapiExitFullscreen);
},
methods:_extends({},n("mp-video-player",["setFullscreenStatus","setSeekingStatus","setStatus","setLoadingStatus","setControlBarStatus","setCoverStatus","setMidPlayStatus","setResolutionEntryStatus","setSubSettingStatus","setAccessPlayBtnStatus","setTouchOprStatus","setBanOprStatus","setOrientationStatus"]),{
initPlayer:function(){
var e=this;
if(this.isWcSlPlayer&&(this.useQuic&&p.setSum(237895,0,1),this.compare1&&p.setSum(237895,1,1),
this.compare2&&p.setSum(237895,2,1),p.setSum(221515,1,1),p.setSum(221515,r.os.android?6:5,1)),
!this.opt.src)return this.changeStatus({
status:"error",
subStatus:"5"
}),void this.emitEvent("error",{
errorcode:5
});
this.initData(),this.opt.preCreate||this.preventOperating(2),this.__inited?(this.currentTime=0,
this.showCover(),this.hideMidPlayBtn()):(this.setFullscreenStatus({
status:0
}),this.setSeekingStatus({
status:0
})),d.invoke("getNetworkType",{},function(t){
var i=k.nettypeMap[t.err_msg]||"fail";
("network_type:edge"==t.err_msg||"network_type:wwan"==t.err_msg)&&(t.detailtype&&k.cellType.indexOf(t.detailtype)>-1||t.subtype&&k.cellType.indexOf(t.subtype)>-1)&&(i=t.detailtype||t.subtype),
e.__lastNetworkType={
networkType:i,
simType:t.simtype
};
});
var t={
needToFit:!1,
supportObjectFit:!1,
os:r.os
};
if(this.width&&this.height&&this.videoWidth&&this.videoHeight){
var i=Math.abs(this.width/this.height-this.videoWidth/this.videoHeight);
.1>=i&&(t.needToFit=!0,F("objectFit","fill")&&(t.supportObjectFit=!0,this.fitVideo=!0));
}
this.triggerEvent("afterCheckVideoFit",t),this.triggerEvent("loading",this.opt),
this.__inited=!0;
},
initData:function(){
this.log={
hasended:0,
lastsec:0,
duration:0,
video_error:0
},this.__hasBegunPlaying=!1,this.__canplay=!1,this.__seekedTimes=[],this.__playingBufferingStartTime=null,
this.__hasEmittedDurationchange=!1,this.__userPlayTime=!1,this.__replaySec=null,
this.__playQueue=[],this.__lastPlayTime=null,this.__totalPlayTime=0,this.__serialTimeupdateCache=[],
this.__enableTimeupdateLog=!0,this.__isUserPause=!1,this.__pauseNetType=null,this.__hasReportedBeginPlay=!1,
this.__fallbackFromWcSlVideoToH5Player=!1;
var e=1,t=this.$store.state.cgiData.user_uin||0;
if(this.__pageVideo_canSample=0!==t&&Math.floor(t/100)%1e3<e,this.__pageVideo_count=0,
this.__pageVideo_time=0,this.__pageVideo_velocity=0,this.__pageVideo_lastDistance=0,
this.__pageVideo_videoTmpTime=0,this.__pageVideo_startDragVideoTime=0,this.__pageVideo_hasReported=!1,
this.__pageVideo_canTouchForward=!0,this.__pageVideo_isTouchMoveUpNDown=!1,this.__pageVideo_firstTouch=!1,
this.__pageVideo_touchForwardId=null,this.playbackRateInfo&&this.playbackRateInfo.length)for(var i=0;i<this.playbackRateInfo.length;i++){
var s=this.playbackRateInfo[i];
if(1===s.rate){
this.playbackRateInfoIdx=i;
break;
}
}
if(this.resolutionInfo&&this.resolutionInfo.length)for(var i=0;i<this.resolutionInfo.length;i++){
var s=this.resolutionInfo[i];
if(s.src===this.opt.src){
this.resolutionInfoIdx=i;
break;
}
}
},
addSerialTimeupdate:function(){
if(this.$refs.video){
var e=this.$refs.video.currentTime,t=this.__serialTimeupdateCache.length;
e>0&&(0===t||this.__serialTimeupdateCache[t-1].currentTime!=e)&&(this.__serialTimeupdateCache.length>=k.timeupdateCacheCount&&this.__serialTimeupdateCache.shift(),
this.__serialTimeupdateCache.push({
currentTime:e,
timeStamp:Date.now()
}));
}
},
checkPlayBySerialTimeupdate:function(){
if(this.__serialTimeupdateCache.length<k.timeupdateCacheCount)return!1;
var e=this.__serialTimeupdateCache.length,t=this.__serialTimeupdateCache[e-1],i=this.__serialTimeupdateCache[e-k.timeupdateCacheCount];
return t.timeStamp-i.timeStamp<2500?!0:!1;
},
startCountTime:function(){
var e=this.$refs.video;
e&&null===this.__lastPlayTime&&(this.__lastPlayTime=e.currentTime);
},
endCountTime:function(){
var e=this.$refs.video;
e&&e.currentTime>this.__lastPlayTime&&null!==this.__lastPlayTime&&(this.__totalPlayTime+=e.currentTime-this.__lastPlayTime,
this.__lastPlayTime=null);
},
pauseOtherPlayersOfPage:function(){
var e=this;
Object.keys(k.allPlayersOfPage).forEach(function(t){
e.id!==t&&(k.allPlayersOfPage[t].pause(),k.allPlayersOfPage[t].opt.inFeed||(k.allPlayersOfPage[t].showMidPlayBtn(),
k.allPlayersOfPage[t].hideControlBar()));
});
},
onVideoDurationchange:function(){
var e=this.$refs.video;
if(e&&!this.__hasEmittedDurationchange){
this.__hasEmittedDurationchange=!0,e.duration&&1!==e.duration&&(this.videoDuration=e.duration);
var t=Date.now()-this.log.loadwait_start;
this.log.loadwait=t,this.log.duration=this.duration,this.triggerEvent("durationchange",{
loadwait:t
});
}
},
onLoadedmetadata:function(){
if(this.opt.withoutCover&&(this.withoutCover=!0),this.onVideoDurationchange(),this.__playQueue&&this.__playQueue.length>0){
var e=this.__playQueue[0].sec;
this.__playQueue=[],this.play(e);
}
this.triggerEvent("loadedmetadata");
},
onTimeupdate:function(){
var e=this.$refs.video;
if(e){
if(this.__hasBegunPlaying&&!this.__canplay)return this.showLoading(),!1;
null!==this.__replaySec&&(B(this.id+":timeupdate __replaySec"),e.pause(),e.currentTime=this.__replaySec,
this.__lastPlayTime=this.__replaySec,e.play(),this.__replaySec=null),this.onVideoDurationchange();
var t=e.currentTime;
t>0&&(this.startCountTime(),this.addSerialTimeupdate(),"loading"===this.status&&"seeking"===this.subStatus||!this.checkPlayBySerialTimeupdate()||0!==this.loadingStatus&&this.hideLoading(),
this.seekingStatus||1===this.touchOprStatus||(this.currentTime=t),(t>60||this.duration-t<.5)&&this.showSubscribeBtn(),
this.coverStatus&&this.hideCover(),this.triggerEvent("timeupdate",{
currentTime:t
}),this.afterFirstLoaded());
}
},
onProgress:function(){
var e=this.$refs.video;
if(e){
var t=this.duration,i=this.currentTime/t,s=i;
this.isWcSlPlayer&&e.buffered?s=e.buffered.percent:e.buffered&&e.buffered.length>0&&e.buffered.end&&t&&(s=e.buffered.end(0)/t,
s=Math.max(i,Math.ceil(parseInt(100*s)))),s>98&&(s=100),this.bufferedPercent=s;
}
},
onCanplay:function(){
var e=this.$refs.video;
null!==this.__replaySec&&(e.currentTime=1*(1*this.__replaySec).toFixed(4),this.__lastPlayTime=this.__replaySec,
this.__replaySec=null),this.__canplay=!0,this.triggerEvent("canplay");
},
onEnded:function(){
B("player inner is end:"+this.isEnd()),this.isEnd()&&this.onVideoEnded();
},
onVideoEnded:function(){
this.changeStatus({
status:"end",
subStatus:""
}),this.endCountTime(),this.triggerEvent("end"),h.isIOS||h.isAndroid||!this.fullscreenStatus||this.handleFullscreenChange({
state:!1,
type:"h5"
}),this.opt.loop?(this.__canplay=!0,this.__firstPlayStart=Date.now(),this.__userPlayTime=!0,
this.__hasBegunPlaying=!0,this.$refs.video.play(),this.videoCtlReport({
step:9
}),this.changeStatus({
status:"loading",
subStatus:"seeked"
})):(this.currentTime=0,this.showMidPlayBtn());
},
onSeeked:function(){
var e=this.$refs.video;
(0===this.seekingStatus||201===this.seekingStatus)&&(this.changeStatus({
status:"loading",
subStatus:"seeked"
}),1===this.__statusBeforeSeek?e.play():3===this.__statusBeforeSeek?(this.hideLoading(),
this.changeStatus({
status:"play",
subStatus:"playing"
})):(2===this.__statusBeforeSeek||4===this.__statusBeforeSeek)&&(this.hideLoading(),
this.changeStatus({
status:"pause",
subStatus:""
})),delete this.__statusBeforeSeek),B("video seeked event");
},
onSeeking:function(){
B("seeking,__hasBegunPlaying:"+this.__hasBegunPlaying),this.__hasBegunPlaying&&(this.changeStatus({
status:"loading",
subStatus:"seeking"
}),this.showLoading());
},
onWaiting:function(){
var e=this,t=this.$refs.video;
if(B("waiting,__hasBegunPlaying:"+this.__hasBegunPlaying),this.__hasBegunPlaying){
this.changeStatus({
status:"loading",
subStatus:"waiting"
}),this.showLoading(),this.jsapiLog("waiting counting begin"),this.__loadingTimeoutId&&clearTimeout(this.__loadingTimeoutId);
var i=t.currentTime;
this.__loadingTimeoutId=setTimeout(function(){
if(t.currentTime===i){
if(e.isWcSlPlayer)return void p.setSum(221515,r.os.android?15:14,1);
e.changeStatus({
status:"error",
subStatus:"6"
}),e.emitEvent("error",{
errorcode:6
});
}
},k.loadingTimeout),this.__waitingTimeoutId&&(clearTimeout(this.__waitingTimeoutId),
this.__waitingTimeoutId=null);
var s=0;
try{
for(var n in k.allPlayersOfPage)if(k.allPlayersOfPage.hasOwnProperty(n)&&s++,s>1)break;
}catch(o){}
!this.isWcSlPlayer&&s>1&&(this.__waitingTimeoutId=setTimeout(function(){
if(0===t.readyState&&(!t.error||0===t.error.code)){
e.__waitingTimeoutId&&(clearTimeout(e.__waitingTimeoutId),e.__waitingTimeoutId=null);
var i=t.src;
e.showLoading(),e.showCover(),t.pause(),t.src=i,t.load(),t.play(),B(e.id+":waiting timer");
}
},1e4)),this.triggerEvent("waiting");
}
},
onPlay:function(e){
B(this.id+":play playing"),this.changeStatus({
status:"play",
subStatus:e.type
}),this.pauseOtherPlayersOfPage(),this.hidePlayControl(),this.startCountTime(),this.triggerEvent("play"),
this.isWcSlPlayer&&this.__canplay&&this.hideLoading();
},
onPause:function(){
B(this.id+":video pause event"),this.changeStatus({
status:"pause",
subStatus:""
}),this.endCountTime(),this.triggerEvent("pause");
},
onError:function(e){
var t=this;
if(this.isWcSlPlayer){
this.useQuic&&(p.setSum(237895,3,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&e.detail&&window.WX_BJ_REPORT.BadJs.report("WcSlPlayer:UseQuicError",(window.__second_open__?"secopen:":"h5:")+JSON.stringify(e.detail),{
mid:"mmbizwap:quic_Monitor",
view:"wap_business"
})),this.compare1&&p.setSum(237895,4,1),this.compare2&&p.setSum(237895,5,1),this.changeStatus({
status:"error",
subStatus:"3",
errorMsg:e.detail
}),p.setSum(221515,3,1),p.setSum(221515,r.os.android?10:9,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&e.detail&&window.WX_BJ_REPORT.BadJs.report("WcSlPlayer:Error",(window.__second_open__?"secopen:":"h5:")+JSON.stringify(e.detail));
var i=function(){
return t.triggerEvent("error",{
errorcode:3,
error:e.detail
});
};
return void(this.fullscreenStatus&&!this.isImmersiveMode||this.isImmersiveMode&&this.isLandscape?(this.enableWcSlPlayerFullscreenAfterOrientationChange=!0,
this.exitFullscreen(),setTimeout(i,250)):i());
}
if(this.$refs.video.error){
var s=this.$refs.video.error.code,n=this.$refs.video.error.message;
this.changeStatus({
status:"error",
subStatus:s||"",
errorMsg:n||""
});
var o="/mp/ad_video_report?action=report_video_play_error",a=encodeURIComponent(this.$refs.video.baseURI);
n+="|"+this.src,n=encodeURIComponent(n),m({
type:"GET",
dataType:"json",
timeout:3e4,
url:o+"&errorCode="+s+"&videoUrl="+a+"&errorMsg="+n,
success:function(){},
error:function(){}
});
var h=function(){
return t.triggerEvent("error",{
errorcode:s
});
};
this.isFeFullscreen&&this.fullscreenStatus?(this.exitFullscreen(),this.isLandscape?setTimeout(function(){
t.exitFullscreen(),setTimeout(h,250);
},250):setTimeout(h,250)):h();
}
},
onFullscreenchange:function(e){
var t=void 0,i="h5";
return this.isWcSlPlayer?(t=e.detail.fullscreen,i="samelayer"):t="webkitbeginfullscreen"===e.type?!0:"webkitendfullscreen"===e.type?!1:document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen,
this.setOrientationStatus({
status:t?1:0
}),(this.isImmersiveMode||this.__originFullscreenStatus)&&(t=!0,i=this.isImmersiveMode?"immersive":"frontend"),
this.handleFullscreenChange({
state:t,
type:i
}),!this.isWcSlPlayer||1!==this.fullscreenStatus||e.detail.options&&e.detail.options.triggerEvent?void 0:void this.setVideoFullPortraitAlign();
},
handleFullscreenChange:function(e){
var t=e.state,i=e.type;
t?(this.setFullscreenStatus({
status:1
}),this.showDefaultPlaybackRate=!1,this.showResolutionEntry(),this.setVideoFullPortraitAlign(),
this.triggerShowSubscribeEvent(),d.invoke("handleDeviceInfo",{
action:"setKeepScreenOn",
enable:!0
},function(){})):(this.setFullscreenStatus({
status:0
}),this.$refs.video&&1!==this.$refs.video.playbackRate&&(this.showDefaultPlaybackRate=!0),
this.hideResolutionEntry(),this.hideSubSetting(),this.resetVideoFullPortraitAlign(),
d.invoke("handleDeviceInfo",{
action:"setKeepScreenOn",
enable:!1
},function(){}),h.isIOS&&setTimeout(function(){
d.invoke("setNavigationBarColor",{
wxcolor:{
light:"#FFFFFF",
dark:"#191919"
},
alpha:1
}),d.invoke("handleDeviceInfo",{
action:"enableFullScreenLayout",
enable:!1
});
},50)),this.triggerEvent("fullscreenchange",{
state:t,
type:i,
isLandscape:this.isLandscape
});
},
setVideoFullPortraitAlign:function(){
var e=this;
this.resetVideoFullPortraitAlign(),this.fullscreenStatus&&!this.isLandscape&&!function(){
for(var t=e.$refs.video,i=e.$refs.poster,s=h.isIOS&&k.screenLength>=812?34:0,n=Math.min(k.screenLength,k.screenWidth/e.videoRatio),o=[0,56+s,84+s,150+s,190+s],a=1;a<o.length;a++)if(.55*k.screenLength-n/2<o[a]){
var u=function(){
for(var s=0,h=a-1;h>=0&&(s=(k.screenLength-n)/2-o[h],!(n/2-s<k.screenLength/2));h--);
return s+="px",i&&(i.style.marginTop=s),t&&!function(){
t.parentElement.style.opacity=0;
var i=function n(){
t.style.marginTop=s,t.parentElement.style.opacity=null,t.removeEventListener("loadedmetadata",n);
};
e.isImmersiveMode&&!e.__hasEmittedDurationchange&&r.os.iphone?t.addEventListener("loadedmetadata",i):i();
}(),"break";
}();
if("break"===u)break;
}
r.os.android&&t&&!t.style.marginTop&&(t.style.marginTop=-.05*k.screenLength+"px",
t.style.marginBottom=.05*k.screenLength+"px");
}();
},
resetVideoFullPortraitAlign:function(){
var e=this.$refs.video,t=this.$refs.poster;
e&&(e.style.marginTop=""),e&&(e.style.marginBottom=""),t&&(t.style.marginTop="");
},
getSafeAreaInsets:function(){
if(r.os.android){
var t=e("common/safeAreaInsets.js");
return{
top:t.top,
left:t.left,
right:t.right,
bottom:t.bottom
};
}
return{
top:0,
left:0,
right:0,
bottom:0
};
},
onBinderror:function(e){
this.fallbackFromWcSlVideoToH5Player(),p.setSum(221515,4,1),p.setSum(221515,r.os.android?12:11,1),
window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&e.detail&&window.WX_BJ_REPORT.BadJs.report("WcSlPlayer:BindError",(window.__second_open__?"secopen:":"h5:")+JSON.stringify(e.detail)),
this.triggerEvent("bindError",{
error:e.detail
});
},
onResolutionchange:function(){
this.changeStatus({
status:"loading",
subStatus:"resolutionchange"
});
var e=this.isWcSlPlayer?this.$refs.video.resolutionSrc:this.$refs.video.src,t=this.resolutionInfo.filter(function(t){
return t.src===e;
})[0];
this.triggerEvent("resolutionChange",{
action:"changed",
infoBefore:this.__resolutionInfoBeforeChange,
infoAfter:t
});
},
onRatechange:function(){
this.triggerEvent("rateChange",{
action:"changed",
rateBefore:this.__playbackRateBeforeChange,
rateAfter:this.$refs.video.playbackRate
});
},
onProcessstatechange:function(e){
this.triggerEvent("processStateChange",{
event:e.detail.event,
playerType:e.detail.playerType,
timeStamp:e.detail.__timestamp,
data:e.detail
});
},
onJumpProfile:function(){
var e=this;
if(1!==this.$store.state.cgiData.isprofileblock){
var t=function(){
d.invoke("profile",{
username:e.opt.bizUserName,
tabType:e.opt.profileTabType||2,
scene:"204"
},function(){
e.triggerEvent("profileJump",{
scene:"fullscreen"
});
});
};
h.isIOS&&this.isLandscape?(this.changeFullscreenLandscapeMode(0),setTimeout(t,250)):t();
}
},
onShowFullscreenMenu:function(){
if(this.fullscreenStatus&&this.needFeFullscreen){
var e=[],t=window.matchMedia("(prefers-color-scheme: dark)");
0===this.banOprStatus&&this.playbackRateInfo&&this.playbackRateInfo.length&&e.push({
id:"playbackRate",
title:this.playbackRateName,
iconData:k.menuPlaybackRateIcon[t.matches?"dark":"light"]
}),0===this.banOprStatus&&this.resolutionInfo&&this.resolutionInfo.length&&e.push({
id:"resolution",
title:this.resolutionName,
iconData:k.menuResolutionIcon[t.matches?"dark":"light"]
}),d.invoke("handleMPPageAction",{
action:"showMenu",
forbidFlag:3,
menuItems:e
}),this.triggerEvent("showMenu",{
fullScreen:1
});
}
},
onFullscreenMenuClick:function(e){
switch(e.id){
case"playbackRate":
this.onPlaybackRateEntryClick();
break;

case"resolution":
this.onResolutionEntryClick();
}
},
checkIfOutsideTouchSafeInset:function(e,t){
return this.fullscreenStatus&&this.isLandscape?80>t||t>window.innerHeight-80:30>e||e>window.innerWidth-30;
},
showSeekingStatus:function(){
var e=this;
this.seekingStatus||(this.__setSeekingStatusTimeoutId&&clearTimeout(this.__setSeekingStatusTimeoutId),
this.setSeekingStatus({
status:101
}),this.__setSeekingStatusTimeoutId=setTimeout(function(){
e.setSeekingStatus({
status:1
}),e.showControlBar();
},100)),this.triggerEvent("seeking-status-change",!0);
},
hideSeekingStatus:function(){
var e=this;
this.seekingStatus&&(this.__setSeekingStatusTimeoutId&&clearTimeout(this.__setSeekingStatusTimeoutId),
this.setSeekingStatus({
status:201
}),this.__setSeekingStatusTimeoutId=setTimeout(function(){
e.setSeekingStatus({
status:0
}),e.hideControlBarAfterTimeout();
},100),this.triggerEvent("seeking-status-change",!1));
},
showTouchHorizontalOprBar:function(e){
this.currentTime=e,this.showSeekingStatus(),this.setTouchOprStatus({
status:1
}),this.touchToastSeperator="/",this.touchToastPercent=100*e/this.duration,this.touchToastCurVal=C(e),
this.touchToastTotalVal=this.formatDuration;
},
showTouchVerticalOprBar:function(e,t){
t=Math.min(t,1),t=Math.max(t,0),this.setTouchOprStatus({
status:2
}),this.touchToastSeperator=":",this.touchToastPercent=100*t,this.touchToastCurVal=e,
this.touchToastTotalVal=parseInt(100*t,10)+"%";
},
hideTouchOprBar:function(){
this.hideSeekingStatus(),this.setTouchOprStatus({
status:0
});
},
touchMoveHorizontally:function(e){
var t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY;
this.__pageVideo_touchForwardId&&(clearTimeout(this.__pageVideo_touchForwardId),
this.__pageVideo_touchForwardId=null),this.__pageVideo_firstTouch=!1;
var s=Date.now(),n=s-this.__pageVideo_lastTime,o=t-this.__pageVideo_lastPos.x,a=i-this.__pageVideo_lastPos.y,r=Math.sqrt(Math.pow(o,2)+Math.pow(a,2))+this.__pageVideo_lastDistance,h=Math.min(Math.ceil(r/n),6),u=this.duration;
this.__pageVideo_time=Math.floor(.1*r+.2*h*h*h)*Math.ceil(u/500),this.__pageVideo_lastDistance=0===this.__pageVideo_time?r:0,
0>o&&(this.__pageVideo_time=-this.__pageVideo_time),this.__pageVideo_videoTmpTime+=this.__pageVideo_time,
this.__pageVideo_videoTmpTime<0&&(this.__pageVideo_videoTmpTime=0),this.__pageVideo_videoTmpTime>u&&(this.__pageVideo_videoTmpTime=1*u),
this.showTouchHorizontalOprBar(this.__pageVideo_videoTmpTime),e.preventDefault(),
this.__pageVideo_lastPos={
x:t,
y:i
},this.__pageVideo_lastTime=s;
},
touchMoveVertically:function(e){
var t=this;
this.isWcSlPlayer&&this.fullscreenStatus?!function(){
var i=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;
t.__pageVideo_isTouchMoveUpNDown=!0;
var n=(t.width/t.height>1?Math.max:Math.min)(window.screen.height,window.screen.width),o=parseInt(2*(t.__pageVideo_lastPos.y-s)/n*100);
o&&(o/=100,t.__pageVideo_startPos.x<n/2?(o=t.$refs.video.brightness+o,t.$refs.video.brightness=o,
t.showTouchVerticalOprBar("",o),t.__setBrightnessChangeEventEmitTimeoutId&&clearTimeout(t.__setBrightnessChangeEventEmitTimeoutId),
t.__setBrightnessChangeEventEmitTimeoutId=setTimeout(function(){
t.__setBrightnessChangeEventEmitTimeoutId=null,t.triggerEvent("brightnessChange",{
value:o,
touch:!0
});
},1e3)):(o=t.$refs.video.volume+o,t.$refs.video.volume=o,t.showTouchVerticalOprBar("",o),
t.__setVolumeChangeEventEmitTimeoutId&&clearTimeout(t.__setVolumeChangeEventEmitTimeoutId),
t.__setVolumeChangeEventEmitTimeoutId=setTimeout(function(){
t.__setVolumeChangeEventEmitTimeoutId=null,t.triggerEvent("volumeChange",{
value:o,
touch:!0
});
},1e3)),t.__pageVideo_lastPos={
x:i,
y:s
});
}():this.__pageVideo_canTouchForward=!1,this.__pageVideo_firstTouch=!1;
},
checkIfUntouchable:function(e){
return O(e,this.$el,"div.js_progress_bar,div.js_control,div.js_video_fullscreen_profile")||e.classList.contains("js_progress_bar")||e.classList.contains("js_control")||e.classList.contains("js_video_fullscreen_profile");
},
onPageVideoTouchStart:function(e){
1===e.targetTouches.length&&0===this.banOprStatus&&(this.isEnd()||this.checkIfUntouchable(e.changedTouches[0].target)||this.opt.blockTouchVideo||0!==this.midPlayStatus||(this.__pageVideo_touchForwardId&&(clearTimeout(this.__pageVideo_touchForwardId),
this.__pageVideo_touchForwardId=null),this.__pageVideo_startTime=this.__pageVideo_lastTime=new Date,
this.__pageVideo_startPos=this.__pageVideo_lastPos={
x:e.targetTouches[0].clientX,
y:e.targetTouches[0].clientY
},this.setTouchOprStatus({
status:0
}),this.__pageVideo_firstTouch=!0,this.__pageVideo_canTouchForward=!0,this.__pageVideo_startDragVideoTime=this.__pageVideo_videoTmpTime=this.getCurTime(),
this.clearFastForwardTimeout(),this.maxPlaybackRateInfo&&this.isPlay()&&!this.checkIfOutsideTouchSafeInset(e.targetTouches[0].clientX,e.targetTouches[0].clientY)&&this.startFastForwardTimeout(),
document.body.style.webkitUserSelect="none",document.body.style.userSelect="none"));
},
onPageVideoTouchMove:function(e){
if(this.fullscreenStatus&&e.preventDefault(),this.__pageVideo_startPos&&this.__pageVideo_canTouchForward&&1===e.targetTouches.length&&0===this.banOprStatus&&!(this.isEnd()||this.checkIfUntouchable(e.changedTouches[0].target)||this.checkIfOutsideTouchSafeInset(e.targetTouches[0].clientX,e.targetTouches[0].clientY)||this.opt.blockTouchVideo||0!==this.midPlayStatus)){
var t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,s=Math.abs(t-this.__pageVideo_startPos.x),n=Math.abs(i-this.__pageVideo_startPos.y);
this.__pageVideo_isTouchMoveUpNDown||this.__pageVideo_firstTouch&&(n>=20||n>s)||(e.preventDefault(),
s>=20&&(this.touchMoveHorizontally(e),this.triggerEvent("touch-move-horizontally",e))),
this.clearFastForwardTimeout();
}
},
onPageVideoTouchEnd:function(e){
var t=this;
if(0!==this.touchOprStatus&&!this.__pageVideo_isTouchMoveUpNDown){
if(this.__statusBeforeSeek=this.isPlay()?3:4,this.__pageVideo_touchForwardId=setTimeout(function(){
t.play(t.__pageVideo_videoTmpTime);
},0),this.__pageVideo_canSample&&(p.setSum(28307,29,1),!this.__pageVideo_hasReported)){
var i={
x:e.changedTouches[0].clientX,
y:e.changedTouches[0].clientY
},s=i.x-this.__pageVideo_startPos.x,n=i.y-this.__pageVideo_startPos.y,o=parseInt(Math.sqrt(Math.pow(s,2)+Math.pow(n,2))),a=parseInt(180*Math.atan2(n,s)/Math.PI);
a>=-30&&30>=a||a>=150&&180>=a||a>=-180&&-150>=a||p.setSum(28307,35,1),p.setSum(28307,31,1),
p.setSum(28307,33,o),p.setSum(28307,34,this.__pageVideo_velocity),this.__pageVideo_hasReported=!0;
}
this.videoCtlReport({
step:13
}),this.triggerEvent("handDragComplete",{
playTime:this.__pageVideo_videoTmpTime,
startDragVideoTime:this.__pageVideo_startDragVideoTime
}),e.preventDefault();
}
this.hideTouchOprBar(),this.__pageVideo_time=0,this.__pageVideo_firstTouch=!1,this.__pageVideo_canTouchForward=!0,
this.__pageVideo_isTouchMoveUpNDown=!1,this.__pageVideo_count=0,this.longTouchPlaybackRatePrevValue&&e.preventDefault(),
this.stopFastForward(),this.clearFastForwardTimeout(),setTimeout(function(){
document.body.style.webkitUserSelect="",document.body.style.userSelect="";
},50),this.triggerEvent("playerTouchEnd",e);
},
onPageVideoClick:function(e){
if(1===this.likedCommentTipsStatus)return void this.hideLikedCommentTips();
if(!this.checkIfIgnorePageVideoClick(e)&&!this.isEnd()&&0===this.touchOprStatus){
var t=this.needFeFullscreen&&this.fullscreenStatus&&!this.isLandscape&&0===this.subSettingStatus;
if(t||this.__pageVideo_lastTouchVideoTs&&Date.now()-this.__pageVideo_lastTouchVideoTs<300)return this.clickPlaySwitch(t?1:2),
delete this.__pageVideo_lastTouchVideoTs,void e.preventDefault();
this.__pageVideo_lastTouchVideoTs=Date.now(),this.triggerEvent("touchVideo");
}
},
startFastForwardTimeout:function(){
var e=this;
this.__pageVideo_longTouchPlaybackRateForwardId=setTimeout(function(){
e.longTouchPlaybackRatePrevValue=e.$refs.video.playbackRate,e.setPlaybackRate(e.maxPlaybackRateInfo.rate),
e.__pageVideo_longTouchPlaybackRateForwardId=null,e.__pageVideo_canTouchForward=!1,
e.triggerEvent("fastForward");
},500);
},
clearFastForwardTimeout:function(){
this.__pageVideo_longTouchPlaybackRateForwardId&&(clearTimeout(this.__pageVideo_longTouchPlaybackRateForwardId),
this.__pageVideo_longTouchPlaybackRateForwardId=null);
},
stopFastForward:function(){
this.longTouchPlaybackRatePrevValue&&(this.setPlaybackRate(this.longTouchPlaybackRatePrevValue),
this.longTouchPlaybackRatePrevValue=0);
},
checkIfIgnorePageVideoClick:function(e){
var t=function(t){
return t&&(e.target===t||t.contains(e.target));
};
return t(this.$refs.controlBar)||t(this.$refs.featureBar)||t(this.$refs.navigationBar)||t(this.$refs.subSettingMenu)?!0:!1;
},
firstPlay:function(){
var e=this,t=function(){
e.changeStatus({
status:"loading",
subStatus:"preload"
});
var t=2;
e.__hasReportedBeginPlay?t=9:1*e.$store.state.cgiData.media_source===0&&(t=11),e.videoCtlReport({
step:t
}),e.__hasReportedBeginPlay=!0,e.triggerEvent("readyBeginPlay");
};
"function"==typeof this.opt.checkPlayAuthority?this.opt.checkPlayAuthority({
allowPlay:t
}):t(),this.showLoading();
},
onMidPlayBtnClick:function(){
var e=this;
this.__hasBegunPlaying?(this.play(),this.hideMidPlayBtn()):this.isEnd()?this.replay():this.firstPlay(),
this.$refs.ariaSwitch&&(this.$refs.ariaSwitch.focus(),r.os.android&&setTimeout(function(){
e.$refs.ariaSwitch.setAttribute("role","checkbox"),e.$refs.ariaSwitch.focus();
},100)),this.triggerEvent("midPlayClick",this.__hasBegunPlaying);
},
onPlaySwitchClick:function(){
this.clickPlaySwitch();
},
onFullscreenSwitchClick:function(e){
this.isWcSlPlayer?this.fullscreenStatus?this.exitFullscreen():this.enterFullscreen():(this.fullscreenStatus?this.exitFullscreen():(p.setSum(28307,56,1),
this.enterFullscreen()),e.preventDefault()),e.stopPropagation();
},
onProgressTouchStart:function(e){
var t=e.changedTouches[0];
this.onPointerDownHandler(e,t.pageX,t.pageY);
},
onProgressTouchMove:function(e){
if(this.seekingStatus){
var t=e.changedTouches[0];
this.onPointerMoveHandler(e,t.pageX,t.pageY);
}
},
onProgressTouchEnd:function(e){
if(this.seekingStatus){
var t=e.changedTouches[0];
this.onPointerUpHandler(e,t.pageX,t.pageY);
}
},
onProgressMouseDown:function(e){
this.onPointerDownHandler(e,e.pageX||e.clientX,e.pageY||e.clientY);
},
onProgressMouseMove:function(e){
this.seekingStatus&&this.onPointerMoveHandler(e,e.pageX||e.clientX,e.pageY||e.clientY);
},
onProgressMouseUp:function(e){
this.seekingStatus&&this.onPointerUpHandler(e,e.pageX||e.clientX,e.pageY||e.clientY);
},
onPointerDownHandler:function(e,t,i){
0===this.banOprStatus&&(e.preventDefault(),this.__statusBeforeSeek=this.isPlay()?1:2,
this.__seekingData={
x1:t,
y1:i,
startTime:this.$refs.video.currentTime
},this.pause(),this.showControlBar(),this.showSeekingStatus(),h.isIOS&&!this.fullscreenStatus&&d.invoke("handleDeviceInfo",{
action:"disableInteractivePop",
disable:!0
}));
},
onPointerMoveHandler:function(e,t,i){
this.__hasSeeked=!0,this.__seekingData||(this.__seekingData={
startTime:this.$refs.video.currentTime
}),this.__seekingData.x2=t,this.__seekingData.y2=i;
var s=this.$refs.progressBar.getBoundingClientRect().width,n=parseInt(window.getComputedStyle(this.$refs.playedBar).paddingLeft)||0,o=(t-n-this.$refs.playedBar.getBoundingClientRect().left)/s,a=1*(this.duration*o).toFixed(4);
a>this.duration&&(a=this.duration-.1);
var r="undefined"==typeof this.__seekingData.dragTime,h=Math.abs(1*a-1*this.__seekingData.dragTime);
(r||h>=.5)&&(this.__seekingData.dragTime=a,B("onPointerMoveHandler set currentTime, dragTime:"+a+" currentTime:"+this.$refs.video.currentTime),
this.currentTime=a),e&&e.preventDefault();
},
onPointerUpHandler:function(e,t,i){
e.preventDefault(),this.__seekingData&&"undefined"!=typeof this.__seekingData.dragTime||this.onPointerMoveHandler(null,t,i);
var s=this.__seekingData.startTime,n=this.__seekingData.dragTime;
n===this.$refs.video.currentTime&&(n-=.1),this.__seekingData.startTime&&this.__seekedTimes.push(Math.round(1e3*this.__seekingData.startTime)+":#:"+Math.round(1e3*n)),
B("onPointerUpHandler dragTime:"+n+" currentTime:"+this.$refs.video.currentTime),
this.__seekingData=null,this.isEnd()||(this.showLoading(),this.play(n),this.videoCtlReport({
step:13
}),this.triggerEvent("barDragComplete",{
playTime:n,
startDragVideoTime:s
})),this.hideSeekingStatus(),this.hideControlBarAfterTimeout(),h.isIOS&&!this.fullscreenStatus&&d.invoke("handleDeviceInfo",{
action:"disableInteractivePop",
disable:!1
});
},
onPlaybackRateEntryClick:function(){
if(this.fullscreenStatus)this.hideControlBar(),this.showSubSetting(2),this.triggerEvent("rateChange",{
action:"show"
});else{
var e=this.playbackRateInfoIdx;
this.$refs.video.playbackRate<this.playbackRateInfo[this.opt.playbackRateBtnInfoDefaultId].rate||e>=this.playbackRateInfo.length-1||0>=e?e=this.opt.playbackRateBtnInfoDefaultId:e++;
var t=this.playbackRateInfo[e].rate;
this.showControlBar(),this.hideControlBarAfterTimeout(),this.setPlaybackRate(t,e),
this.showDefaultPlaybackRate=!0,this.triggerEvent("rateChange",{
action:"select"
});
}
},
onPlaybackRateSelect:function(e){
var t=this.playbackRateInfo[e].rate;
if(this.setPlaybackRate(t,e),this.hideSubSettingAfterTimeout(),this.triggerEvent("rateChange",{
action:"select"
}),this.showControlBar(),this.isPlay()&&this.hideControlBarAfterTimeout(),this.fullscreenStatus){
var i=this.playbackRateInfo[e].name;
this.showTopTips("%s".replace("%s",i));
}
},
setPlaybackRate:function(e,t){
if(this.$refs.video.playbackRate!==e&&(this.__playbackRateBeforeChange=this.$refs.video.playbackRate,
this.$refs.video.playbackRate=e,this.isWcSlPlayer||this.isPlay()||this.$refs.video.play()),
t)this.playbackRateInfoIdx=t;else for(var i=0;i<this.playbackRateInfo.length;i++)if(e===this.playbackRateInfo[i].rate){
this.playbackRateInfoIdx=i;
break;
}
},
onResolutionEntryClick:function(){
this.hideControlBar(),this.showSubSetting(1),this.triggerEvent("resolutionChange",{
action:"show"
});
},
onResolutionSelect:function(e){
if(this.setResolution(e),this.hideSubSettingAfterTimeout(),this.triggerEvent("resolutionChange",{
action:"select"
}),this.showControlBar(),this.isPlay()&&this.hideControlBarAfterTimeout(),this.fullscreenStatus){
var t=this.resolutionInfo[e].name;
this.showTopTips("%s".replace("%s",t));
}
},
onIPadOrientationChange:function(){
var e=this;
90===window.orientation||-90===window.orientation?(this.setOrientationStatus({
status:1
}),this.resetVideoFullPortraitAlign()):(this.setOrientationStatus({
status:0
}),this.setVideoFullPortraitAlign()),setTimeout(function(){
e.fullscreenStatus&&!e.isImmersiveMode&&d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!0,
showStatusBar:!0,
hideBottomBar:!0
});
},250);
},
onAndroidOrientationChange:function(e){
if(!(this.videoRatio<=1)&&this.fullscreenStatus&&e&&!e.sysLock&&!this.isImmersiveMode){
var t=function(){
d.invoke("handleDeviceInfo",{
action:"setOrientation",
orientation:e.newOrientation,
lock:!0
});
};
-1!==[90,-90].indexOf(e.newOrientation)?(this.setOrientationStatus({
status:1
}),this.resetVideoFullPortraitAlign(),t()):1===this.orientationStatus&&0===e.newOrientation&&(this.setOrientationStatus({
status:0
}),this.setVideoFullPortraitAlign(),t());
}
},
onWindowResize:function(){
this.videoRatio<=1||this.fullscreenStatus&&(this.isLandscape||k.outerWidth===window.outerWidth?this.isLandscape&&k.outerWidth===window.outerWidth&&(this.setOrientationStatus({
status:0
}),this.setVideoFullPortraitAlign(),this.isWcSlPlayer&&this.enableWcSlPlayerFullscreenAfterOrientationChange&&this.$refs.video.exitFullscreen({
updateStyleOnly:this.updateStyleOnly
})):(this.setOrientationStatus({
status:1
}),this.resetVideoFullPortraitAlign()));
},
onOrientationChange:function(){
var e=this;
this.videoRatio<=1||(setTimeout(function(){
e.isLandscape||90!==window.orientation&&-90!==window.orientation?e.isLandscape&&0===window.orientation&&(e.setOrientationStatus({
status:0
}),e.setVideoFullPortraitAlign(),e.isWcSlPlayer&&e.enableWcSlPlayerFullscreenAfterOrientationChange&&e.$refs.video.exitFullscreen({
updateStyleOnly:e.updateStyleOnly
})):(e.setOrientationStatus({
status:1
}),e.resetVideoFullPortraitAlign(),e.isWcSlPlayer&&e.enableWcSlPlayerFullscreenAfterOrientationChange&&e.fullscreenStatus&&e.$refs.video.requestFullscreen(window.orientation,{
updateStyleOnly:e.updateStyleOnly
}));
},250),r.os.iphone||(this.androidLandscapeFullOrientation=this.fullscreenStatus&&90===window.orientation?90:0));
},
onIOSPageStateChange:function(e){
!this.fullscreenStatus&&e&&e.active&&(d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!0
}),d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!1
}),d.invoke("setNavigationBarColor",{
wxcolor:{
light:"#FFFFFF",
dark:"#191919"
},
alpha:1
}));
},
onVisibilityChange:function(){
return V()||this.syncSubscribeStatus(),this.isWcSlPlayer?void(V()||!r.os.iphone||this.isImmersiveMode||!this.fullscreenStatus||this.isLandscape||d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!0,
orientation:0,
animate:!1
})):void(V()?this.hasBegunPlaying()&&this.isPlay()&&(this.pause4outer(),this.__pausedWhenInvisible=!0):this.__pausedWhenInvisible&&(delete this.__pausedWhenInvisible,
this.hasBegunPlaying()&&!this.isEnd()&&this.play4outer()));
},
onNetworkChange:function(e){
e&&(e.networkType||(e.networkType=e.netType),e.networkType&&e.simType&&(this.__lastNetworkType&&this.__lastNetworkType.networkType===e.networkType&&this.__lastNetworkType.simType===e.simType||(c.isMobileNetwork(e.networkType)&&1!==e.simType&&this.__lastNetworkType&&("wifi"===this.__lastNetworkType.networkType||c.isNoneNetwork(this.__lastNetworkType.networkType))&&(this.__isUserPause=!1,
this.__pauseNetType=null,!this.isPlay()&&!this.isEnd()&&this.isPause()&&this.hasBegunPlaying()?(this.__isUserPause=!0,
this.__pauseNetType=this.__lastNetworkType.networkType):this.isPlay()&&("wifi"===this.__lastNetworkType.networkType&&c.isVideoNeedFlowNotice(this.opt.flow,2)||c.isNoneNetwork(this.__lastNetworkType.networkType)&&c.isVideoNeedFlowNotice(this.opt.flow,4))&&this.showFlowNotice()),
this.__lastNetworkType={
networkType:e.networkType,
simType:e.simType
})));
},
setResolution:function(e){
var t=this;
this.resolutionInfoIdx!==e&&!function(){
var i=t.resolutionInfo[t.resolutionInfoIdx],s=t.resolutionInfo[e],n=t.$refs.video;
t.isWcSlPlayer?n.resolutionSrc=s.src:!function(){
n.pause(),t.setSnapshot();
var e=n.currentTime,i=n.playbackRate;
t.$nextTick(function(){
n.src=s.src,n.play(),t.play(e),t.setPlaybackRate(i),t.onResolutionchange();
});
}(),t.__resolutionInfoBeforeChange=i,t.resolutionInfoIdx=e;
}();
},
setSnapshot:function(){
if(!this.isWcSlPlayer)try{
var e=this.$refs.video,t=document.createElement("canvas"),i=t.getContext("2d");
t.width=e.videoWidth,t.height=e.videoHeight,i.drawImage(e,0,0,t.width,t.height),
this.snapshot=t.toDataURL("image/jpeg",0);
}catch(s){
this.snapshot="",console.error(s);
}
},
showLoading:function(){
var e=this;
this.__hasShownLoading&&this.$refs.video&&this.$refs.video.currentTime>1||(this.__hasShownLoading=!0,
this.__resetShowingLoadingTimeoutId&&(clearTimeout(this.__resetShowingLoadingTimeoutId),
delete this.__resetShowingLoadingTimeoutId),this.__resetShowingLoadingTimeoutId=setTimeout(function(){
e.__hasShownLoading=!1;
},1e3),this.__showingLoadingTimeoutId&&(clearTimeout(this.__showingLoadingTimeoutId),
delete this.__showingLoadingTimeoutId),this.__showingLoadingTimeoutId=setTimeout(function(){
e.__firstShowLoadingTime||(e.__firstShowLoadingTime=(new Date).getTime()),e.setLoadingStatus({
status:1
});
},800));
},
hideLoading:function(){
this.setLoadingStatus({
status:0
}),this.firstLoadingTime||(this.firstLoadingTime=this.__firstShowLoadingTime?(new Date).getTime()-this.__firstShowLoadingTime:0),
this.__showingLoadingTimeoutId&&(clearTimeout(this.__showingLoadingTimeoutId),delete this.__showingLoadingTimeoutId),
this.snapshot&&(this.snapshot="");
},
showControlBar:function(){
1!==this.controlBarStatus&&(this.__touchVideoTimeoutId&&(clearTimeout(this.__touchVideoTimeoutId),
delete this.__touchVideoTimeoutId),this.__hidingControlBarTimeoutId&&(clearTimeout(this.__hidingControlBarTimeoutId),
delete this.__hidingControlBarTimeoutId),this.__userPlayTime||this.setControlBarStatus({
status:1
}),this.triggerEvent("showControlBar"));
},
hideControlBar:function(){
var e=this;
0===this.controlBarStatus||101===this.controlBarStatus||this.$refs.ariaSwitch.checked||(this.__hidingControlBarTimeoutId&&clearTimeout(this.__hidingControlBarTimeoutId),
this.setControlBarStatus({
status:101
}),this.__hidingControlBarTimeoutId=setTimeout(function(){
e.setControlBarStatus({
status:0
}),e.showDefaultPlaybackRate=!1,e.triggerEvent("hideControlBar");
},100));
},
triggerAriaSwitch:function(){
this.$refs.ariaSwitch.checked?this.showControlBar():this.hideControlBar();
},
hideControlBarAfterTimeout:function(){
var e=this;
this.__touchVideoTimeoutId&&clearTimeout(this.__touchVideoTimeoutId),this.__touchVideoTimeoutId=setTimeout(function(){
return e.seekingStatus?void e.hideControlBarAfterTimeout():void(e.isPlay()&&e.hideControlBar());
},5e3);
},
showLikedCommentTips:function(){
1!==this.likedCommentTipsStatus&&(this.likedCommentTipsStatus=1,this.triggerEvent("likedCommentTipsStatusChange",!0));
},
hideLikedCommentTips:function(){
var e=this;
1===this.likedCommentTipsStatus&&(this.likedCommentTipsStatus=101,setTimeout(function(){
return e.likedCommentTipsStatus=0;
},100),this.triggerEvent("likedCommentTipsStatusChange",!1)),this.__hideLikedCommentTipsTimeoutId&&(clearTimeout(this.__hideLikedCommentTipsTimeoutId),
this.__hideLikedCommentTipsTimeoutId=null);
},
showCover:function(){
this.setCoverStatus({
status:1
});
},
hideCover:function(){
this.setCoverStatus({
status:0
});
},
showMidPlayBtn:function(){
this.setMidPlayStatus({
status:1
});
},
hideMidPlayBtn:function(){
this.setMidPlayStatus({
status:0
});
},
showSubscribeBtn:function(e,t){
"number"!=typeof e&&(e=1),(t||0===window.isFans&&k.supportSubscribe&&(0===this.subscribeStatus&&1===e||1===this.subscribeStatus&&2===e))&&(this.subscribeStatus=e,
this.triggerShowSubscribeEvent());
},
triggerShowSubscribeEvent:function(){
1===this.subscribeStatus&&this.fullscreenStatus&&this.triggerEvent("showSubscribe");
},
hideSubscribeBtn:function(){
this.subscribeStatus&&(this.subscribeStatus=3);
},
syncSubscribeStatus:function(){
var e=this,t=arguments.length<=0||void 0===arguments[0]?3:arguments[0];
t>0&&setTimeout(function(){
m({
url:"/mp/videochannel_profile_page?action=check_contact&biz_username="+e.opt.bizUserName+"&__biz="+e.opt.__biz,
dataType:"json",
async:!1,
success:function(t){
1===t.subscribed&&0===window.isFans?(e.showSubscribeBtn(2,!0),window.isFans=1):0===t.subscribed&&1===window.isFans&&(e.hideSubscribeBtn(),
window.isFans=0);
},
complete:function(){
return e.syncSubscribeStatus(--t);
}
});
},500);
},
changeFullscreenLandscapeMode:function(e){
if(r.os.ipad)return this.exitFullscreen();
var t=function(){
d.invoke("handleDeviceInfo",{
action:"setOrientation",
orientation:e,
lock:!!r.os.android
});
},i=this.updateStyleOnly;
this.isWcSlPlayer&&(90===e?(this.$refs.video.requestFullscreen(e,{
updateStyleOnly:i
}),this.showControlBar(),this.hideControlBarAfterTimeout()):this.$refs.video.exitFullscreen({
updateStyleOnly:i
})),i&&t();
},
enterFullscreen:function(){
var e=this;
if(!this.fullscreenStatus)return this.triggerEvent("enterFullscreen",{
click:!0
}),this.isWcSlPlayer||this.isFeFullscreen?(this.__originFullscreenStatus=!0,this.handleFullscreenChange({
state:!0,
type:this.isImmersiveMode?"immersive":"frontend"
}),void(this.opt.preCreate||(this.isImmersiveMode||(h.isIOS?(setTimeout(function(){
d.invoke("setNavigationBarColor",{
color:"#000000",
alpha:0
});
},35),setTimeout(function(){
d.invoke("handleDeviceInfo",{
action:"enableFullScreenLayout",
enable:!0
}),d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!0,
orientation:r.os.ipad?window.orientation:0,
animate:!1,
showStatusBar:!0,
hideBottomBar:!0
},function(t){
-1!==t.err_msg.indexOf(":ok")&&(h.isIOS&&d.invoke("handleDeviceInfo",{
action:"disableInteractivePop",
disable:!0
}),r.os.ipad&&e.onIPadOrientationChange());
});
},50)):d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!0,
orientation:0
})),this.enterFullscreenEffect()))):void this.callJsapiFullscreen();
},
enterFullscreenEffect:function(){
var e=this;
this.enableWcSlPlayerFullscreenAfterOrientationChange=this.isImmersiveMode?!0:"update-style-only",
this.needFeFullscreen&&(window.addEventListener("unload",this.exitFullscreen),d.on("onMPCustomMenuItemClick",this.onFullscreenMenuClick),
r.os.android&&!this.isImmersiveMode&&d.on("onExitFullscreen",this.__onAndroidExitFullscreen=function(){
return e.exitFullscreen();
})),this.isImmersiveMode&&d.on("onNavigationBarRightButtonClick",this.onShowFullscreenMenu),
d.invoke("handleDeviceInfo",{
action:"setOrientation",
orientation:0,
lock:this.videoRatio<=1
});
},
exitFullscreen:function(){
var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];
this.fullscreenStatus&&((!this.isLandscape||r.os.ipad||t.directExit)&&this.triggerEvent("exitFullscreen"),
this.enableWcSlPlayerFullscreenAfterOrientationChange=!0,this.__originFullscreenStatus=!1,
this.setFullscreenStatus({
status:101
}),setTimeout(function(){
d.invoke("setNavigationBarColor",{
wxcolor:{
light:"#FFFFFF",
dark:"#191919"
},
alpha:1
});
},150),setTimeout(function(){
d.invoke("handleDeviceInfo",{
action:"enableFullScreenLayout",
enable:!1
}),d.invoke("handleDeviceInfo",{
action:"enableFullScreen",
enable:!1,
orientation:0,
animate:!1
},function(t){
-1!==t.err_msg.indexOf(":ok")&&(h.isIOS&&d.invoke("handleDeviceInfo",{
action:"disableInteractivePop",
disable:!1
}),e.handleFullscreenChange({
state:!1,
type:e.isImmersiveMode?"immersive":"frontend"
}));
});
},100),d.invoke("handleDeviceInfo",{
action:"setOrientation",
orientation:0,
lock:!1
}),this.exitFullscreenEffect());
},
exitFullscreenEffect:function(){
this.needFeFullscreen&&(window.removeEventListener("unload",this.exitFullscreen),
this.isImmersiveMode&&d.remove("onNavigationBarRightButtonClick",this.onShowFullscreenMenu),
d.remove("onMPCustomMenuItemClick",this.onFullscreenMenuClick),this.isFeFullscreen&&r.os.android&&d.remove("onExitFullscreen",this.__onAndroidExitFullscreen));
},
callH5Fullscreen:function(){
this.__jsapiFullscreenTimeoutId&&(clearTimeout(this.__jsapiFullscreenTimeoutId),
this.__jsapiFullscreenTimeoutId=null);
var e=this.$refs.video;
e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitEnterFullscreen&&e.webkitEnterFullscreen();
},
callJsapiFullscreen:function(){
var e=this;
if(this.__jsapiFullscreenTimeoutId&&(clearTimeout(this.__jsapiFullscreenTimeoutId),
this.__jsapiFullscreenTimeoutId=null),!this.supportNativeFullPlayer||this.__jsapiFullscreenErrCnt>=2)return void this.callH5Fullscreen();
r.os.android||this.pause4outer({
triggerEvent:!1
});
var t=this.$refs.video,i=this.$store.state.cgiData,s=window.source||"",n=window.msg_link.html(!1),o=window.user_name||(i?i.username||i.user_name:"")||"",a=window.nickname||(i?i.nick_name:"")||"",h="";
if(r.os.ios){
var u=document.createElement("canvas"),l=u.getContext("2d");
u.style.width=this.opt.videoWidth+"px",u.width=this.opt.videoWidth,u.style.height=this.opt.videoHeight+"px",
u.height=this.opt.videoHeight,l.drawImage(t,0,0,this.opt.videoWidth,this.opt.videoHeight),
h=u.toDataURL("image/jpeg",1);
}
var c=t.getBoundingClientRect(),p={
left:c.left,
top:c.top,
height:c.bottom-c.top,
width:c.right-c.left
},g=this.opt.extinfo,m=g&&g.vid||"",_={
action:"enterEmbedMpVideo",
mpBizUin:this.opt.__biz||"",
mpAppMsgId:this.opt.mid||"",
mpIndex:this.opt.idx||"",
mpUrl:n,
bizUsrName:o,
bizNickName:a,
videoUrl:w.addParam(this.opt.src,"video_md5",this.opt.videoMd5||""),
videoTitle:this.opt.videoTitle,
videoCurrTime:this.getCurTime(),
videoWidth:this.opt.videoWidth,
videoHeight:this.opt.videoHeight,
videoThumbUrl:this.opt.cover,
videoDuration:1*this.opt.duration,
videoVid:m,
playerX:p.left,
playerY:p.top,
playerWidth:p.width,
playerHeight:p.height,
subscene:1*s,
headImgUrl:this.opt.headImgUrl,
currFrameData:h,
forbidForward:this.canShareVideo?0:1
};
h&&(this.__jsapiFullscreenTimeoutId=setTimeout(function(){
e.setFullscreenStatus({
status:0
});
},2e3)),d.invoke("handleMPPageAction",_,function(t){
e.__jsapiFullscreenTimeoutId&&(clearTimeout(e.__jsapiFullscreenTimeoutId),e.__jsapiFullscreenTimeoutId=null),
/:ok$/.test(t.err_msg)?(e.setFullscreenStatus({
status:1
}),e.handleFullscreenChange({
state:!0,
type:"jsapi"
})):(e.setFullscreenStatus({
status:0
}),r.os.android||e.play4outer(0/0,{
triggerEvent:!1
}),e.__jsapiFullscreenErrCnt++);
}),r.os.android&&(window.CustomFullscreenApi&&"function"==typeof window.CustomFullscreenApi._customEnterFullscreen&&window.CustomFullscreenApi._customEnterFullscreen(!0),
this.callH5Fullscreen());
},
onJsapiExitFullscreen:function(e){
if(e&&"onExitMpVideoFullPage"===e.action){
var t=this.opt.extinfo,i=t&&t.vid||"";
if(i&&i===e.videoVid){
if(!r.os.android){
var s=1*e.videoCurrTime;
s=-1===s?0/0:s;
var n=this.duration;
parseInt(n,10)===parseInt(s,10)||s>n?this.onVideoEnded():(this.__statusBeforeSeek=1,
this.play4outer(s,{
triggerEvent:!1
}));
}
this.fullscreenStatus&&this.handleFullscreenChange({
state:!1,
type:"jsapi"
});
}
}
},
showResolutionEntry:function(){
this.setResolutionEntryStatus({
status:1
});
},
hideResolutionEntry:function(){
this.setResolutionEntryStatus({
status:0
});
},
showSubSetting:function(e){
this.__hideSubSettingTimeoutId&&clearTimeout(this.__hideSubSettingTimeoutId),this.setSubSettingStatus({
status:e
});
},
hideSubSetting:function(){
this.setSubSettingStatus({
status:0
});
},
hideSubSettingAfterTimeout:function(){
var e=this;
if(0!==this.subSettingStatus){
this.__hideSubSettingTimeoutId&&clearTimeout(this.__hideSubSettingTimeoutId);
var t=this.subSettingStatus;
this.setSubSettingStatus({
status:100+t
}),this.__hideSubSettingTimeoutId=setTimeout(function(){
e.setSubSettingStatus({
status:0
}),1===t?e.triggerEvent("resolutionChange",{
action:"hide"
}):2===t&&e.triggerEvent("rateChange",{
action:"hide"
});
},250);
}
},
clickPlaySwitch:function(e,t){
0===this.banOprStatus&&(this.isPlay()?(e||this.videoCtlReport({
step:12
}),this.pause4outer({
tapType:e,
triggerEvent:t
})):this.play4outer(0/0,{
tapType:e
}));
},
preventOperating:function(e){
this.setBanOprStatus({
status:e||1
});
},
resumeOperating:function(){
this.setBanOprStatus({
status:0
});
},
jsapiLog:function(e){
var t=["vid:","videosrc:"];
this.opt&&this.opt.extinfo&&this.opt.extinfo.vid&&(t[0]+=this.opt.extinfo.vid),this.$refs.video&&this.$refs.video.src&&(t[1]+=this.$refs.video.src),
o.info("videoplayer "+e+";"+t.join(";"));
},
triggerEvent:function(e,t){
var i=this;
if("timeupdate"!==e||"timeupdate"===e&&this.__enableTimeupdateLog){
"timeupdate"===e&&(this.__enableTimeupdateLog=!1,setTimeout(function(){
i.__enableTimeupdateLog=!0;
},5e3));
try{
var s="",n=Object.prototype.toString.call(t);
s="[object String]"===n?t:"[object Object]"===n||"[object Array]"===n?JSON.stringify(t):"no params",
this.jsapiLog("trigger:"+e+";arg:"+s+";");
}catch(o){}
}
var a=this[e+"InnerHandler"];
a&&a.call(this,t),this.emitEvent(e.replace(/[A-Z]/g,function(e){
return"-"+e.toLowerCase();
}),t);
},
emitEvent:function(e){
for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;t>s;s++)i[s-1]=arguments[s];
this.$refs.video&&e&&this.$emit.apply(this,[e].concat(i));
},
errorInnerHandler:function(){
this.isWcSlPlayer||this.$refs.video.removeAttribute("src");
},
loadingInnerHandler:function(e){
this.triggerEvent("ready",e);
},
readyInnerHandler:function(e){
this.triggerEvent("loaded",e);
},
loadedInnerHandler:function(e){
return(e&&e.autoplay||this.autoplay||this.checkAndResetSecOpenAutoPlay())&&l.device.inWechat?(this.videoCtlReport({
step:15
}),this.__hasReportedBeginPlay=!0,void this.triggerEvent("readyBeginPlay",e)):void this.setBeginPlayStatus();
},
readyBeginPlayInnerHandler:function(e){
var t=this;
(!this.isWcSlPlayer||!this.autoplay)&&"number"==typeof this.initialTime&&this.initialTime>0&&this.initialTime<.99*this.duration&&setTimeout(function(){
return t.play(t.initialTime);
},0),this.triggerEvent("beginPlay",e),this.isWcSlPlayer||null!==this.__replaySec&&0!==this.__replaySec||!r.os.ios||(this.$refs.video.currentTime=.1);
},
beginPlayInnerHandler:function(e){
var t=this,i=this.$refs.video,s=function(){
t.__userPlayTime=!0,t.__hasBegunPlaying=!0,t.showCover(),t.hideMidPlayBtn(),t.showLoading(),
t.opt.flowNotice&&t.firstLoadedFlowNoticeJudge();
};
setTimeout(function(){
try{
if(t.__continueSec&&(t.__replaySec=t.__continueSec,t.__continueSec=null),t.jsapiLog("set continue:"+t.__replaySec),
t.__firstPlayStart=Date.now(),t.isWcSlPlayer)e&&e.replay?(t.setControlBarStatus({
status:0
}),t.__canplay=!0,t.__statusBeforeSeek=1,t.bufferedPercent=0,t.currentTime=0,i.currentTime=0):t.autoplay||(t.__canplay=!0,
i.play()),s();else{
var n=i.play();
"object"===("undefined"==typeof n?"undefined":_typeof(n))?n.then(s).catch(function(e){
("AbortError"===e.name||"NotAllowedError"===e.name)&&d.invoke("getNetworkType",{},function(){
i.play().then(s).catch(function(e){
("AbortError"===e.name||"NotAllowedError"===e.name)&&(t.setBeginPlayStatus(),p.setSum(114217,16,1));
});
});
}):s();
}
}catch(o){
t.jsapiLog("play error:"+o.toString());
}
});
},
replayInnerHandler:function(){
this.videoCtlReport({
step:9
}),this.afterReplay();
},
endInnerHandler:function(){
this.setAccessPlayBtnStatus({
status:3
}),this.__canplay=!1,this.__hasBegunPlaying=!1,this.hidePlayControl(),this.hideTouchOprBar(),
this.hideSubSettingAfterTimeout();
},
touchVideoInnerHandler:function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];
return this.opt.blockTouchVideo||this.seekingStatus||this.__userPlayTime?!1:!this.__canplay||this.isEnd()&&this.opt.hideControlBarAtEnd?void this.hideControlBar():(e.isShow===!0||0===this.controlBarStatus?this.showControlBar():this.hideControlBar(),
this.isPlay()&&this.hideControlBarAfterTimeout(),void this.hideSubSettingAfterTimeout());
},
firstLoadedFlowNoticeJudge:function(){
l.device.inWechat&&this.__lastNetworkType&&this.__lastNetworkType.networkType&&this.__lastNetworkType.simType&&c.isMobileNetwork(this.__lastNetworkType.networkType)&&1!==this.__lastNetworkType.simType&&c.isVideoNeedFlowNotice(this.opt.flow,this.flowNum?5:1)&&this.showFlowNotice();
},
showTopTips:function(e){
var t=this;
this.__topTipsTimeoutId&&clearTimeout(this.__topTipsTimeoutId),this.topTips=e,this.__topTipsTimeoutId=setTimeout(function(){
t.__topTipsTimeoutId=null,t.topTips="";
},3500);
},
showFlowNotice:function(){
var e=this.flowNum?2:1;
this.videoCtlReport({
step:16,
noticeType:e
}),this.triggerEvent("flowNotice",{
flow:parseInt(1024*this.opt.flow),
noticeType:e
}),this.showTopTips(this.flowNum?""+this.flowNum+"M":"Wi-Fi");
},
hidePlayControl:function(){
this.__isUserPause&&l.device.inWechat&&("wifi"===this.__pauseNetType&&c.isVideoNeedFlowNotice(this.opt.flow,3)||c.isNoneNetwork(this.__pauseNetType)&&c.isVideoNeedFlowNotice(this.opt.flow,4)?this.showFlowNotice():(this.__isUserPause=!1,
this.__pauseNetType=null)),this.hideMidPlayBtn(),this.hideControlBarAfterTimeout();
},
showPlayControl:function(){
this.isEnd()||this.showControlBar();
},
reinitVideo:function(){
var e=this;
this.__canplay=!1,this.removeVideo=!0,this.$nextTick(function(){
e.removeVideo=!1,e.$nextTick(function(){
return e.triggerEvent("loading");
});
});
},
fallbackFromWcSlVideoToH5Player:function(){
console.error("fallback from wcslplayer to h5player",this.$refs.video.error),this.jsapiLog("fallback from wcslplayer to h5player: "+this.$refs.video.error),
g.__useWcSlPlayer=this.isWcSlPlayer=!1,this.__fallbackFromWcSlVideoToH5Player=!0,
this.reinitVideo();
},
afterReplay:function(){
this.__hasBegunPlaying=!0,this.__userPlayTime=!0,this.__firstPlayStart=Date.now(),
this.showLoading(),this.play(),this.triggerEvent("afterReplay");
},
supportWcSlPlayer:function(){
return window.__failConfigWxOpen?!1:this.__fallbackFromWcSlVideoToH5Player?!1:k.wcSlPlayerSupport;
},
videoCtlReport:function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.opt.extinfo;
if(t){
var i={
step:e.step,
vid:t.vid,
hit_bizuin:t.hit_bizuin,
hit_vid:t.hit_vid,
traceid:t.pageplayer.getTraceId(),
orderid:t.pageplayer.getOrderid(),
ori_status:t.pageplayer.getOriStatus(),
type:"undefined"!=typeof this.opt.videoReportType?this.opt.videoReportType:-1,
fromid:t.pageplayer.getFromid()
};
e.step>=16?(i.remind_traffic_size=parseInt(1024*this.opt.flow),i.traffic_reminder_type=e.noticeType,
u.commReport(i)):u.report(i);
}
},
replay:function(){
this.hideMidPlayBtn(),this.triggerEvent("readyBeginPlay",{
replay:!0
}),this.triggerEvent("replay");
},
resetVideo:function(){
this.autoplay=!1,this.initialTime=0,this.showCover(),this.reinitVideo(),this.checkAndResetSecOpenAutoPlay();
},
changeStatus:function(e){
var t=this;
if(k.statusDefine[e.status]&&(!e.subStatus||k.subStatusDefine[e.subStatus]||"error"===e.status)&&(this.status!==e.status||this.subStatus!==e.subStatus)){
var i=0;
"end"===e.status||"error"===e.status?(this.__playingBufferingStartTime=null,this.__userPlayTime=!1):"pause"===e.status?this.__playingBufferingStartTime=null:"play"===e.status&&"playing"===e.subStatus&&null!==this.__playingBufferingStartTime?(i=Date.now()-this.__playingBufferingStartTime,
this.__playingBufferingStartTime=null):this.__hasBegunPlaying&&this.__canplay&&!this.__userPlayTime&&"loading"===e.status&&"waiting"===e.subStatus&&null===this.__playingBufferingStartTime&&(this.__playingBufferingStartTime=Date.now());
var s=this.status,n=this.subStatus;
this.setStatus({
status:e.status,
subStatus:e.subStatus
});
var o=["player statusChange, preStatus:",s,"; status:",this.status,"; preSubStatus:",n,"; subStatus:",this.subStatus,"; video_duration:",this.$refs.video?this.$refs.video.duration:"0","; getvinfo_duration:",this.duration,"; current_time:",this.$refs.video?this.$refs.video.currentTime:"0","; play_total_time:",this.getPlayTotalTime()].join("");
this.jsapiLog(o),"error"===e.status&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&(this.jsapiLog("client api get video begin: "+this.src),
this.src?d.invoke("request",{
url:this.src,
method:"GET",
data:{},
header:{
Range:"bytes=0-1"
}
},function(i){
t.jsapiLog("client api get video end: "+t.src);
var s=/^https?:\/\/\[/.test(t.src)?"Player:IPv6Error":"Player:IPv4Error",n="errorCode: "+e.subStatus+"; errorMsg: "+e.errorMsg+"; src: "+t.src+"; "+(window.__second_open__?"secopen":"h5")+"; res: "+JSON.stringify(i);
window.WX_BJ_REPORT.BadJs.report(s,n);
}):window.WX_BJ_REPORT.BadJs.report("Player:IPv4Error","errorCode: "+e.subStatus+"; errorMsg: "+e.errorMsg+"; src: "+this.src+"; "+(window.__second_open__?"secopen":"h5"))),
B(o),this.triggerEvent("statusChange",{
currentTime:this.$refs.video&&this.$refs.video.currentTime,
preStatus:s,
preSubStatus:n,
status:this.status,
subStatus:this.subStatus
}),i&&(this.triggerEvent("playingBufferingTime",{
bufferingTime:i
}),this.useQuic&&(p.setSum(237895,15,i),p.setSum(237895,18,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("WcSlPlayer:UseQuicBufferingTime",(window.__second_open__?"secopen:":"h5:")+i,{
mid:"mmbizwap:quic_Monitor",
view:"wap_business"
})),this.compare1&&(p.setSum(237895,16,i),p.setSum(237895,19,1)),this.compare2&&(p.setSum(237895,17,i),
p.setSum(237895,20,1)));
}
},
play:function(e){
var t=this.$refs.video;
if(this.showPauseBtn=!0,!this.isEnd()){
if(this.isWcSlPlayer&&t&&null==t.readyState)return void("number"!=typeof this.initialTime||0===this.initialTime?this.__playQueue[0]={
sec:e
}:(this.__lastPlayTime=e,this.currentTime=e));
if(!t||0===t.readyState)return void(this.__playQueue[0]={
sec:e
});
e*=1;
try{
if(isNaN(e)||"number"!=typeof e)this.__canplay&&this.isPause()||0===t.currentTime?t.play():t.currentTime=0;else{
var i=this.duration;
e>=i&&(e=i-1),0>e&&(e=0),e=1*(1*e).toFixed(4),this.__lastPlayTime=e,this.currentTime=e,
t.currentTime===e?t.play():t.currentTime=e;
}
}catch(s){
0===t.currentTime?t.play():t.currentTime=0,console.error(s);
}
}
},
pause:function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];
e.withoutPauseBtn&&(this.showPauseBtn=!1);
var t=this.$refs.video;
t&&null!=t.readyState&&0!==t.readyState&&(this.__replaySec=null,this.__waitingTimeoutId&&(clearTimeout(this.__waitingTimeoutId),
this.__waitingTimeoutId=null),t.pause(),B(this.id+":pause function"));
},
play4outer:function(e){
var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];
this.play(e),t.triggerEvent!==!1&&this.triggerEvent("userplay",{
tapType:t.tapType||0
}),this.hideMidPlayBtn(),this.hidePlayControl();
},
pause4outer:function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];
this.hideLoading(),this.pause(),e.triggerEvent!==!1&&this.triggerEvent("userpause",{
tapType:e.tapType||0
}),this.hideControlBar(),this.showPlayControl();
},
afterFirstLoaded:function(){
this.__userPlayTime&&(this.__userPlayTime=!1,this.reportRealLoadingTime(),this.resumeOperating());
},
reportRealLoadingTime:function(){
var e=parseInt(Date.now()-(this.__firstPlayStart||Date.now()));
console.info("[]",e),this.__firstPlayStart=null,this.triggerEvent("firstBufferingTime",{
bufferingTime:e,
initialTime:this.initialTime
}),this.useQuic&&(p.setSum(237895,9,e),e>3e5&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("WcSlPlayer:UseQuicfirstPlayTime",(window.__second_open__?"secopen:":"h5:")+e,{
mid:"mmbizwap:quic_Monitor",
view:"wap_business"
})),this.compare1&&p.setSum(237895,10,e),this.compare2&&p.setSum(237895,11,e);
},
hasSeeked:function(){
return!!this.__hasSeeked;
},
getCurTime:function(){
return this.$refs.video&&this.$refs.video.currentTime||0;
},
getPlaybackRate:function(){
return this.$refs.video&&this.$refs.video.playbackRate||1;
},
getResolutionInfo:function(){
var e=this;
if(this.$refs.video){
var t=function(){
var t=e.isWcSlPlayer?e.$refs.video.resolutionSrc:e.$refs.video.src;
return{
v:e.resolutionInfo?e.resolutionInfo.filter(function(e){
return e.src===t;
})[0]:null
};
}();
if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v;
}
},
getSeekedTimes:function(){
return this.__seekedTimes;
},
getPlayTotalTime:function(){
return this.endCountTime(),this.$refs.video&&(this.__lastPlayTime=this.$refs.video.currentTime),
this.__totalPlayTime;
},
getLog:function(){
var e=this.log||{};
return{
hasended:e.hasended,
last_ms:Math.floor(1e3*(e.lastsec||0)),
duration_ms:Math.floor(1e3*(e.duration||0)),
video_error:e.video_error||0,
video_error_code:e.video_error_code||0,
loadwait:e.loadwait||0
};
},
isPlay:function(){
return this.$refs.video?!this.$refs.video.paused&&!this.isEnd():!1;
},
isPause:function(){
return this.$refs.video?!!this.$refs.video.paused:!0;
},
isEnd:function(){
return this.$refs.video?!!this.$refs.video.ended:!1;
},
hasBegunPlaying:function(){
return this.__hasBegunPlaying;
},
setBeginPlayStatus:function(){
var e=this;
this.opt.preCreate||this.showMidPlayBtn(),setTimeout(function(){
e.hideLoading();
});
},
showToast:function(e,t){
this.$refs.toast.open(e,t);
},
shareVideo:function(){
return this.opt.extinfo&&this.opt.extinfo.preview?void window.weui.alert(""):void(this.canShareVideo&&((this.needFeFullscreen||r.os.ipad)&&this.supportImmersiveMode?(d.invoke("handleMPPageAction",{
action:"share"
}),this.triggerEvent("shareVideo"),this.showSubscribeBtn()):this.supportNativeFullPlayer&&this.callJsapiShareVideo("shareEmbedMpVideo")));
},
praiseVideo:function(){
return this.opt.extinfo&&this.opt.extinfo.preview?void window.weui.alert(""):(this.triggerEvent("praiseVideo"),
void(this.isPraised&&this.showSubscribeBtn()));
},
likeVideo:function(){
if(this.opt.extinfo&&this.opt.extinfo.preview)return void window.weui.alert("");
if(this.isInPaySubscribe)return void window.weui.alert("");
1===this.fullscreenStatus&&this.isLandscape&&this.changeFullscreenLandscapeMode(0);
var e=this;
return k.supportZaikanAutho&&!e.isLiked?void setTimeout(function(){
WeixinJSBridge.invoke("handleHaokanAction",{
action:"checkSyncHaoKanPermission"
},function(t){
var i=t.result;
0!==i&&(e.triggerEvent("likeVideo"),e.isLiked?(e.showControlBar(),e.hideControlBarAfterTimeout(),
e.showLikedCommentTips(),e.showSubscribeBtn(),e.__hideLikedCommentTipsTimeoutId=setTimeout(e.hideLikedCommentTips,3e3)):e.hideLikedCommentTips());
});
},250):(e.triggerEvent("likeVideo"),void(e.isLiked?(e.showControlBar(),e.hideControlBarAfterTimeout(),
e.showLikedCommentTips(),e.showSubscribeBtn(),e.__hideLikedCommentTipsTimeoutId=setTimeout(e.hideLikedCommentTips,3e3)):e.hideLikedCommentTips()));
},
writeLikedComment:function(){
WeixinJSBridge.invoke("handleHaokanAction",{
action:"checkSyncCommentPermission"
},function(e){
var t=e.result;
0!==t&&d.invoke("handleHaokanAction",{
action:"shareToGoodLook"
});
});
},
onLikedCommentWrite:function(e){
var t=this;
return this.opt.extinfo&&this.opt.extinfo.preview?void window.weui.alert(""):this.isInPaySubscribe?void window.weui.alert(""):void(this.fullscreenStatus&&this.needFeFullscreen&&this.supportImmersiveMode&&!function(){
1===t.fullscreenStatus&&1===t.orientationStatus&&t.exitFullscreen();
var i=t,s=e;
k.supportZaikanAutho?setTimeout(function(){
WeixinJSBridge.invoke("handleHaokanAction",{
action:"checkSyncHaoKanPermission"
},function(e){
var t=e.result;
0!==t&&(i.triggerEvent("likeVideo",s),i.showSubscribeBtn(),i.isLiked?(i.showControlBar(),
i.hideControlBarAfterTimeout(),i.showLikedCommentTips(),i.showSubscribeBtn(),i.__hideLikedCommentTipsTimeoutId=setTimeout(i.hideLikedCommentTips,3e3)):i.hideLikedCommentTips());
});
},250):(i.triggerEvent("likeVideo",s),i.showSubscribeBtn(),i.isLiked?(i.showControlBar(),
i.hideControlBarAfterTimeout(),i.showLikedCommentTips(),i.showSubscribeBtn(),i.__hideLikedCommentTipsTimeoutId=setTimeout(i.hideLikedCommentTips,3e3)):i.hideLikedCommentTips());
}());
},
openSourcePage:function(){
this.isImmersiveMode?T.openUrlWithExtraWebview((this.opt.href||location.href).replace("#rd","").replace("item_show_type=16","").replace(/&scene=\d*/,"")+"&scene=206#rd"):this.exitFullscreen(),
this.triggerEvent("openSourcePage");
},
clickSubscribe:function(){
var e=this;
0===window.isFans&&k.supportSubscribe&&1===this.subscribeStatus&&(d.invoke("quicklyAddBrandContact",{
username:this.opt.bizUserName,
scenenote:location.href||"",
scene:203
},function(t){
t.err_msg.indexOf("ok")>-1&&(e.showSubscribeBtn(2),window.isFans=1);
}),this.triggerEvent("clickSubscribe"));
},
checkAndResetSecOpenAutoPlay:function(){
var e=this.$store.state.cgiData.iframeIdx,t=document.getElementById("js_mp_video_container_"+e),i=t&&t.getAttribute("__sec_open_auto_play__");
return t&&t.removeAttribute("__sec_open_auto_play__"),i;
},
callJsapiShareVideo:function(e){
var t=this;
if(!this.__loadingCoverBase64){
var i=function(){
var i=t.$store.state.cgiData,s=window.msg_link.html(!1),n=window.user_name||(i?i.username||i.user_name:"")||"",o=window.nickname||(i?i.nick_name:"")||"",a=t.opt.extinfo,r=a&&a.vid||"",h={
action:e,
mpUrl:s,
bizUsrName:n,
bizNickName:o,
videoVid:r,
videoUrl:w.addParam(t.opt.src,"video_md5",t.opt.videoMd5||""),
videoThumbUrl:t.opt.cover,
videoThumbData:t.__coverBase64,
videoTitle:t.opt.videoTitle,
videoDuration:1*t.opt.duration
};
d.invoke("handleMPPageAction",h,function(){});
};
this.__loadingCoverBase64=!0,this.getCoverBase64(function(){
t.__loadingCoverBase64=!1,i();
});
}
},
getCoverBase64:function(e){
var t=this;
this.__coverBase64?"function"==typeof e&&e({
cover64:this.__coverBase64||""
}):!function(){
var i=new Image;
i.crossOrigin="anonymous",i.onload=function(){
i.onload=null,i.onerror=null;
try{
var s=i.naturalWidth||i.width,n=i.naturalHeight||i.height,o=document.createElement("canvas"),a=o.getContext("2d");
o.width=s,o.height=n,o.style.width=s+"px",o.style.height=n+"px",a.drawImage(i,0,0,s,n),
t.__coverBase64=o.toDataURL("image/jpeg",1);
}catch(r){
console.error(r),t.jsapiLog("jsapi shareEmbedMpVideo error: "+r.toString()),t.__coverBase64="";
}
"function"==typeof e&&e({
cover64:t.__coverBase64
});
},i.onerror=function(){
this.onload=null,this.onerror=null,"function"==typeof e&&e({
cover64:""
});
},i.src=t.cover;
}();
}
}),
_getFormatTime:C,
_getAllPlayersOfPage:E
};
return L;
});define("pages_new/common_share/video/player/plugins/monitor/monitor.js",["pages_new/common_share/video/player/plugins/base_legacy.js","biz_wap/utils/jsmonitor_report.js","appmsg/log.js"],function(t){
"use strict";
function r(){
this._g={
reportData:{},
uid:+new Date,
random:Math.random(),
_debug:a
};
}
var o=t("pages_new/common_share/video/player/plugins/base_legacy.js"),e=t("biz_wap/utils/jsmonitor_report.js"),i=t("appmsg/log.js"),a=void 0;
try{
a=window.parent.window.location.href.indexOf("&vconsole=1")>0;
}catch(n){
a=window.location.href.indexOf("&vconsole=1")>0;
}
return o.inherit(r,o.Class),r.prototype.destroy=function(){
this.setUnblockEvt("initMonitor");
},r.prototype.init=function(){
this.setBlockEvt("initMonitor");
},r.prototype.getuid=function(){
return++this._g.uid;
},r.prototype.initDataByUid=function(t,r){
var o=this._g.reportData;
!r&&o[t]&&o[t].radio&&(r=o[t].radio),this._g.reportData[t]={
data:{},
radio:r||1
};
},r.prototype.initMonitorHandler=function(t,r,o){
var e=this.getuid()+"_"+r;
return this.initDataByUid(e,o),{
data:e,
code:7
};
},r.prototype.minusMonitorHandler=function(t,r,e){
var i=this._g.reportData[r];
if(!i||!e)return o.BASE_BITSET;
i=i.data;
for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]||(i[a]={
key:a,
value:0
}),i[a].value=Math.max(0,i[a].value-e[a]||1));
return o.BASE_BITSET;
},r.prototype.setMonitorHandler=function(t,r,e){
var i=this._g.reportData[r];
if(!i||!e)return o.BASE_BITSET;
i=i.data;
for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]||(i[a]={
key:a,
value:0
}),i[a].value=e[a]||1);
return o.BASE_BITSET;
},r.prototype.plusMonitorHandler=function(t,r,e){
var i=this._g.reportData[r];
if(!i||!e)return o.BASE_BITSET;
i=i.data;
for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]||(i[a]={
key:a,
value:0
}),i[a].value=i[a].value+e[a]||1);
return o.BASE_BITSET;
},r.prototype.clearMonitorHandler=function(t,r){
return this.initDataByUid(r),o.BASE_BITSET;
},r.prototype.sendMonitorHandler=function(t,r){
if(!r||-1===r.indexOf("_"))return o.BASE_BITSET;
var a=this._g.reportData[r];
if(!a)return o.BASE_BITSET;
if(this._g.random>a.radio&&!this._g._debug)return o.BASE_BITSET;
a=a.data;
var n=(r+"").split("_")[1];
for(var s in a)if(Object.prototype.hasOwnProperty.call(a,s)){
var p=a[s];
p.value&&e.setSum(n,p.key,p.value);
}
return i("[Video] "+JSON.stringify(a)),this.initDataByUid(r),o.BASE_BITSET;
},r;
});define("pages_new/common_share/video/player/plugins/base.js",["pages_new/3rd/vue.js"],function(n){
"use strict";
var t=n("pages_new/3rd/vue.js"),e=t.extend({
data:function(){
return{
controller:null
};
},
methods:{
initContext:function(n){
this.controller=n,"function"==typeof this.initPlugin&&this.initPlugin();
},
setBlockEvt:function(n){
this.controller.setBlockPlugin(n,this);
},
setUnblockEvt:function(n){
this.controller.setBlockPlugin(n,null);
},
recv:function(){
for(var n=arguments.length,t=Array(n),i=0;n>i;i++)t[i]=arguments[i];
var r=this[t[0]+"Handler"];
if("function"==typeof r){
var o=r.apply(this,t);
return"undefined"==typeof o||null===o?e.CONTINUE:o;
}
return e.CONTINUE;
}
}
});
return e.TYPE_INNER=0,e.TYPE_COVER=1,e.TYPE_CONTROL=2,e.TYPE_PROFILE=3,e.CONTINUE=0,
e.BLOCK_ALL_LOGIC=1,e.BLOCK_REST_PLUGINS=2,e.BLOCK_INNER_LOGIC=4,e.BLOCK_TRIGGER_OUT=8,
e;
});define("pages_new/common_share/video/player/controller.html.js",[],function(){
return'<div\n  :class="[\'mp-video-player\', fullscreenStatus === 101 ? \'opr_fade_out\' : \'\']"\n>\n  <mp-video-player\n    v-if="errType === 0 && playerOpt"\n    ref="player"\n    :opt="playerOpt"\n    :wrap-style="wrapStyle"\n    :video-style="videoStyle"\n    :poster-style="posterStyle"\n    @loaded="onLoaded"\n    @timeupdate="onTimeupdate"\n    @begin-play="onBeginPlay"\n    @durationchange="onDurationchange"\n    @fullscreenchange="onFullscreenchange"\n    @status-change="onStatusChange"\n    @after-replay="onAfterReplay"\n    @hand-drag-complete="onHandDragComplete"\n    @bar-drag-complete="onBarDragComplete"\n    @end="onEnd"\n    @error="onError"\n    @first-buffering-time="onFirstBufferingTime"\n    @playing-buffering-time="onPlayingBufferingTime"\n    @flow-notice="onFlowNotice"\n    @userplay="onUserplay"\n    @userpause="onUserpause"\n    @waiting="onWaiting"\n    @play="onPlay"\n    @pause="onPause"\n    @mid-play-click="onMidPlayClick"\n    @after-check-video-fit="onAfterCheckVideoFit"\n    @bind-error="onBindError"\n    @rate-change="onRateChange"\n    @resolution-change="onResolutionChange"\n    @brightness-change="onBrightnessChange"\n    @volume-change="onVolumeChange"\n    @profile-jump="onProfileJump"\n    @process-state-change="onProcessStateChange"\n    @canplay="onCanplay"\n    @show-control-bar="onShowControlBar"\n    @hide-control-bar="onHideControlBar"\n    @show-menu="onShowMenu"\n    @replay="onReplay"\n    @touch-video="onTouchVideo"\n    @share-video="onShareVideo"\n    @praise-video="onPraiseVideo"\n    @like-video="onLikeVideo"\n    @open-source-page="onOpenSourcePage"\n    @show-subscribe="onShowSubscribe"\n    @click-subscribe="onClickSubscribe"\n    @enter-fullscreen="onEnterFullscreen"\n    @exit-fullscreen="onExitFullscreen"\n    @fast-forward="onFastForward"\n    @loadedmetadata="onLoadedMetaData"\n    @touch-move-horizontally="onTouchMoveHorizontally"\n    @player-touch-end="onPlayerTouchEnd"\n    @seeking-status-change="onSeekingStatusChange"\n    @liked-comment-tips-status-change="onLikedCommentTipsStatusChange"\n  >\n    <template #inner>\n      <component\n        ref="innerPlugins"\n        v-for="(plugin, idx) in innerPlugins"\n        :key="idx"\n        :is="plugin"\n      ></component>\n      <!--  BEGIN -->\n      <div\n        v-show="topStickyInfoStatus && !fullscreenStatus"\n        class="video_poster__info__play"\n        :style="{ zIndex: topStickyInfoStatus > 200 ? -2 : \'\' }"\n        @click="topStickyInfoPlay"\n      >\n        <i :class="topStickyInfoIconClass"></i>\n      </div>\n      <div\n        v-show="topStickyInfoStatus && !fullscreenStatus"\n        class="video_poster__info"\n        :style="{ zIndex: topStickyInfoStatus > 200 ? -2 : \'\' }"\n        @click="topStickyInfoPlay"\n      >\n        <p class="video_poster__info__title" style="font-size: 17px">{{topStickyInfoWording}}</p>\n        <p class="video_poster__info__desc" style="font-size: 12px">\n          {{playerOpt && playerOpt.videoTitle || \'\'}}\n        </p>\n      </div>\n      <div\n        v-show="topStickyInfoStatus && !fullscreenStatus"\n        class="video_poster__info__mask"\n        :style="{ width: topStickyInfoMaskWidth }"\n      ></div>\n      <!--  END -->\n    </template>\n    <template #cover>\n      <component\n        ref="coverPlugins"\n        v-for="(plugin, idx) in coverPlugins"\n        :key="idx"\n        :is="plugin"\n      ></component>\n    </template>\n    <template #control>\n      <component\n        ref="controlPlugins"\n        v-for="(plugin, idx) in controlPlugins"\n        :key="idx"\n        :is="plugin"\n      ></component>\n    </template>\n    <template #profile>\n      <component\n        ref="profilePlugins"\n        v-for="(plugin, idx) in profilePlugins"\n        :key="idx"\n        :is="plugin"\n      ></component>\n    </template>\n  </mp-video-player>\n  <div v-else-if="errType === 1" class="wrp_pop_tips wx_video_error_box js_error_box">\n    <div class="wx_video_error_msg js_error_area">\n      <p role="heading">{{errMsg}}</p>\n      <i v-if="!opt.isMpVideo" class="wx_video_error_code">{{errCode}}</i>\n      <a\n        v-if="refreshBtnStatus !== 0"\n        class="wx_video_error_msg_btn js_video_errormsg_btn"\n        role="button"\n        href="javascript:void(0);"\n        @click="reload"\n      >\n        <img\n          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAqCAMAAADhynmdAAAAQlBMVEUAAACcnJycnJycnJyoqKicnJycnJycnJycnJycnJyfn5+cnJydnZ2enp6kpKSdnZ2cnJyenp6cnJycnJycnJybm5t8KrXMAAAAFXRSTlMAyeb3CNp3tJRvHIEtJhBgqztWRJ+p5TqGAAABCklEQVQ4y5WTi27DIAxFAUMhgTzX8/+/urB2pdKI0x0pSoRuruyLbf7gF3PBaDE6X44LyY0D1SJQsfd9PpMM/CJx60v8SmV1HMSi1lKyA1n0jnwWSO08l04uJbxpBmTrpDtbGB6fmxC6Tc4BHv9aZDJdJsHW9w43Jez9x8T5M4l31WZsJn2bsYY+nUum2lQkGIVANPZ4FCLWOJImSTgjZE2SkU9crmu57mj9JBc93Qzj9R1d3HSG5bN5MRsnUzcGKK8Ns02z+Da7rYQE4bUE2PG1C6kVnkCyf0pwX8/jwbyxCLhcHpKTFkvkwK3pRmXtRrVFoTGYLvN+t0EUl0qrRaF1pFBz0anp/ptvNB4SY1XDAVMAAAAASUVORK5CYII="\n          alt=""\n          class="wx_video_error_refresh"\n        />\n              </a>\n    </div>\n    <img\n      src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA5CAMAAAC7xnO3AAAAY1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+aRQ2gAAAAIXRSTlMAOx20pMJbzBQNTDGTh2ohLCZmeUF2hEmXCFdxUquef4yHE17nAAACnklEQVRIx9WW2xqiIBSFRc1AUATJU1a+/1MOm0NYKvnNXM260ZLftRcbqCQinOLI0yiY/iXKuUZPjx5Fk+6RhF1yHiVF0wC6IZfr9fqIkpRqdNyQ9AoiUU8g+YZ8Xn96YmNKvkhkLMskKgEo/yJzaxkXeZsGsjeWKEIFU/FBZgA+D5yEwGtTgR0J18lYUvdcLZ1YkUjLf+a0saYYSG/J3Hury+WSkTCjCETtF6Mvd8QGJMZSWIfsAlKhWGRl5zQ1ZNBDgy/zzvvFavWUK7SyTRs+rsiUZS/4LHIHyo8VgBx7vDkKx2WhPS7dD1Q6cNlu2dTa0gMys4bz/vJR6ph8ADgcVcSVUkfnhzJTc6gRj8fbCOHk30UI2KC+V4gKjskJQqC5frFHli0kafogFIfFkAXVCSqdAFVR8pmtVCWiXCtaarbWpGtQAYx7sjf2GCbfjFRQpH7lTLucveSMBE7+Z6VqViT2/PVs0d7hPk9TUcTaUuVaT8k/f/v6SXOgyG7InZaSvM8vj/309LrbvpSAORDH2/kWGyHhm/u5AYUc8qdFBRRrsV749bRv6I5x1OY50GZUUxQz9aGplAXZcOQ1DL3vwsTyvHQ2YWgjZV2rDTmxYRjUuoBvcQDr7QRLBiiNzJ4BawG3FLtTmEMGBigTRyC2oIKht1vbwLWrKmXKBZal+yApDGhm4q5JCVdNdrZeQBe8B44WnE2NGmxrR1bCvMugHdkhSwMWI9wjIGeosnPlJmNrst6PQrpeFkBSyAmkdD016DYqAVC6HHcNtnCPgazcuytAd5IqB/qYtq4bkP7vnEaL3W4KH9/HhKBAKl8XFUlMIWYIek4hZgh6UtjHBLVA4pPkCKRf9jOQ5Kwp1UvPDyb3qkPJaRG8Ln7f8Q8Bki/Kj5IYnQAAAABJRU5ErkJggg=="\n      class="wx_video_error_loading js_video_errormsg_loading"\n      style="display: none"\n    />\n  </div>\n  <div v-else-if="errType === 2" class="wrp_pop_tips wx_video_msg_primary js_error_box">\n    <div class="wx_video_msg_primary_inner">\n      <i class="weui-icon-info weui-icon_msg"></i>\n      <p class="wx_video_msg_primary_text">{{errMsg}}</p>\n    </div>\n  </div>\n  <div v-show="toastTips">\n    <div class="weui-mask_transparent"></div>\n    <div class="weui-toast" :style="{ top: orientationStatus === 0 ? \'45%\' : \'50%\', position: \'absolute\' }">\n      <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n      <p class="weui-toast__content">{{toastTips}}</p>\n    </div>\n  </div>\n</div>';
});function _classCallCheck(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}
var _createClass=function(){
function e(e,t){
for(var o=0;o<t.length;o++){
var i=t[o];
i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i);
}
}
return function(t,o,i){
return o&&e(t.prototype,o),i&&e(t,i),t;
};
}();
define("appmsg/emotion/emotion_pc.js",["appmsg/emotion/weemoji.js","biz_common/dom/event.js","appmsg/emotion/emotion.js","common/utils.js","biz_wap/utils/mmversion.js","pages/utils.js","biz_common/tmpl.js","appmsg/emotion/emotion_pc.html.js"],function(e,t,o){
"use strict";
var i=e("appmsg/emotion/weemoji.js"),n=i.EmojiData||[],s=i.EmojiPanelData||[],a=e("biz_common/dom/event.js"),m=e("appmsg/emotion/emotion.js").encode,l=e("common/utils.js"),c=e("biz_wap/utils/mmversion.js"),r=e("pages/utils.js"),h=e("biz_common/tmpl.js"),p=e("appmsg/emotion/emotion_pc.html.js"),d="js_emotion_item",u=l.getInnerHeight(),v=13,f=13,w=function(){
function e(t){
_classCallCheck(this,e),this.edata=[],this.emojiText={},this.isShow=!1,this.onSelect=t.onSelect,
this.initEmotionData();
var o=document.createElement("div");
o.innerHTML=h.tmpl(p,{
list:this.edata
},!1);
var i=r.qs(".js_emotion_panel",o);
document.body.appendChild(i),this.dom={
emotionSwitch:t.emotionSwitch,
emotionPanel:i,
emotionList:r.qs(".js_emotion_list",i),
input:t.input,
submit:t.submit,
tool:t.tool
},this.bindEvent();
}
return _createClass(e,[{
key:"initEmotionData",
value:function(){
var e=this,t=[];
s.forEach(function(e,o){
n.some(function(i){
return i.key===e.key?(t[o]=i,!0):!1;
});
});
for(var o=0;f>o;o++)for(var i=0;v>i;i++){
var a=o*v+i;
t[a]&&this.edata.push({
name:t[a].style,
title:t[a].cn,
key:t[a].key
});
}
t.forEach(function(t){
e.emojiText[t.style]=t.cn;
});
}
},{
key:"bindEvent",
value:function(){
var e=this;
a.on(window,"resize",this.emotionPanelMove),a.tap(this.dom.emotionSwitch,function(){
e[e.isShow?"hide":"show"]();
}),a.tap(this.dom.emotionList,function(t){
for(var o=t.target;o&&o!==e.dom.emotionList&&!o.classList.contains(d);)o=o.parentNode;
o.classList.contains(d)&&"function"==typeof e.onSelect&&e.onSelect(e.edata[o.dataset.index]);
});
}
},{
key:"show",
value:function(){
this.isShow=!0;
var e=this.dom.emotionPanel;
e.style.display="",this.zoomEmotionPanel();
var t=e.getBoundingClientRect();
t.top+t.height>=u&&window.scrollTo(0,window.scrollY+t.height);
}
},{
key:"hide",
value:function(){
this.isShow=!1,this.dom.emotionPanel.style.display="none";
}
},{
key:"zoomEmotionPanel",
value:function(){
var e=this.dom.emotionPanel,t=window.getComputedStyle(r.qs(".rich_media_tool")).zoom,o=this.dom.tool.getBoundingClientRect();
e.style.left=o.right*t+"px",e.style.transform="translateX(-100%)",c.isWindows?e.style.top=window.scrollY+o.top*t+o.height*t+"px":c.isMac&&(e.style.top=(window.scrollY+o.top+o.height)*t+"px");
}
},{
key:"emotionPanelMove",
value:function(){
this.isShow&&this.zoomEmotionPanel();
}
},{
key:"textFilter",
value:function(e){
var t=document.createElement("div");
t.innerHTML=e;
for(var o="",i="",n=[],s=void 0,a=0;a<t.childNodes.length;a++){
var m=t.childNodes[a];
1===m.nodeType&&("IMG"===m.nodeName.toUpperCase()||"I"===m.nodeName.toUpperCase())&&(i=m.getAttribute("class"),
i&&(n=i.split(" "),n.length>1&&"icon_emotion_single"===n[0]&&"we-emoji"===n[1]&&(o=this.emojiText[n[2]],
s=document.createTextNode(o),t.replaceChild(s,m))));
}
return t.innerHTML.replace(/<br.*?>/gi,"\n").replace(/<.*?>/g,"");
}
}]),e;
}();
o.exports={
Emotion:w,
encode:m
};
});